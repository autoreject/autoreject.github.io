
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Visualize bad sensors per trial &#8212; autoreject 0.5.dev0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          autoreject</a>
        <span class="navbar-text navbar-version pull-left"><b>0.5.dev0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="index.html">Examples</a></li>
                <li><a href="../explanation.html">Explanation</a></li>
                <li><a href="../faq.html">FAQ</a></li>
                <li><a href="../api.html">API</a></li>
                <li><a href="../whats_new.html">What's new</a></li>
                <li><a href="https://github.com/autoreject/autoreject">GitHub</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
<div class="navbar-form navbar-right navbar-btn dropdown btn-group-sm" style="margin-left: 20px; margin-top: 5px; margin-bottom: 5px">
  <button type="button" class="btn btn-primary navbar-btn dropdown-toggle" id="dropdownMenu1" data-toggle="dropdown">
    v0.5.dev0
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
    <li><a href="https://autoreject.github.io/dev/index.html">Development</a></li>
    <li><a href="https://autoreject.github.io/stable/index.html">Stable</a></li>
    <li><a href="https://autoreject.github.io/v0.4/index.html">v0.4</a></li>
    <li><a href="https://autoreject.github.io/v0.3/index.html">v0.3</a></li>
    <li><a href="https://autoreject.github.io/v0.2/index.html">v0.2</a></li>
  </ul>
</div>


            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          

        </div>
    </div>
  </div>

<div class="container content-container">
  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-plot-visualize-bad-epochs-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="visualize-bad-sensors-per-trial">
<span id="sphx-glr-auto-examples-plot-visualize-bad-epochs-py"></span><h1>Visualize bad sensors per trial<a class="headerlink" href="#visualize-bad-sensors-per-trial" title="Permalink to this heading">Â¶</a></h1>
<p>This example demonstrates how to use <a class="reference internal" href="../api.html#module-autoreject" title="autoreject"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autoreject</span></code></a> to
visualize the bad sensors in each trial</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Author: Mainak Jas &lt;mainak.jas@telecom-paristech.fr&gt;</span>
<span class="c1">#         Denis A. Engemann &lt;denis.engemann@gmail.com&gt;</span>
<span class="c1"># License: BSD-3-Clause</span>

<span class="c1"># sphinx_gallery_thumbnail_number = 2</span>
</pre></div>
</div>
<p>First, we download the data from OpenfMRI which is hosted on OpenNeuro.
We will do this using <code class="docutils literal notranslate"><span class="pre">openneuro-py</span></code> which can be installed using pip
(<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">openneuro-py</span></code>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">openneuro</span>
<span class="kn">import</span> <span class="nn">autoreject</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a> <span class="o">=</span> <span class="s1">&#39;ds000117&#39;</span>  <span class="c1"># The id code on OpenNeuro for this example dataset</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject_id</span></a> <span class="o">=</span> <span class="mi">16</span>  <span class="c1"># OpenfMRI format of subject numbering</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_dir</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3/library/os.path.html#os.path.dirname" title="os.path.dirname" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span></a><span class="p">(</span><span class="n">autoreject</span><span class="o">.</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;examples&#39;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.isdir" title="os.path.isdir" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_dir</span></a><span class="p">):</span>
    <a href="https://docs.python.org/3/library/os.html#os.makedirs" title="os.makedirs" class="sphx-glr-backref-module-os sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_dir</span></a><span class="p">)</span>

<span class="n">openneuro</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_dir</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_dir</span></a><span class="p">,</span>
                   <span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;sub-</span><span class="si">{</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject_id</span></a><span class="si">}</span><span class="s1">/ses-meg/&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Hello! This is openneuro-py 2022.4.0. Great to see you!

      Please report problems and bugs at
      https://github.com/hoechenberger/openneuro-py/issues

Preparing to download ds000117 ...

Traversing directories for ds000117: 0 entities [00:00, ? entities/s]
Traversing directories for ds000117: 23 entities [00:00, 115.69 entities/s]
Traversing directories for ds000117: 35 entities [00:00, 55.19 entities/s]
Traversing directories for ds000117: 490 entities [00:00, 850.42 entities/s]
Traversing directories for ds000117: 956 entities [00:00, 1361.25 entities/s]
Traversing directories for ds000117: 1066 entities [00:07, 148.07 entities/s]
Retrieving up to 22 files (5 concurrent downloads).

Skipping dataset_description.json: already downloaded.: 100%|##########| 1.07k/1.07k [00:00&lt;?, ?B/s]


Skipping participants.tsv: already downloaded.: 100%|##########| 333/333 [00:00&lt;?, ?B/s]


Skipping CHANGES: already downloaded.: 100%|##########| 1.79k/1.79k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_scans.tsv: already downloaded.: 100%|##########| 475/475 [00:00&lt;?, ?B/s]


Skipping README: already downloaded.: 100%|##########| 5.92k/5.92k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_meg.json: already downloaded.: 100%|##########| 1.67k/1.67k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_channels.tsv: already downloaded.: 100%|##########| 23.0k/23.0k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_events.tsv: already downloaded.: 100%|##########| 8.75k/8.75k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_headshape.pos: already downloaded.: 100%|##########| 4.22k/4.22k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_coordsystem.json: already downloaded.: 100%|##########| 1.81k/1.81k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-02_events.tsv: already downloaded.: 100%|##########| 6.06k/6.06k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-01_events.tsv: already downloaded.: 100%|##########| 6.19k/6.19k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-03_events.tsv: already downloaded.: 100%|##########| 6.19k/6.19k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-05_events.tsv: already downloaded.: 100%|##########| 6.15k/6.15k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-04_events.tsv: already downloaded.: 100%|##########| 6.23k/6.23k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-06_events.tsv: already downloaded.: 100%|##########| 6.24k/6.24k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-06_meg.fif: already downloaded.: 100%|##########| 822M/822M [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-05_meg.fif: already downloaded.: 100%|##########| 824M/824M [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-04_meg.fif: already downloaded.: 100%|##########| 830M/830M [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-03_meg.fif: already downloaded.: 100%|##########| 832M/832M [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-02_meg.fif: already downloaded.: 100%|##########| 835M/835M [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-01_meg.fif: already downloaded.: 100%|##########| 824M/824M [00:00&lt;?, ?B/s]

Finished downloading ds000117.

Please enjoy your brains.
</pre></div>
</div>
<p>We will create epochs with data starting 200 ms before trigger onset
and continuing up to 800 ms after that. The data contains visual stimuli for
famous faces, unfamiliar faces, as well as scrambled faces.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmax</span></a> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events_id</span></a> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;famous/first&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;famous/immediate&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;famous/long&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">}</span>
</pre></div>
</div>
<p>Let us now load all the epochs into memory and concatenate them</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mne</span>  <span class="c1"># noqa</span>

<a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray" title="mne.EpochsArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">run</span></a> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">):</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">run_fname</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_dir</span></a><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;sub-</span><span class="si">{</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject_id</span></a><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;ses-meg&#39;</span><span class="p">,</span> <span class="s1">&#39;meg&#39;</span><span class="p">,</span>
                             <span class="sa">f</span><span class="s1">&#39;sub-</span><span class="si">{</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject_id</span></a><span class="si">}</span><span class="s1">_ses-meg_task-facerecognition&#39;</span>
                             <span class="s1">&#39;_run-</span><span class="si">{:02d}</span><span class="s1">_meg.fif&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">run</span></a><span class="p">))</span>
    <a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.io.read_raw_fif.html#mne.io.read_raw_fif" title="mne.io.read_raw_fif" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_fif</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">run_fname</span></a><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw.pick_types" title="mne.io.Raw.pick_types" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">pick_types</span></a><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># less memory + computation</span>
    <a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw.filter" title="mne.io.Raw.filter" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">filter</span></a><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">,</span> <span class="n">l_trans_bandwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="s1">&#39;INFO&#39;</span><span class="p">)</span>

    <a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw.set_channel_types" title="mne.io.Raw.set_channel_types" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">set_channel_types</span></a><span class="p">({</span><span class="s1">&#39;EEG061&#39;</span><span class="p">:</span> <span class="s1">&#39;eog&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG062&#39;</span><span class="p">:</span> <span class="s1">&#39;eog&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;EEG063&#39;</span><span class="p">:</span> <span class="s1">&#39;ecg&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG064&#39;</span><span class="p">:</span> <span class="s1">&#39;misc&#39;</span><span class="p">})</span>
    <a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw.rename_channels" title="mne.io.Raw.rename_channels" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">rename_channels</span></a><span class="p">({</span><span class="s1">&#39;EEG061&#39;</span><span class="p">:</span> <span class="s1">&#39;EOG061&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG062&#39;</span><span class="p">:</span> <span class="s1">&#39;EOG062&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;EEG063&#39;</span><span class="p">:</span> <span class="s1">&#39;ECG063&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG064&#39;</span><span class="p">:</span> <span class="s1">&#39;MISC&#39;</span><span class="p">})</span>

    <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.find_events.html#mne.find_events" title="mne.find_events" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">find_events</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">,</span> <span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;STI101&#39;</span><span class="p">,</span>
                             <span class="n">consecutive</span><span class="o">=</span><span class="s1">&#39;increasing&#39;</span><span class="p">,</span>
                             <span class="n">min_duration</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Read epochs</span>
    <a href="https://mne.tools/dev/generated/mne.set_eeg_reference.html#mne.set_eeg_reference" title="mne.set_eeg_reference" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">set_eeg_reference</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">)</span>

    <a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epoch</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class"><span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events_id</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmax</span></a><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">baseline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">preload</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reject</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">decim</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray" title="mne.EpochsArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span><span class="o">.</span><span class="n">append</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epoch</span></a><span class="p">)</span>

    <span class="c1"># Same `dev_head_t` for all runs so that we can concatenate them.</span>
    <a href="https://mne.tools/dev/generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epoch</span><span class="o">.</span><span class="n">info</span></a><span class="p">[</span><span class="s1">&#39;dev_head_t&#39;</span><span class="p">]</span> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray" title="mne.EpochsArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;dev_head_t&#39;</span><span class="p">]</span>


<a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray" title="mne.EpochsArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.concatenate_epochs.html#mne.concatenate_epochs" title="mne.concatenate_epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">epochs</span><span class="o">.</span><span class="n">concatenate_epochs</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray" title="mne.EpochsArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Opening raw data file /home/circleci/project/autoreject/../examples/ds000117/sub-16/ses-meg/meg/sub-16_ses-meg_task-facerecognition_run-03_meg.fif...
    Read a total of 8 projection items:
        mag_ssp_upright.fif : PCA-mags-v1 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v2 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v3 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v4 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v5 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v1 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v2 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v3 (1 x 306)  idle
    Range : 40700 ... 588499 =     37.000 ...   534.999 secs
Ready.
Reading 0 ... 547799  =      0.000 ...   497.999 secs...
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v3, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v4, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v5, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v3, active : False, n_channels : 306&gt;
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 0.75 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 7261 samples (6.601 sec)

/home/circleci/project/examples/plot_visualize_bad_epochs.py:58: RuntimeWarning: The unit for channel(s) EEG064 has changed from V to NA.
  raw.set_channel_types({&#39;EEG061&#39;: &#39;eog&#39;, &#39;EEG062&#39;: &#39;eog&#39;,
296 events found
Event IDs: [   5    6    7   13   14   15   17   18   19  261  262  263  269  271
  273  274  275 4096 4101 4102 4103 4109 4110 4111 4113 4114 4115]
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom (&#39;EEG&#39;,) reference.
Not setting metadata
49 matching events found
No baseline correction applied
0 projection items activated
Opening raw data file /home/circleci/project/autoreject/../examples/ds000117/sub-16/ses-meg/meg/sub-16_ses-meg_task-facerecognition_run-04_meg.fif...
    Read a total of 8 projection items:
        mag_ssp_upright.fif : PCA-mags-v1 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v2 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v3 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v4 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v5 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v1 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v2 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v3 (1 x 306)  idle
    Range : 36300 ... 582999 =     33.000 ...   529.999 secs
Ready.
Reading 0 ... 546699  =      0.000 ...   496.999 secs...
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v3, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v4, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v5, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v3, active : False, n_channels : 306&gt;
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 0.75 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 7261 samples (6.601 sec)

/home/circleci/project/examples/plot_visualize_bad_epochs.py:58: RuntimeWarning: The unit for channel(s) EEG064 has changed from V to NA.
  raw.set_channel_types({&#39;EEG061&#39;: &#39;eog&#39;, &#39;EEG062&#39;: &#39;eog&#39;,
296 events found
Event IDs: [   5    6    7   13   14   15   17   18   19  256  261  262  263  269
  271  273  274  275 4096 4101 4102 4103 4109 4110 4111 4113 4114 4115]
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom (&#39;EEG&#39;,) reference.
Not setting metadata
49 matching events found
No baseline correction applied
0 projection items activated
Opening raw data file /home/circleci/project/autoreject/../examples/ds000117/sub-16/ses-meg/meg/sub-16_ses-meg_task-facerecognition_run-05_meg.fif...
    Read a total of 8 projection items:
        mag_ssp_upright.fif : PCA-mags-v1 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v2 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v3 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v4 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v5 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v1 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v2 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v3 (1 x 306)  idle
    Range : 60500 ... 602799 =     55.000 ...   547.999 secs
Ready.
Reading 0 ... 542299  =      0.000 ...   492.999 secs...
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v3, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v4, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v5, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v3, active : False, n_channels : 306&gt;
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 0.75 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 7261 samples (6.601 sec)

/home/circleci/project/examples/plot_visualize_bad_epochs.py:58: RuntimeWarning: The unit for channel(s) EEG064 has changed from V to NA.
  raw.set_channel_types({&#39;EEG061&#39;: &#39;eog&#39;, &#39;EEG062&#39;: &#39;eog&#39;,
292 events found
Event IDs: [   5    6    7   13   14   15   17   18   19  256  261  269  271  273
  274  275 4096 4101 4102 4103 4109 4110 4111 4113 4114 4115]
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom (&#39;EEG&#39;,) reference.
Not setting metadata
49 matching events found
No baseline correction applied
0 projection items activated
Opening raw data file /home/circleci/project/autoreject/../examples/ds000117/sub-16/ses-meg/meg/sub-16_ses-meg_task-facerecognition_run-06_meg.fif...
    Read a total of 8 projection items:
        mag_ssp_upright.fif : PCA-mags-v1 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v2 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v3 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v4 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v5 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v1 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v2 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v3 (1 x 306)  idle
    Range : 27500 ... 568699 =     25.000 ...   516.999 secs
Ready.
Reading 0 ... 541199  =      0.000 ...   491.999 secs...
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v3, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v4, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v5, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v3, active : False, n_channels : 306&gt;
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 0.75 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 7261 samples (6.601 sec)

/home/circleci/project/examples/plot_visualize_bad_epochs.py:58: RuntimeWarning: The unit for channel(s) EEG064 has changed from V to NA.
  raw.set_channel_types({&#39;EEG061&#39;: &#39;eog&#39;, &#39;EEG062&#39;: &#39;eog&#39;,
295 events found
Event IDs: [   5    6    7   13   14   15   17   18   19  256  261  262  263  269
  270  271  273  274  275 4096 4101 4102 4103 4109 4110 4111 4113 4114
 4115]
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom (&#39;EEG&#39;,) reference.
Not setting metadata
50 matching events found
No baseline correction applied
0 projection items activated
Using data from preloaded Raw for 49 events and 1101 original time points (prior to decimation) ...
0 bad epochs dropped
Using data from preloaded Raw for 49 events and 1101 original time points (prior to decimation) ...
0 bad epochs dropped
Using data from preloaded Raw for 49 events and 1101 original time points (prior to decimation) ...
0 bad epochs dropped
Using data from preloaded Raw for 50 events and 1101 original time points (prior to decimation) ...
0 bad epochs dropped
Using data from preloaded Raw for 49 events and 1101 original time points (prior to decimation) ...
Using data from preloaded Raw for 49 events and 1101 original time points (prior to decimation) ...
Using data from preloaded Raw for 49 events and 1101 original time points (prior to decimation) ...
Using data from preloaded Raw for 50 events and 1101 original time points (prior to decimation) ...
Not setting metadata
197 matching events found
No baseline correction applied
</pre></div>
</div>
<p>Now, we apply autoreject</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">autoreject</span> <span class="kn">import</span> <a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject" title="autoreject.AutoReject" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class"><span class="n">AutoReject</span></a><span class="p">,</span> <span class="n">compute_thresholds</span>  <span class="c1"># noqa</span>

<a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray" title="mne.EpochsArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">this_epoch</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray" title="mne.EpochsArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="s1">&#39;famous&#39;</span><span class="p">]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">exclude</span></a> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># XXX</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">picks</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.pick_types.html#mne.pick_types" title="mne.pick_types" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">eog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">exclude</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">exclude</span></a><span class="p">)</span>
</pre></div>
</div>
<p>Note that <a class="reference internal" href="../generated/autoreject.AutoReject.html#autoreject.AutoReject" title="autoreject.AutoReject"><code class="xref py py-class docutils literal notranslate"><span class="pre">autoreject.AutoReject</span></code></a> by design supports multiple
channels. If no picks are passed separate solutions will be computed for each
channel type and internally combines. This then readily supports cleaning
unseen epochs from the different channel types used during fit.
Here we only use a subset of channels to save time.</p>
<p>Also note that once the parameters are learned, any data can be repaired
that contains channels that were used during fit. This also means that time
may be saved by fitting <a class="reference internal" href="../generated/autoreject.AutoReject.html#autoreject.AutoReject" title="autoreject.AutoReject"><code class="xref py py-class docutils literal notranslate"><span class="pre">autoreject.AutoReject</span></code></a> on a
representative subsample of the data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject" title="autoreject.AutoReject" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ar</span></a> <span class="o">=</span> <a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject" title="autoreject.AutoReject" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class"><span class="n">AutoReject</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">picks</span></a><span class="o">=</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">picks</span></a><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray" title="mne.EpochsArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_ar</span></a><span class="p">,</span> <a href="../generated/autoreject.RejectLog.html#autoreject.RejectLog" title="autoreject.RejectLog" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reject_log</span></a> <span class="o">=</span> <a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject.fit_transform" title="autoreject.AutoReject.fit_transform" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-method"><span class="n">ar</span><span class="o">.</span><span class="n">fit_transform</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray" title="mne.EpochsArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">this_epoch</span></a><span class="p">,</span> <span class="n">return_log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Running autoreject on ch_type=eeg

  0%|          | Creating augmented epochs : 0/70 [00:00&lt;?,       ?it/s]
  3%|2         | Creating augmented epochs : 2/70 [00:00&lt;00:01,   67.42it/s]
  4%|4         | Creating augmented epochs : 3/70 [00:00&lt;00:01,   64.91it/s]
  6%|5         | Creating augmented epochs : 4/70 [00:00&lt;00:01,   63.50it/s]
  7%|7         | Creating augmented epochs : 5/70 [00:00&lt;00:01,   62.15it/s]
  9%|8         | Creating augmented epochs : 6/70 [00:00&lt;00:01,   61.30it/s]
 10%|#         | Creating augmented epochs : 7/70 [00:00&lt;00:01,   61.17it/s]
 11%|#1        | Creating augmented epochs : 8/70 [00:00&lt;00:01,   61.05it/s]
 13%|#2        | Creating augmented epochs : 9/70 [00:00&lt;00:01,   60.76it/s]
 14%|#4        | Creating augmented epochs : 10/70 [00:00&lt;00:00,   60.60it/s]
 16%|#5        | Creating augmented epochs : 11/70 [00:00&lt;00:00,   60.20it/s]
 17%|#7        | Creating augmented epochs : 12/70 [00:00&lt;00:00,   60.04it/s]
 19%|#8        | Creating augmented epochs : 13/70 [00:00&lt;00:00,   59.89it/s]
 20%|##        | Creating augmented epochs : 14/70 [00:00&lt;00:00,   59.91it/s]
 21%|##1       | Creating augmented epochs : 15/70 [00:00&lt;00:00,   59.94it/s]
 23%|##2       | Creating augmented epochs : 16/70 [00:00&lt;00:00,   59.13it/s]
 24%|##4       | Creating augmented epochs : 17/70 [00:00&lt;00:00,   54.72it/s]
 26%|##5       | Creating augmented epochs : 18/70 [00:00&lt;00:01,   51.48it/s]
 29%|##8       | Creating augmented epochs : 20/70 [00:00&lt;00:00,   52.88it/s]
 30%|###       | Creating augmented epochs : 21/70 [00:00&lt;00:00,   52.57it/s]
 31%|###1      | Creating augmented epochs : 22/70 [00:00&lt;00:00,   50.16it/s]
 33%|###2      | Creating augmented epochs : 23/70 [00:00&lt;00:00,   47.86it/s]
 34%|###4      | Creating augmented epochs : 24/70 [00:00&lt;00:00,   48.59it/s]
 36%|###5      | Creating augmented epochs : 25/70 [00:00&lt;00:00,   49.16it/s]
 37%|###7      | Creating augmented epochs : 26/70 [00:00&lt;00:00,   49.36it/s]
 39%|###8      | Creating augmented epochs : 27/70 [00:00&lt;00:00,   47.69it/s]
 40%|####      | Creating augmented epochs : 28/70 [00:00&lt;00:00,   46.05it/s]
 41%|####1     | Creating augmented epochs : 29/70 [00:00&lt;00:00,   44.77it/s]
 43%|####2     | Creating augmented epochs : 30/70 [00:00&lt;00:00,   43.82it/s]
 44%|####4     | Creating augmented epochs : 31/70 [00:00&lt;00:00,   44.61it/s]
 46%|####5     | Creating augmented epochs : 32/70 [00:00&lt;00:00,   45.28it/s]
 47%|####7     | Creating augmented epochs : 33/70 [00:00&lt;00:00,   45.06it/s]
 49%|####8     | Creating augmented epochs : 34/70 [00:00&lt;00:00,   43.75it/s]
 50%|#####     | Creating augmented epochs : 35/70 [00:00&lt;00:00,   43.22it/s]
 51%|#####1    | Creating augmented epochs : 36/70 [00:00&lt;00:00,   43.86it/s]
 53%|#####2    | Creating augmented epochs : 37/70 [00:00&lt;00:00,   44.53it/s]
 54%|#####4    | Creating augmented epochs : 38/70 [00:00&lt;00:00,   44.25it/s]
 56%|#####5    | Creating augmented epochs : 39/70 [00:00&lt;00:00,   43.04it/s]
 57%|#####7    | Creating augmented epochs : 40/70 [00:00&lt;00:00,   42.10it/s]
 59%|#####8    | Creating augmented epochs : 41/70 [00:00&lt;00:00,   41.30it/s]
 60%|######    | Creating augmented epochs : 42/70 [00:00&lt;00:00,   41.33it/s]
 61%|######1   | Creating augmented epochs : 43/70 [00:00&lt;00:00,   42.06it/s]
 63%|######2   | Creating augmented epochs : 44/70 [00:00&lt;00:00,   42.75it/s]
 64%|######4   | Creating augmented epochs : 45/70 [00:00&lt;00:00,   41.93it/s]
 66%|######5   | Creating augmented epochs : 46/70 [00:01&lt;00:00,   41.06it/s]
 67%|######7   | Creating augmented epochs : 47/70 [00:01&lt;00:00,   40.15it/s]
 69%|######8   | Creating augmented epochs : 48/70 [00:01&lt;00:00,   39.58it/s]
 70%|#######   | Creating augmented epochs : 49/70 [00:01&lt;00:00,   39.05it/s]
 71%|#######1  | Creating augmented epochs : 50/70 [00:01&lt;00:00,   38.61it/s]
 73%|#######2  | Creating augmented epochs : 51/70 [00:01&lt;00:00,   38.15it/s]
 74%|#######4  | Creating augmented epochs : 52/70 [00:01&lt;00:00,   37.74it/s]
 76%|#######5  | Creating augmented epochs : 53/70 [00:01&lt;00:00,   37.32it/s]
 77%|#######7  | Creating augmented epochs : 54/70 [00:01&lt;00:00,   37.33it/s]
 79%|#######8  | Creating augmented epochs : 55/70 [00:01&lt;00:00,   38.04it/s]
 80%|########  | Creating augmented epochs : 56/70 [00:01&lt;00:00,   38.76it/s]
 81%|########1 | Creating augmented epochs : 57/70 [00:01&lt;00:00,   38.58it/s]
 83%|########2 | Creating augmented epochs : 58/70 [00:01&lt;00:00,   38.09it/s]
 84%|########4 | Creating augmented epochs : 59/70 [00:01&lt;00:00,   37.60it/s]
 86%|########5 | Creating augmented epochs : 60/70 [00:01&lt;00:00,   37.05it/s]
 87%|########7 | Creating augmented epochs : 61/70 [00:01&lt;00:00,   36.59it/s]
 89%|########8 | Creating augmented epochs : 62/70 [00:01&lt;00:00,   36.81it/s]
 90%|######### | Creating augmented epochs : 63/70 [00:01&lt;00:00,   37.54it/s]
 91%|#########1| Creating augmented epochs : 64/70 [00:01&lt;00:00,   38.22it/s]
 93%|#########2| Creating augmented epochs : 65/70 [00:01&lt;00:00,   38.89it/s]
 94%|#########4| Creating augmented epochs : 66/70 [00:01&lt;00:00,   39.59it/s]
 96%|#########5| Creating augmented epochs : 67/70 [00:01&lt;00:00,   39.01it/s]
 97%|#########7| Creating augmented epochs : 68/70 [00:01&lt;00:00,   38.51it/s]
 99%|#########8| Creating augmented epochs : 69/70 [00:01&lt;00:00,   37.99it/s]
100%|##########| Creating augmented epochs : 70/70 [00:01&lt;00:00,   37.54it/s]
100%|##########| Creating augmented epochs : 70/70 [00:01&lt;00:00,   41.27it/s]

  0%|          | Computing thresholds ... : 0/70 [00:00&lt;?,       ?it/s]
  1%|1         | Computing thresholds ... : 1/70 [00:00&lt;00:49,    1.41it/s]
  3%|2         | Computing thresholds ... : 2/70 [00:01&lt;00:43,    1.56it/s]
  4%|4         | Computing thresholds ... : 3/70 [00:01&lt;00:41,    1.61it/s]
  6%|5         | Computing thresholds ... : 4/70 [00:02&lt;00:39,    1.68it/s]
  7%|7         | Computing thresholds ... : 5/70 [00:02&lt;00:37,    1.72it/s]
  9%|8         | Computing thresholds ... : 6/70 [00:03&lt;00:36,    1.74it/s]
 10%|#         | Computing thresholds ... : 7/70 [00:04&lt;00:36,    1.75it/s]
 11%|#1        | Computing thresholds ... : 8/70 [00:04&lt;00:35,    1.75it/s]
 13%|#2        | Computing thresholds ... : 9/70 [00:05&lt;00:34,    1.75it/s]
 14%|#4        | Computing thresholds ... : 10/70 [00:05&lt;00:34,    1.72it/s]
 16%|#5        | Computing thresholds ... : 11/70 [00:06&lt;00:34,    1.72it/s]
 17%|#7        | Computing thresholds ... : 12/70 [00:07&lt;00:34,    1.70it/s]
 19%|#8        | Computing thresholds ... : 13/70 [00:07&lt;00:33,    1.69it/s]
 20%|##        | Computing thresholds ... : 14/70 [00:08&lt;00:33,    1.69it/s]
 21%|##1       | Computing thresholds ... : 15/70 [00:08&lt;00:32,    1.70it/s]
 23%|##2       | Computing thresholds ... : 16/70 [00:09&lt;00:31,    1.71it/s]
 24%|##4       | Computing thresholds ... : 17/70 [00:09&lt;00:30,    1.73it/s]
 26%|##5       | Computing thresholds ... : 18/70 [00:10&lt;00:29,    1.74it/s]
 27%|##7       | Computing thresholds ... : 19/70 [00:10&lt;00:29,    1.75it/s]
 29%|##8       | Computing thresholds ... : 20/70 [00:11&lt;00:28,    1.75it/s]
 30%|###       | Computing thresholds ... : 21/70 [00:12&lt;00:28,    1.75it/s]
 31%|###1      | Computing thresholds ... : 22/70 [00:12&lt;00:27,    1.74it/s]
 33%|###2      | Computing thresholds ... : 23/70 [00:13&lt;00:27,    1.72it/s]
 34%|###4      | Computing thresholds ... : 24/70 [00:14&lt;00:27,    1.70it/s]
 36%|###5      | Computing thresholds ... : 25/70 [00:14&lt;00:26,    1.70it/s]
 37%|###7      | Computing thresholds ... : 26/70 [00:15&lt;00:25,    1.71it/s]
 39%|###8      | Computing thresholds ... : 27/70 [00:15&lt;00:25,    1.72it/s]
 40%|####      | Computing thresholds ... : 28/70 [00:16&lt;00:24,    1.72it/s]
 41%|####1     | Computing thresholds ... : 29/70 [00:16&lt;00:23,    1.73it/s]
 43%|####2     | Computing thresholds ... : 30/70 [00:17&lt;00:23,    1.73it/s]
 44%|####4     | Computing thresholds ... : 31/70 [00:17&lt;00:22,    1.73it/s]
 46%|####5     | Computing thresholds ... : 32/70 [00:18&lt;00:21,    1.73it/s]
 47%|####7     | Computing thresholds ... : 33/70 [00:19&lt;00:21,    1.73it/s]
 49%|####8     | Computing thresholds ... : 34/70 [00:19&lt;00:20,    1.73it/s]
 50%|#####     | Computing thresholds ... : 35/70 [00:20&lt;00:20,    1.73it/s]
 51%|#####1    | Computing thresholds ... : 36/70 [00:20&lt;00:19,    1.73it/s]
 53%|#####2    | Computing thresholds ... : 37/70 [00:21&lt;00:19,    1.72it/s]
 54%|#####4    | Computing thresholds ... : 38/70 [00:22&lt;00:18,    1.72it/s]
 56%|#####5    | Computing thresholds ... : 39/70 [00:22&lt;00:17,    1.72it/s]
 57%|#####7    | Computing thresholds ... : 40/70 [00:23&lt;00:17,    1.72it/s]
 59%|#####8    | Computing thresholds ... : 41/70 [00:23&lt;00:16,    1.73it/s]
 60%|######    | Computing thresholds ... : 42/70 [00:24&lt;00:16,    1.72it/s]
 61%|######1   | Computing thresholds ... : 43/70 [00:24&lt;00:15,    1.72it/s]
 63%|######2   | Computing thresholds ... : 44/70 [00:25&lt;00:15,    1.72it/s]
 64%|######4   | Computing thresholds ... : 45/70 [00:26&lt;00:14,    1.72it/s]
 66%|######5   | Computing thresholds ... : 46/70 [00:26&lt;00:13,    1.73it/s]
 67%|######7   | Computing thresholds ... : 47/70 [00:27&lt;00:13,    1.73it/s]
 69%|######8   | Computing thresholds ... : 48/70 [00:27&lt;00:12,    1.73it/s]
 70%|#######   | Computing thresholds ... : 49/70 [00:28&lt;00:12,    1.74it/s]
 71%|#######1  | Computing thresholds ... : 50/70 [00:28&lt;00:11,    1.73it/s]
 73%|#######2  | Computing thresholds ... : 51/70 [00:29&lt;00:10,    1.73it/s]
 74%|#######4  | Computing thresholds ... : 52/70 [00:30&lt;00:10,    1.73it/s]
 76%|#######5  | Computing thresholds ... : 53/70 [00:30&lt;00:09,    1.73it/s]
 77%|#######7  | Computing thresholds ... : 54/70 [00:31&lt;00:09,    1.74it/s]
 79%|#######8  | Computing thresholds ... : 55/70 [00:31&lt;00:08,    1.74it/s]
 80%|########  | Computing thresholds ... : 56/70 [00:32&lt;00:08,    1.74it/s]
 81%|########1 | Computing thresholds ... : 57/70 [00:32&lt;00:07,    1.73it/s]
 83%|########2 | Computing thresholds ... : 58/70 [00:33&lt;00:06,    1.73it/s]
 84%|########4 | Computing thresholds ... : 59/70 [00:34&lt;00:06,    1.73it/s]
 86%|########5 | Computing thresholds ... : 60/70 [00:34&lt;00:05,    1.73it/s]
 87%|########7 | Computing thresholds ... : 61/70 [00:35&lt;00:05,    1.73it/s]
 89%|########8 | Computing thresholds ... : 62/70 [00:35&lt;00:04,    1.72it/s]
 90%|######### | Computing thresholds ... : 63/70 [00:36&lt;00:04,    1.72it/s]
 91%|#########1| Computing thresholds ... : 64/70 [00:37&lt;00:03,    1.71it/s]
 93%|#########2| Computing thresholds ... : 65/70 [00:37&lt;00:02,    1.71it/s]
 94%|#########4| Computing thresholds ... : 66/70 [00:38&lt;00:02,    1.71it/s]
 96%|#########5| Computing thresholds ... : 67/70 [00:38&lt;00:01,    1.72it/s]
 97%|#########7| Computing thresholds ... : 68/70 [00:39&lt;00:01,    1.72it/s]
 99%|#########8| Computing thresholds ... : 69/70 [00:40&lt;00:00,    1.72it/s]
100%|##########| Computing thresholds ... : 70/70 [00:40&lt;00:00,    1.73it/s]
100%|##########| Computing thresholds ... : 70/70 [00:40&lt;00:00,    1.72it/s]



  0%|          | Repairing epochs : 0/197 [00:00&lt;?,       ?it/s]


  4%|3         | Repairing epochs : 7/197 [00:00&lt;00:00,  399.65it/s]


  7%|7         | Repairing epochs : 14/197 [00:00&lt;00:00,  402.89it/s]


 11%|#         | Repairing epochs : 21/197 [00:00&lt;00:00,  404.59it/s]


 14%|#4        | Repairing epochs : 28/197 [00:00&lt;00:00,  405.23it/s]


 18%|#7        | Repairing epochs : 35/197 [00:00&lt;00:00,  405.40it/s]


 21%|##1       | Repairing epochs : 42/197 [00:00&lt;00:00,  406.25it/s]


 25%|##4       | Repairing epochs : 49/197 [00:00&lt;00:00,  406.34it/s]


 28%|##8       | Repairing epochs : 56/197 [00:00&lt;00:00,  406.68it/s]


 32%|###1      | Repairing epochs : 63/197 [00:00&lt;00:00,  406.91it/s]


 36%|###5      | Repairing epochs : 70/197 [00:00&lt;00:00,  406.82it/s]


 39%|###9      | Repairing epochs : 77/197 [00:00&lt;00:00,  407.09it/s]


 43%|####2     | Repairing epochs : 84/197 [00:00&lt;00:00,  407.11it/s]


 46%|####6     | Repairing epochs : 91/197 [00:00&lt;00:00,  407.20it/s]


 50%|####9     | Repairing epochs : 98/197 [00:00&lt;00:00,  407.03it/s]


 53%|#####3    | Repairing epochs : 105/197 [00:00&lt;00:00,  406.95it/s]


 57%|#####6    | Repairing epochs : 112/197 [00:00&lt;00:00,  407.01it/s]


 60%|######    | Repairing epochs : 119/197 [00:00&lt;00:00,  407.02it/s]


 64%|######3   | Repairing epochs : 126/197 [00:00&lt;00:00,  407.10it/s]


 68%|######7   | Repairing epochs : 133/197 [00:00&lt;00:00,  407.16it/s]


 71%|#######1  | Repairing epochs : 140/197 [00:00&lt;00:00,  407.18it/s]


 75%|#######4  | Repairing epochs : 147/197 [00:00&lt;00:00,  407.17it/s]


 78%|#######8  | Repairing epochs : 154/197 [00:00&lt;00:00,  407.14it/s]


 82%|########1 | Repairing epochs : 161/197 [00:00&lt;00:00,  407.17it/s]


 85%|########5 | Repairing epochs : 168/197 [00:00&lt;00:00,  407.19it/s]


 89%|########8 | Repairing epochs : 175/197 [00:00&lt;00:00,  407.26it/s]


 92%|#########2| Repairing epochs : 182/197 [00:00&lt;00:00,  407.30it/s]


 96%|#########5| Repairing epochs : 189/197 [00:00&lt;00:00,  407.20it/s]


 99%|#########9| Repairing epochs : 196/197 [00:00&lt;00:00,  407.29it/s]
100%|##########| Repairing epochs : 197/197 [00:00&lt;00:00,  406.90it/s]


  0%|          | n_interp : 0/3 [00:00&lt;?,       ?it/s]


  0%|          | Repairing epochs : 0/197 [00:00&lt;?,       ?it/s]


  1%|1         | Repairing epochs : 2/197 [00:00&lt;00:01,  107.87it/s]


  2%|2         | Repairing epochs : 4/197 [00:00&lt;00:02,   94.08it/s]


  3%|3         | Repairing epochs : 6/197 [00:00&lt;00:02,   92.56it/s]


  4%|4         | Repairing epochs : 8/197 [00:00&lt;00:02,   92.04it/s]


  5%|5         | Repairing epochs : 10/197 [00:00&lt;00:02,   91.55it/s]


  6%|6         | Repairing epochs : 12/197 [00:00&lt;00:02,   91.27it/s]


  7%|7         | Repairing epochs : 14/197 [00:00&lt;00:02,   91.12it/s]


  8%|8         | Repairing epochs : 16/197 [00:00&lt;00:01,   90.96it/s]


  9%|9         | Repairing epochs : 18/197 [00:00&lt;00:01,   90.85it/s]


 10%|#         | Repairing epochs : 20/197 [00:00&lt;00:02,   87.36it/s]


 11%|#         | Repairing epochs : 21/197 [00:00&lt;00:02,   82.15it/s]


 11%|#1        | Repairing epochs : 22/197 [00:00&lt;00:02,   78.26it/s]


 12%|#1        | Repairing epochs : 23/197 [00:00&lt;00:02,   75.03it/s]


 12%|#2        | Repairing epochs : 24/197 [00:00&lt;00:02,   72.20it/s]


 13%|#2        | Repairing epochs : 25/197 [00:00&lt;00:02,   69.72it/s]


 14%|#3        | Repairing epochs : 27/197 [00:00&lt;00:02,   71.37it/s]


 15%|#4        | Repairing epochs : 29/197 [00:00&lt;00:02,   72.92it/s]


 16%|#5        | Repairing epochs : 31/197 [00:00&lt;00:02,   74.32it/s]


 17%|#6        | Repairing epochs : 33/197 [00:00&lt;00:02,   73.83it/s]


 17%|#7        | Repairing epochs : 34/197 [00:00&lt;00:02,   71.67it/s]


 18%|#7        | Repairing epochs : 35/197 [00:00&lt;00:02,   69.71it/s]


 18%|#8        | Repairing epochs : 36/197 [00:00&lt;00:02,   67.05it/s]


 19%|#8        | Repairing epochs : 37/197 [00:00&lt;00:02,   65.57it/s]


 19%|#9        | Repairing epochs : 38/197 [00:00&lt;00:02,   64.17it/s]


 20%|#9        | Repairing epochs : 39/197 [00:00&lt;00:02,   62.86it/s]


 20%|##        | Repairing epochs : 40/197 [00:00&lt;00:02,   61.68it/s]


 21%|##        | Repairing epochs : 41/197 [00:00&lt;00:02,   60.61it/s]


 21%|##1       | Repairing epochs : 42/197 [00:00&lt;00:02,   59.48it/s]


 22%|##1       | Repairing epochs : 43/197 [00:00&lt;00:02,   58.39it/s]


 22%|##2       | Repairing epochs : 44/197 [00:00&lt;00:02,   57.35it/s]


 23%|##2       | Repairing epochs : 45/197 [00:00&lt;00:02,   56.58it/s]


 24%|##3       | Repairing epochs : 47/197 [00:00&lt;00:02,   57.26it/s]


 24%|##4       | Repairing epochs : 48/197 [00:00&lt;00:02,   56.53it/s]


 25%|##4       | Repairing epochs : 49/197 [00:00&lt;00:02,   56.71it/s]


 26%|##5       | Repairing epochs : 51/197 [00:00&lt;00:02,   58.80it/s]


 27%|##6       | Repairing epochs : 53/197 [00:00&lt;00:02,   60.53it/s]


 28%|##7       | Repairing epochs : 55/197 [00:00&lt;00:02,   61.21it/s]


 28%|##8       | Repairing epochs : 56/197 [00:00&lt;00:02,   60.21it/s]


 29%|##8       | Repairing epochs : 57/197 [00:00&lt;00:02,   59.27it/s]


 29%|##9       | Repairing epochs : 58/197 [00:00&lt;00:02,   58.25it/s]


 30%|##9       | Repairing epochs : 59/197 [00:00&lt;00:02,   57.49it/s]


 31%|###       | Repairing epochs : 61/197 [00:00&lt;00:02,   57.86it/s]


 32%|###1      | Repairing epochs : 63/197 [00:01&lt;00:02,   58.13it/s]


 32%|###2      | Repairing epochs : 64/197 [00:01&lt;00:02,   57.42it/s]


 33%|###2      | Repairing epochs : 65/197 [00:01&lt;00:02,   56.56it/s]


 34%|###3      | Repairing epochs : 66/197 [00:01&lt;00:02,   55.96it/s]


 34%|###4      | Repairing epochs : 67/197 [00:01&lt;00:02,   55.36it/s]


 35%|###4      | Repairing epochs : 68/197 [00:01&lt;00:02,   54.61it/s]


 35%|###5      | Repairing epochs : 69/197 [00:01&lt;00:02,   54.12it/s]


 37%|###6      | Repairing epochs : 72/197 [00:01&lt;00:02,   56.02it/s]


 38%|###7      | Repairing epochs : 74/197 [00:01&lt;00:02,   57.55it/s]


 39%|###8      | Repairing epochs : 76/197 [00:01&lt;00:02,   58.95it/s]


 40%|###9      | Repairing epochs : 78/197 [00:01&lt;00:01,   60.35it/s]


 40%|####      | Repairing epochs : 79/197 [00:01&lt;00:01,   59.53it/s]


 41%|####      | Repairing epochs : 80/197 [00:01&lt;00:01,   58.76it/s]


 41%|####1     | Repairing epochs : 81/197 [00:01&lt;00:02,   57.99it/s]


 42%|####1     | Repairing epochs : 82/197 [00:01&lt;00:02,   57.29it/s]


 42%|####2     | Repairing epochs : 83/197 [00:01&lt;00:02,   56.53it/s]


 43%|####2     | Repairing epochs : 84/197 [00:01&lt;00:02,   55.91it/s]


 43%|####3     | Repairing epochs : 85/197 [00:01&lt;00:02,   55.35it/s]


 44%|####3     | Repairing epochs : 86/197 [00:01&lt;00:02,   54.85it/s]


 44%|####4     | Repairing epochs : 87/197 [00:01&lt;00:02,   54.38it/s]


 45%|####4     | Repairing epochs : 88/197 [00:01&lt;00:02,   53.75it/s]


 46%|####5     | Repairing epochs : 90/197 [00:01&lt;00:01,   56.18it/s]


 46%|####6     | Repairing epochs : 91/197 [00:01&lt;00:01,   55.52it/s]


 47%|####6     | Repairing epochs : 92/197 [00:01&lt;00:01,   55.01it/s]


 47%|####7     | Repairing epochs : 93/197 [00:01&lt;00:01,   54.33it/s]


 48%|####7     | Repairing epochs : 94/197 [00:01&lt;00:01,   53.86it/s]


 48%|####8     | Repairing epochs : 95/197 [00:01&lt;00:01,   53.35it/s]


 49%|####8     | Repairing epochs : 96/197 [00:01&lt;00:01,   52.87it/s]


 49%|####9     | Repairing epochs : 97/197 [00:01&lt;00:01,   52.43it/s]


 50%|####9     | Repairing epochs : 98/197 [00:01&lt;00:01,   51.95it/s]


 50%|#####     | Repairing epochs : 99/197 [00:01&lt;00:01,   51.62it/s]


 51%|#####     | Repairing epochs : 100/197 [00:01&lt;00:01,   51.11it/s]


 51%|#####1    | Repairing epochs : 101/197 [00:01&lt;00:01,   50.72it/s]


 52%|#####1    | Repairing epochs : 102/197 [00:01&lt;00:01,   50.36it/s]


 53%|#####2    | Repairing epochs : 104/197 [00:01&lt;00:01,   51.12it/s]


 53%|#####3    | Repairing epochs : 105/197 [00:01&lt;00:01,   50.72it/s]


 54%|#####3    | Repairing epochs : 106/197 [00:01&lt;00:01,   50.24it/s]


 55%|#####4    | Repairing epochs : 108/197 [00:01&lt;00:01,   51.04it/s]


 55%|#####5    | Repairing epochs : 109/197 [00:01&lt;00:01,   50.60it/s]


 56%|#####5    | Repairing epochs : 110/197 [00:01&lt;00:01,   50.27it/s]


 56%|#####6    | Repairing epochs : 111/197 [00:01&lt;00:01,   49.85it/s]


 57%|#####7    | Repairing epochs : 113/197 [00:01&lt;00:01,   51.59it/s]


 58%|#####8    | Repairing epochs : 115/197 [00:02&lt;00:01,   53.25it/s]


 59%|#####9    | Repairing epochs : 117/197 [00:02&lt;00:01,   55.45it/s]


 60%|#####9    | Repairing epochs : 118/197 [00:02&lt;00:01,   54.26it/s]


 60%|######    | Repairing epochs : 119/197 [00:02&lt;00:01,   53.85it/s]


 61%|######    | Repairing epochs : 120/197 [00:02&lt;00:01,   53.31it/s]


 61%|######1   | Repairing epochs : 121/197 [00:02&lt;00:01,   52.73it/s]


 62%|######1   | Repairing epochs : 122/197 [00:02&lt;00:01,   52.64it/s]


 63%|######2   | Repairing epochs : 124/197 [00:02&lt;00:01,   54.29it/s]


 64%|######3   | Repairing epochs : 126/197 [00:02&lt;00:01,   56.69it/s]


 65%|######4   | Repairing epochs : 128/197 [00:02&lt;00:01,   58.48it/s]


 65%|######5   | Repairing epochs : 129/197 [00:02&lt;00:01,   57.76it/s]


 66%|######5   | Repairing epochs : 130/197 [00:02&lt;00:01,   57.17it/s]


 66%|######6   | Repairing epochs : 131/197 [00:02&lt;00:01,   56.53it/s]


 67%|######7   | Repairing epochs : 132/197 [00:02&lt;00:01,   55.95it/s]


 68%|######7   | Repairing epochs : 133/197 [00:02&lt;00:01,   55.38it/s]


 68%|######8   | Repairing epochs : 134/197 [00:02&lt;00:01,   54.83it/s]


 69%|######8   | Repairing epochs : 135/197 [00:02&lt;00:01,   54.32it/s]


 69%|######9   | Repairing epochs : 136/197 [00:02&lt;00:01,   53.85it/s]


 70%|######9   | Repairing epochs : 137/197 [00:02&lt;00:01,   53.31it/s]


 70%|#######   | Repairing epochs : 138/197 [00:02&lt;00:01,   52.88it/s]


 71%|#######   | Repairing epochs : 139/197 [00:02&lt;00:01,   52.47it/s]


 71%|#######1  | Repairing epochs : 140/197 [00:02&lt;00:01,   52.13it/s]


 72%|#######1  | Repairing epochs : 141/197 [00:02&lt;00:01,   51.73it/s]


 72%|#######2  | Repairing epochs : 142/197 [00:02&lt;00:01,   51.35it/s]


 73%|#######2  | Repairing epochs : 143/197 [00:02&lt;00:01,   51.08it/s]


 73%|#######3  | Repairing epochs : 144/197 [00:02&lt;00:01,   50.79it/s]


 74%|#######3  | Repairing epochs : 145/197 [00:02&lt;00:01,   50.49it/s]


 74%|#######4  | Repairing epochs : 146/197 [00:02&lt;00:01,   50.13it/s]


 75%|#######5  | Repairing epochs : 148/197 [00:02&lt;00:00,   50.91it/s]


 76%|#######5  | Repairing epochs : 149/197 [00:02&lt;00:00,   50.43it/s]


 76%|#######6  | Repairing epochs : 150/197 [00:02&lt;00:00,   50.01it/s]


 77%|#######7  | Repairing epochs : 152/197 [00:02&lt;00:00,   50.93it/s]


 78%|#######8  | Repairing epochs : 154/197 [00:02&lt;00:00,   51.68it/s]


 79%|#######8  | Repairing epochs : 155/197 [00:02&lt;00:00,   51.22it/s]


 80%|#######9  | Repairing epochs : 157/197 [00:02&lt;00:00,   52.10it/s]


 80%|########  | Repairing epochs : 158/197 [00:02&lt;00:00,   51.57it/s]


 81%|########  | Repairing epochs : 159/197 [00:02&lt;00:00,   51.13it/s]


 81%|########1 | Repairing epochs : 160/197 [00:02&lt;00:00,   50.61it/s]


 82%|########1 | Repairing epochs : 161/197 [00:02&lt;00:00,   50.11it/s]


 83%|########3 | Repairing epochs : 164/197 [00:02&lt;00:00,   53.70it/s]


 84%|########3 | Repairing epochs : 165/197 [00:02&lt;00:00,   53.04it/s]


 84%|########4 | Repairing epochs : 166/197 [00:02&lt;00:00,   52.59it/s]


 85%|########4 | Repairing epochs : 167/197 [00:02&lt;00:00,   52.19it/s]


 85%|########5 | Repairing epochs : 168/197 [00:03&lt;00:00,   51.83it/s]


 86%|########6 | Repairing epochs : 170/197 [00:03&lt;00:00,   53.51it/s]


 87%|########7 | Repairing epochs : 172/197 [00:03&lt;00:00,   54.99it/s]


 88%|########8 | Repairing epochs : 174/197 [00:03&lt;00:00,   54.78it/s]


 89%|########8 | Repairing epochs : 175/197 [00:03&lt;00:00,   54.17it/s]


 89%|########9 | Repairing epochs : 176/197 [00:03&lt;00:00,   53.60it/s]


 90%|########9 | Repairing epochs : 177/197 [00:03&lt;00:00,   53.18it/s]


 90%|######### | Repairing epochs : 178/197 [00:03&lt;00:00,   52.62it/s]


 91%|######### | Repairing epochs : 179/197 [00:03&lt;00:00,   52.14it/s]


 91%|#########1| Repairing epochs : 180/197 [00:03&lt;00:00,   51.72it/s]


 92%|#########1| Repairing epochs : 181/197 [00:03&lt;00:00,   51.40it/s]


 93%|#########2| Repairing epochs : 183/197 [00:03&lt;00:00,   52.23it/s]


 93%|#########3| Repairing epochs : 184/197 [00:03&lt;00:00,   51.71it/s]


 94%|#########3| Repairing epochs : 185/197 [00:03&lt;00:00,   51.25it/s]


 94%|#########4| Repairing epochs : 186/197 [00:03&lt;00:00,   50.79it/s]


 95%|#########4| Repairing epochs : 187/197 [00:03&lt;00:00,   50.55it/s]


 95%|#########5| Repairing epochs : 188/197 [00:03&lt;00:00,   50.26it/s]


 96%|#########6| Repairing epochs : 190/197 [00:03&lt;00:00,   51.15it/s]


 97%|#########6| Repairing epochs : 191/197 [00:03&lt;00:00,   50.80it/s]


 97%|#########7| Repairing epochs : 192/197 [00:03&lt;00:00,   50.36it/s]


 98%|#########7| Repairing epochs : 193/197 [00:03&lt;00:00,   50.10it/s]


 98%|#########8| Repairing epochs : 194/197 [00:03&lt;00:00,   49.69it/s]


 99%|#########9| Repairing epochs : 196/197 [00:03&lt;00:00,   51.12it/s]
100%|##########| Repairing epochs : 197/197 [00:03&lt;00:00,   55.12it/s]




  0%|          | Fold : 0/10 [00:00&lt;?,       ?it/s]



 10%|#         | Fold : 1/10 [00:00&lt;00:02,    3.84it/s]



 20%|##        | Fold : 2/10 [00:00&lt;00:01,    4.19it/s]



 30%|###       | Fold : 3/10 [00:00&lt;00:01,    4.33it/s]



 40%|####      | Fold : 4/10 [00:00&lt;00:01,    4.39it/s]



 50%|#####     | Fold : 5/10 [00:01&lt;00:01,    4.43it/s]



 60%|######    | Fold : 6/10 [00:01&lt;00:00,    4.46it/s]



 70%|#######   | Fold : 7/10 [00:01&lt;00:00,    4.48it/s]



 80%|########  | Fold : 8/10 [00:01&lt;00:00,    4.51it/s]



 90%|######### | Fold : 9/10 [00:01&lt;00:00,    4.53it/s]



100%|##########| Fold : 10/10 [00:02&lt;00:00,    4.54it/s]
100%|##########| Fold : 10/10 [00:02&lt;00:00,    4.52it/s]


 33%|###3      | n_interp : 1/3 [00:05&lt;00:11,    5.97s/it]


  0%|          | Repairing epochs : 0/197 [00:00&lt;?,       ?it/s]


  1%|1         | Repairing epochs : 2/197 [00:00&lt;00:01,  108.34it/s]


  2%|2         | Repairing epochs : 4/197 [00:00&lt;00:02,   96.44it/s]


  3%|3         | Repairing epochs : 6/197 [00:00&lt;00:02,   92.73it/s]


  4%|4         | Repairing epochs : 8/197 [00:00&lt;00:02,   91.48it/s]


  5%|5         | Repairing epochs : 10/197 [00:00&lt;00:02,   90.16it/s]


  6%|6         | Repairing epochs : 12/197 [00:00&lt;00:02,   90.34it/s]


  7%|7         | Repairing epochs : 14/197 [00:00&lt;00:02,   90.23it/s]


  8%|8         | Repairing epochs : 16/197 [00:00&lt;00:02,   90.28it/s]


  9%|9         | Repairing epochs : 18/197 [00:00&lt;00:01,   90.00it/s]


 10%|#         | Repairing epochs : 20/197 [00:00&lt;00:01,   89.87it/s]


 11%|#1        | Repairing epochs : 22/197 [00:00&lt;00:01,   89.44it/s]


 12%|#2        | Repairing epochs : 24/197 [00:00&lt;00:01,   89.51it/s]


 13%|#3        | Repairing epochs : 26/197 [00:00&lt;00:01,   89.25it/s]


 14%|#4        | Repairing epochs : 28/197 [00:00&lt;00:01,   89.10it/s]


 15%|#5        | Repairing epochs : 30/197 [00:00&lt;00:01,   89.25it/s]


 16%|#6        | Repairing epochs : 32/197 [00:00&lt;00:01,   89.25it/s]


 17%|#7        | Repairing epochs : 34/197 [00:00&lt;00:01,   89.51it/s]


 18%|#8        | Repairing epochs : 36/197 [00:00&lt;00:01,   89.04it/s]


 19%|#9        | Repairing epochs : 38/197 [00:00&lt;00:01,   88.97it/s]


 20%|##        | Repairing epochs : 40/197 [00:00&lt;00:01,   89.07it/s]


 21%|##1       | Repairing epochs : 42/197 [00:00&lt;00:01,   89.15it/s]


 22%|##2       | Repairing epochs : 44/197 [00:00&lt;00:01,   89.11it/s]


 23%|##3       | Repairing epochs : 46/197 [00:00&lt;00:01,   90.96it/s]


 24%|##4       | Repairing epochs : 48/197 [00:00&lt;00:01,   90.91it/s]


 25%|##5       | Repairing epochs : 50/197 [00:00&lt;00:01,   90.78it/s]


 27%|##6       | Repairing epochs : 53/197 [00:00&lt;00:01,   92.49it/s]


 28%|##7       | Repairing epochs : 55/197 [00:00&lt;00:01,   92.22it/s]


 29%|##8       | Repairing epochs : 57/197 [00:00&lt;00:01,   91.76it/s]


 30%|##9       | Repairing epochs : 59/197 [00:00&lt;00:01,   91.59it/s]


 31%|###1      | Repairing epochs : 62/197 [00:00&lt;00:01,   94.91it/s]


 32%|###2      | Repairing epochs : 64/197 [00:00&lt;00:01,   92.76it/s]


 33%|###2      | Repairing epochs : 65/197 [00:00&lt;00:01,   89.74it/s]


 34%|###3      | Repairing epochs : 66/197 [00:00&lt;00:01,   86.91it/s]


 34%|###4      | Repairing epochs : 67/197 [00:00&lt;00:01,   84.35it/s]


 35%|###5      | Repairing epochs : 69/197 [00:00&lt;00:01,   84.22it/s]


 37%|###6      | Repairing epochs : 72/197 [00:00&lt;00:01,   87.80it/s]


 38%|###7      | Repairing epochs : 74/197 [00:00&lt;00:01,   87.89it/s]


 39%|###8      | Repairing epochs : 76/197 [00:00&lt;00:01,   86.96it/s]


 39%|###9      | Repairing epochs : 77/197 [00:00&lt;00:01,   84.54it/s]


 40%|###9      | Repairing epochs : 78/197 [00:00&lt;00:01,   82.23it/s]


 40%|####      | Repairing epochs : 79/197 [00:00&lt;00:01,   80.94it/s]


 41%|####1     | Repairing epochs : 81/197 [00:00&lt;00:01,   81.32it/s]


 42%|####2     | Repairing epochs : 83/197 [00:00&lt;00:01,   81.60it/s]


 43%|####3     | Repairing epochs : 85/197 [00:00&lt;00:01,   82.03it/s]


 44%|####4     | Repairing epochs : 87/197 [00:01&lt;00:01,   82.31it/s]


 46%|####5     | Repairing epochs : 90/197 [00:01&lt;00:01,   85.66it/s]


 47%|####6     | Repairing epochs : 92/197 [00:01&lt;00:01,   85.84it/s]


 48%|####7     | Repairing epochs : 94/197 [00:01&lt;00:01,   86.11it/s]


 49%|####8     | Repairing epochs : 96/197 [00:01&lt;00:01,   86.18it/s]


 50%|####9     | Repairing epochs : 98/197 [00:01&lt;00:01,   86.47it/s]


 51%|#####     | Repairing epochs : 100/197 [00:01&lt;00:01,   86.55it/s]


 52%|#####1    | Repairing epochs : 102/197 [00:01&lt;00:01,   86.76it/s]


 53%|#####2    | Repairing epochs : 104/197 [00:01&lt;00:01,   88.17it/s]


 54%|#####3    | Repairing epochs : 106/197 [00:01&lt;00:01,   88.05it/s]


 55%|#####5    | Repairing epochs : 109/197 [00:01&lt;00:00,   89.49it/s]


 56%|#####6    | Repairing epochs : 111/197 [00:01&lt;00:00,   89.24it/s]


 57%|#####7    | Repairing epochs : 113/197 [00:01&lt;00:00,   89.10it/s]


 58%|#####8    | Repairing epochs : 115/197 [00:01&lt;00:00,   88.92it/s]


 59%|#####9    | Repairing epochs : 117/197 [00:01&lt;00:00,   90.16it/s]


 60%|######    | Repairing epochs : 119/197 [00:01&lt;00:00,   89.97it/s]


 61%|######1   | Repairing epochs : 121/197 [00:01&lt;00:00,   89.74it/s]


 62%|######1   | Repairing epochs : 122/197 [00:01&lt;00:00,   87.50it/s]


 62%|######2   | Repairing epochs : 123/197 [00:01&lt;00:00,   85.14it/s]


 63%|######2   | Repairing epochs : 124/197 [00:01&lt;00:00,   84.08it/s]


 64%|######4   | Repairing epochs : 127/197 [00:01&lt;00:00,   87.19it/s]


 65%|######5   | Repairing epochs : 129/197 [00:01&lt;00:00,   87.17it/s]


 66%|######6   | Repairing epochs : 131/197 [00:01&lt;00:00,   87.25it/s]


 68%|######7   | Repairing epochs : 133/197 [00:01&lt;00:00,   84.37it/s]


 68%|######8   | Repairing epochs : 134/197 [00:01&lt;00:00,   82.42it/s]


 69%|######8   | Repairing epochs : 135/197 [00:01&lt;00:00,   80.43it/s]


 69%|######9   | Repairing epochs : 136/197 [00:01&lt;00:00,   78.77it/s]


 70%|#######   | Repairing epochs : 138/197 [00:01&lt;00:00,   79.37it/s]


 71%|#######1  | Repairing epochs : 140/197 [00:01&lt;00:00,   79.93it/s]


 72%|#######2  | Repairing epochs : 142/197 [00:01&lt;00:00,   77.87it/s]


 73%|#######2  | Repairing epochs : 143/197 [00:01&lt;00:00,   76.18it/s]


 73%|#######3  | Repairing epochs : 144/197 [00:01&lt;00:00,   74.56it/s]


 74%|#######3  | Repairing epochs : 145/197 [00:01&lt;00:00,   73.18it/s]


 75%|#######5  | Repairing epochs : 148/197 [00:01&lt;00:00,   75.63it/s]


 76%|#######6  | Repairing epochs : 150/197 [00:01&lt;00:00,   73.57it/s]


 77%|#######7  | Repairing epochs : 152/197 [00:01&lt;00:00,   73.14it/s]


 78%|#######8  | Repairing epochs : 154/197 [00:01&lt;00:00,   72.58it/s]


 80%|#######9  | Repairing epochs : 157/197 [00:01&lt;00:00,   74.75it/s]


 81%|########  | Repairing epochs : 159/197 [00:01&lt;00:00,   75.39it/s]


 82%|########1 | Repairing epochs : 161/197 [00:01&lt;00:00,   75.94it/s]


 84%|########3 | Repairing epochs : 165/197 [00:01&lt;00:00,   80.45it/s]


 85%|########4 | Repairing epochs : 167/197 [00:01&lt;00:00,   80.80it/s]


 86%|########5 | Repairing epochs : 169/197 [00:02&lt;00:00,   81.22it/s]


 87%|########6 | Repairing epochs : 171/197 [00:02&lt;00:00,   81.63it/s]


 88%|########7 | Repairing epochs : 173/197 [00:02&lt;00:00,   81.92it/s]


 89%|########8 | Repairing epochs : 175/197 [00:02&lt;00:00,   82.14it/s]


 90%|########9 | Repairing epochs : 177/197 [00:02&lt;00:00,   82.51it/s]


 91%|######### | Repairing epochs : 179/197 [00:02&lt;00:00,   82.59it/s]


 91%|#########1| Repairing epochs : 180/197 [00:02&lt;00:00,   81.16it/s]


 92%|#########1| Repairing epochs : 181/197 [00:02&lt;00:00,   79.40it/s]


 93%|#########2| Repairing epochs : 183/197 [00:02&lt;00:00,   78.42it/s]


 93%|#########3| Repairing epochs : 184/197 [00:02&lt;00:00,   76.93it/s]


 94%|#########3| Repairing epochs : 185/197 [00:02&lt;00:00,   75.26it/s]


 94%|#########4| Repairing epochs : 186/197 [00:02&lt;00:00,   73.84it/s]


 95%|#########4| Repairing epochs : 187/197 [00:02&lt;00:00,   72.30it/s]


 96%|#########6| Repairing epochs : 190/197 [00:02&lt;00:00,   73.89it/s]


 97%|#########6| Repairing epochs : 191/197 [00:02&lt;00:00,   72.47it/s]


 97%|#########7| Repairing epochs : 192/197 [00:02&lt;00:00,   71.16it/s]


 98%|#########7| Repairing epochs : 193/197 [00:02&lt;00:00,   69.80it/s]


 98%|#########8| Repairing epochs : 194/197 [00:02&lt;00:00,   68.91it/s]


 99%|#########9| Repairing epochs : 196/197 [00:02&lt;00:00,   69.88it/s]
100%|##########| Repairing epochs : 197/197 [00:02&lt;00:00,   80.50it/s]




  0%|          | Fold : 0/10 [00:00&lt;?,       ?it/s]



 10%|#         | Fold : 1/10 [00:00&lt;00:02,    4.35it/s]



 20%|##        | Fold : 2/10 [00:00&lt;00:01,    4.47it/s]



 30%|###       | Fold : 3/10 [00:00&lt;00:01,    4.51it/s]



 40%|####      | Fold : 4/10 [00:00&lt;00:01,    4.52it/s]



 50%|#####     | Fold : 5/10 [00:01&lt;00:01,    4.54it/s]



 60%|######    | Fold : 6/10 [00:01&lt;00:00,    4.55it/s]



 70%|#######   | Fold : 7/10 [00:01&lt;00:00,    4.56it/s]



 80%|########  | Fold : 8/10 [00:01&lt;00:00,    4.57it/s]



 90%|######### | Fold : 9/10 [00:01&lt;00:00,    4.59it/s]



100%|##########| Fold : 10/10 [00:02&lt;00:00,    4.58it/s]
100%|##########| Fold : 10/10 [00:02&lt;00:00,    4.57it/s]


 67%|######6   | n_interp : 2/3 [00:10&lt;00:05,    5.36s/it]


  0%|          | Repairing epochs : 0/197 [00:00&lt;?,       ?it/s]


  2%|1         | Repairing epochs : 3/197 [00:00&lt;00:01,  120.22it/s]


  3%|2         | Repairing epochs : 5/197 [00:00&lt;00:02,   79.55it/s]


  3%|3         | Repairing epochs : 6/197 [00:00&lt;00:02,   68.68it/s]


  4%|3         | Repairing epochs : 7/197 [00:00&lt;00:02,   63.52it/s]


  4%|4         | Repairing epochs : 8/197 [00:00&lt;00:03,   59.28it/s]


  5%|5         | Repairing epochs : 10/197 [00:00&lt;00:02,   63.99it/s]


  6%|6         | Repairing epochs : 12/197 [00:00&lt;00:02,   67.03it/s]


  7%|7         | Repairing epochs : 14/197 [00:00&lt;00:02,   70.01it/s]


  8%|8         | Repairing epochs : 16/197 [00:00&lt;00:02,   72.98it/s]


  9%|9         | Repairing epochs : 18/197 [00:00&lt;00:02,   74.98it/s]


 10%|#         | Repairing epochs : 20/197 [00:00&lt;00:02,   76.27it/s]


 11%|#1        | Repairing epochs : 22/197 [00:00&lt;00:02,   77.97it/s]


 12%|#2        | Repairing epochs : 24/197 [00:00&lt;00:02,   78.84it/s]


 13%|#3        | Repairing epochs : 26/197 [00:00&lt;00:02,   79.96it/s]


 14%|#4        | Repairing epochs : 28/197 [00:00&lt;00:02,   80.93it/s]


 15%|#5        | Repairing epochs : 30/197 [00:00&lt;00:02,   81.78it/s]


 16%|#6        | Repairing epochs : 32/197 [00:00&lt;00:01,   82.62it/s]


 17%|#7        | Repairing epochs : 34/197 [00:00&lt;00:01,   83.17it/s]


 18%|#8        | Repairing epochs : 36/197 [00:00&lt;00:01,   83.39it/s]


 19%|#9        | Repairing epochs : 38/197 [00:00&lt;00:01,   83.57it/s]


 20%|##        | Repairing epochs : 40/197 [00:00&lt;00:01,   84.00it/s]


 21%|##1       | Repairing epochs : 42/197 [00:00&lt;00:01,   84.58it/s]


 22%|##2       | Repairing epochs : 44/197 [00:00&lt;00:01,   84.61it/s]


 24%|##3       | Repairing epochs : 47/197 [00:00&lt;00:01,   86.89it/s]


 25%|##4       | Repairing epochs : 49/197 [00:00&lt;00:01,   87.06it/s]


 26%|##6       | Repairing epochs : 52/197 [00:00&lt;00:01,   89.06it/s]


 27%|##7       | Repairing epochs : 54/197 [00:00&lt;00:01,   89.05it/s]


 28%|##8       | Repairing epochs : 56/197 [00:00&lt;00:01,   89.05it/s]


 29%|##9       | Repairing epochs : 58/197 [00:00&lt;00:01,   89.42it/s]


 30%|###       | Repairing epochs : 60/197 [00:00&lt;00:01,   90.86it/s]


 32%|###1      | Repairing epochs : 63/197 [00:00&lt;00:01,   92.27it/s]


 33%|###2      | Repairing epochs : 65/197 [00:00&lt;00:01,   92.10it/s]


 34%|###4      | Repairing epochs : 67/197 [00:00&lt;00:01,   91.87it/s]


 35%|###5      | Repairing epochs : 69/197 [00:00&lt;00:01,   91.95it/s]


 37%|###6      | Repairing epochs : 72/197 [00:00&lt;00:01,   95.00it/s]


 38%|###7      | Repairing epochs : 74/197 [00:00&lt;00:01,   94.66it/s]


 39%|###8      | Repairing epochs : 76/197 [00:00&lt;00:01,   94.18it/s]


 40%|###9      | Repairing epochs : 78/197 [00:00&lt;00:01,   93.73it/s]


 41%|####      | Repairing epochs : 80/197 [00:00&lt;00:01,   93.52it/s]


 42%|####1     | Repairing epochs : 82/197 [00:00&lt;00:01,   92.99it/s]


 43%|####2     | Repairing epochs : 84/197 [00:00&lt;00:01,   92.66it/s]


 44%|####3     | Repairing epochs : 86/197 [00:00&lt;00:01,   89.77it/s]


 44%|####4     | Repairing epochs : 87/197 [00:01&lt;00:01,   87.09it/s]


 45%|####4     | Repairing epochs : 88/197 [00:01&lt;00:01,   84.85it/s]


 46%|####6     | Repairing epochs : 91/197 [00:01&lt;00:01,   88.04it/s]


 47%|####7     | Repairing epochs : 93/197 [00:01&lt;00:01,   88.13it/s]


 48%|####8     | Repairing epochs : 95/197 [00:01&lt;00:01,   88.36it/s]


 49%|####9     | Repairing epochs : 97/197 [00:01&lt;00:01,   88.55it/s]


 50%|#####     | Repairing epochs : 99/197 [00:01&lt;00:01,   88.72it/s]


 51%|#####1    | Repairing epochs : 101/197 [00:01&lt;00:01,   88.66it/s]


 53%|#####2    | Repairing epochs : 104/197 [00:01&lt;00:01,   89.95it/s]


 54%|#####3    | Repairing epochs : 106/197 [00:01&lt;00:01,   89.49it/s]


 55%|#####4    | Repairing epochs : 108/197 [00:01&lt;00:00,   90.38it/s]


 56%|#####5    | Repairing epochs : 110/197 [00:01&lt;00:00,   89.19it/s]


 57%|#####6    | Repairing epochs : 112/197 [00:01&lt;00:00,   88.18it/s]


 57%|#####7    | Repairing epochs : 113/197 [00:01&lt;00:00,   85.58it/s]


 58%|#####7    | Repairing epochs : 114/197 [00:01&lt;00:00,   83.07it/s]


 59%|#####8    | Repairing epochs : 116/197 [00:01&lt;00:00,   83.15it/s]


 60%|#####9    | Repairing epochs : 118/197 [00:01&lt;00:00,   84.58it/s]


 61%|######    | Repairing epochs : 120/197 [00:01&lt;00:00,   84.42it/s]


 61%|######1   | Repairing epochs : 121/197 [00:01&lt;00:00,   82.59it/s]


 62%|######1   | Repairing epochs : 122/197 [00:01&lt;00:00,   80.78it/s]


 62%|######2   | Repairing epochs : 123/197 [00:01&lt;00:00,   78.84it/s]


 63%|######3   | Repairing epochs : 125/197 [00:01&lt;00:00,   79.43it/s]


 65%|######4   | Repairing epochs : 128/197 [00:01&lt;00:00,   82.71it/s]


 66%|######5   | Repairing epochs : 130/197 [00:01&lt;00:00,   83.18it/s]


 67%|######7   | Repairing epochs : 132/197 [00:01&lt;00:00,   83.51it/s]


 68%|######8   | Repairing epochs : 134/197 [00:01&lt;00:00,   83.90it/s]


 69%|######9   | Repairing epochs : 136/197 [00:01&lt;00:00,   84.17it/s]


 70%|#######   | Repairing epochs : 138/197 [00:01&lt;00:00,   84.47it/s]


 71%|#######1  | Repairing epochs : 140/197 [00:01&lt;00:00,   84.67it/s]


 72%|#######2  | Repairing epochs : 142/197 [00:01&lt;00:00,   84.83it/s]


 73%|#######2  | Repairing epochs : 143/197 [00:01&lt;00:00,   82.64it/s]


 73%|#######3  | Repairing epochs : 144/197 [00:01&lt;00:00,   81.59it/s]


 74%|#######3  | Repairing epochs : 145/197 [00:01&lt;00:00,   79.04it/s]


 74%|#######4  | Repairing epochs : 146/197 [00:01&lt;00:00,   78.07it/s]


 75%|#######5  | Repairing epochs : 148/197 [00:01&lt;00:00,   79.70it/s]


 76%|#######5  | Repairing epochs : 149/197 [00:01&lt;00:00,   79.05it/s]


 76%|#######6  | Repairing epochs : 150/197 [00:01&lt;00:00,   76.91it/s]


 77%|#######7  | Repairing epochs : 152/197 [00:01&lt;00:00,   76.14it/s]


 78%|#######8  | Repairing epochs : 154/197 [00:01&lt;00:00,   75.16it/s]


 80%|#######9  | Repairing epochs : 157/197 [00:01&lt;00:00,   77.50it/s]


 81%|########  | Repairing epochs : 159/197 [00:01&lt;00:00,   78.07it/s]


 82%|########1 | Repairing epochs : 161/197 [00:01&lt;00:00,   78.53it/s]


 84%|########3 | Repairing epochs : 165/197 [00:01&lt;00:00,   83.24it/s]


 85%|########4 | Repairing epochs : 167/197 [00:01&lt;00:00,   83.55it/s]


 86%|########5 | Repairing epochs : 169/197 [00:02&lt;00:00,   83.92it/s]


 87%|########6 | Repairing epochs : 171/197 [00:02&lt;00:00,   84.14it/s]


 88%|########7 | Repairing epochs : 173/197 [00:02&lt;00:00,   84.34it/s]


 89%|########8 | Repairing epochs : 175/197 [00:02&lt;00:00,   84.47it/s]


 90%|########9 | Repairing epochs : 177/197 [00:02&lt;00:00,   84.60it/s]


 90%|######### | Repairing epochs : 178/197 [00:02&lt;00:00,   82.68it/s]


 91%|######### | Repairing epochs : 179/197 [00:02&lt;00:00,   80.65it/s]


 91%|#########1| Repairing epochs : 180/197 [00:02&lt;00:00,   78.77it/s]


 92%|#########1| Repairing epochs : 181/197 [00:02&lt;00:00,   77.98it/s]


 93%|#########2| Repairing epochs : 183/197 [00:02&lt;00:00,   76.53it/s]


 93%|#########3| Repairing epochs : 184/197 [00:02&lt;00:00,   74.96it/s]


 94%|#########4| Repairing epochs : 186/197 [00:02&lt;00:00,   72.31it/s]


 95%|#########5| Repairing epochs : 188/197 [00:02&lt;00:00,   71.34it/s]


 97%|#########6| Repairing epochs : 191/197 [00:02&lt;00:00,   73.66it/s]


 98%|#########7| Repairing epochs : 193/197 [00:02&lt;00:00,   74.30it/s]


 99%|#########8| Repairing epochs : 195/197 [00:02&lt;00:00,   74.97it/s]


100%|##########| Repairing epochs : 197/197 [00:02&lt;00:00,   73.72it/s]
100%|##########| Repairing epochs : 197/197 [00:02&lt;00:00,   81.40it/s]




  0%|          | Fold : 0/10 [00:00&lt;?,       ?it/s]



 10%|#         | Fold : 1/10 [00:00&lt;00:01,    6.65it/s]



 20%|##        | Fold : 2/10 [00:00&lt;00:01,    7.01it/s]



 30%|###       | Fold : 3/10 [00:00&lt;00:00,    7.14it/s]



 40%|####      | Fold : 4/10 [00:00&lt;00:00,    7.18it/s]



 50%|#####     | Fold : 5/10 [00:00&lt;00:00,    7.23it/s]



 60%|######    | Fold : 6/10 [00:00&lt;00:00,    7.26it/s]



 70%|#######   | Fold : 7/10 [00:00&lt;00:00,    7.27it/s]



 80%|########  | Fold : 8/10 [00:01&lt;00:00,    7.31it/s]



 90%|######### | Fold : 9/10 [00:01&lt;00:00,    7.34it/s]



100%|##########| Fold : 10/10 [00:01&lt;00:00,    7.35it/s]
100%|##########| Fold : 10/10 [00:01&lt;00:00,    7.32it/s]


100%|##########| n_interp : 3/3 [00:14&lt;00:00,    4.83s/it]
100%|##########| n_interp : 3/3 [00:14&lt;00:00,    4.86s/it]




Estimated consensus=1.00 and n_interpolate=32



  0%|          | Repairing epochs : 0/197 [00:00&lt;?,       ?it/s]


  2%|1         | Repairing epochs : 3/197 [00:00&lt;00:01,  117.07it/s]


  3%|2         | Repairing epochs : 5/197 [00:00&lt;00:02,   78.32it/s]


  3%|3         | Repairing epochs : 6/197 [00:00&lt;00:02,   67.85it/s]


  4%|3         | Repairing epochs : 7/197 [00:00&lt;00:03,   62.92it/s]


  4%|4         | Repairing epochs : 8/197 [00:00&lt;00:03,   60.01it/s]


  5%|5         | Repairing epochs : 10/197 [00:00&lt;00:02,   64.70it/s]


  6%|6         | Repairing epochs : 12/197 [00:00&lt;00:02,   68.15it/s]


  7%|7         | Repairing epochs : 14/197 [00:00&lt;00:02,   71.03it/s]


  8%|8         | Repairing epochs : 16/197 [00:00&lt;00:02,   73.95it/s]


  9%|9         | Repairing epochs : 18/197 [00:00&lt;00:02,   75.91it/s]


 10%|#         | Repairing epochs : 20/197 [00:00&lt;00:02,   77.27it/s]


 11%|#1        | Repairing epochs : 22/197 [00:00&lt;00:02,   78.97it/s]


 12%|#2        | Repairing epochs : 24/197 [00:00&lt;00:02,   79.86it/s]


 13%|#3        | Repairing epochs : 26/197 [00:00&lt;00:02,   81.00it/s]


 14%|#4        | Repairing epochs : 28/197 [00:00&lt;00:02,   81.96it/s]


 15%|#5        | Repairing epochs : 30/197 [00:00&lt;00:02,   82.79it/s]


 16%|#6        | Repairing epochs : 32/197 [00:00&lt;00:01,   83.39it/s]


 17%|#7        | Repairing epochs : 34/197 [00:00&lt;00:01,   83.93it/s]


 18%|#8        | Repairing epochs : 36/197 [00:00&lt;00:01,   84.09it/s]


 19%|#9        | Repairing epochs : 38/197 [00:00&lt;00:01,   84.23it/s]


 20%|##        | Repairing epochs : 40/197 [00:00&lt;00:01,   84.68it/s]


 21%|##1       | Repairing epochs : 42/197 [00:00&lt;00:01,   85.21it/s]


 22%|##2       | Repairing epochs : 44/197 [00:00&lt;00:01,   85.19it/s]


 24%|##3       | Repairing epochs : 47/197 [00:00&lt;00:01,   87.45it/s]


 25%|##4       | Repairing epochs : 49/197 [00:00&lt;00:01,   87.57it/s]


 26%|##6       | Repairing epochs : 52/197 [00:00&lt;00:01,   89.51it/s]


 27%|##7       | Repairing epochs : 54/197 [00:00&lt;00:01,   87.08it/s]


 28%|##7       | Repairing epochs : 55/197 [00:00&lt;00:01,   82.93it/s]


 28%|##8       | Repairing epochs : 56/197 [00:00&lt;00:01,   80.74it/s]


 29%|##9       | Repairing epochs : 58/197 [00:00&lt;00:01,   81.35it/s]


 30%|###       | Repairing epochs : 60/197 [00:00&lt;00:01,   83.17it/s]


 31%|###1      | Repairing epochs : 62/197 [00:00&lt;00:01,   84.93it/s]


 32%|###2      | Repairing epochs : 64/197 [00:00&lt;00:01,   85.07it/s]


 34%|###3      | Repairing epochs : 66/197 [00:00&lt;00:01,   85.25it/s]


 35%|###4      | Repairing epochs : 68/197 [00:00&lt;00:01,   85.56it/s]


 36%|###6      | Repairing epochs : 71/197 [00:00&lt;00:01,   89.10it/s]


 37%|###7      | Repairing epochs : 73/197 [00:00&lt;00:01,   89.08it/s]


 38%|###8      | Repairing epochs : 75/197 [00:00&lt;00:01,   89.03it/s]


 39%|###9      | Repairing epochs : 77/197 [00:00&lt;00:01,   88.74it/s]


 40%|####      | Repairing epochs : 79/197 [00:00&lt;00:01,   88.33it/s]


 41%|####1     | Repairing epochs : 81/197 [00:00&lt;00:01,   88.07it/s]


 42%|####2     | Repairing epochs : 83/197 [00:00&lt;00:01,   88.18it/s]


 43%|####3     | Repairing epochs : 85/197 [00:00&lt;00:01,   88.24it/s]


 44%|####3     | Repairing epochs : 86/197 [00:01&lt;00:01,   86.37it/s]


 44%|####4     | Repairing epochs : 87/197 [00:01&lt;00:01,   83.85it/s]


 45%|####4     | Repairing epochs : 88/197 [00:01&lt;00:01,   81.74it/s]


 46%|####6     | Repairing epochs : 91/197 [00:01&lt;00:01,   85.07it/s]


 47%|####7     | Repairing epochs : 93/197 [00:01&lt;00:01,   85.14it/s]


 48%|####8     | Repairing epochs : 95/197 [00:01&lt;00:01,   85.55it/s]


 49%|####9     | Repairing epochs : 97/197 [00:01&lt;00:01,   85.86it/s]


 50%|#####     | Repairing epochs : 99/197 [00:01&lt;00:01,   86.17it/s]


 51%|#####1    | Repairing epochs : 101/197 [00:01&lt;00:01,   86.22it/s]


 53%|#####2    | Repairing epochs : 104/197 [00:01&lt;00:01,   87.64it/s]


 54%|#####3    | Repairing epochs : 106/197 [00:01&lt;00:01,   87.40it/s]


 55%|#####4    | Repairing epochs : 108/197 [00:01&lt;00:01,   88.82it/s]


 55%|#####5    | Repairing epochs : 109/197 [00:01&lt;00:01,   87.49it/s]


 56%|#####6    | Repairing epochs : 111/197 [00:01&lt;00:00,   87.35it/s]


 57%|#####7    | Repairing epochs : 113/197 [00:01&lt;00:01,   84.00it/s]


 58%|#####8    | Repairing epochs : 115/197 [00:01&lt;00:00,   83.88it/s]


 59%|#####9    | Repairing epochs : 117/197 [00:01&lt;00:00,   85.35it/s]


 60%|######    | Repairing epochs : 119/197 [00:01&lt;00:00,   85.46it/s]


 61%|######1   | Repairing epochs : 121/197 [00:01&lt;00:00,   85.64it/s]


 62%|######2   | Repairing epochs : 123/197 [00:01&lt;00:00,   83.36it/s]


 63%|######2   | Repairing epochs : 124/197 [00:01&lt;00:00,   81.29it/s]


 64%|######4   | Repairing epochs : 127/197 [00:01&lt;00:00,   84.39it/s]


 65%|######5   | Repairing epochs : 129/197 [00:01&lt;00:00,   84.62it/s]


 66%|######6   | Repairing epochs : 131/197 [00:01&lt;00:00,   85.01it/s]


 68%|######7   | Repairing epochs : 133/197 [00:01&lt;00:00,   85.29it/s]


 69%|######8   | Repairing epochs : 135/197 [00:01&lt;00:00,   85.49it/s]


 70%|######9   | Repairing epochs : 137/197 [00:01&lt;00:00,   85.68it/s]


 71%|#######   | Repairing epochs : 139/197 [00:01&lt;00:00,   85.75it/s]


 71%|#######1  | Repairing epochs : 140/197 [00:01&lt;00:00,   84.69it/s]


 72%|#######2  | Repairing epochs : 142/197 [00:01&lt;00:00,   82.99it/s]


 73%|#######2  | Repairing epochs : 143/197 [00:01&lt;00:00,   81.94it/s]


 74%|#######3  | Repairing epochs : 145/197 [00:01&lt;00:00,   82.37it/s]


 75%|#######5  | Repairing epochs : 148/197 [00:01&lt;00:00,   84.19it/s]


 76%|#######5  | Repairing epochs : 149/197 [00:01&lt;00:00,   83.04it/s]


 77%|#######6  | Repairing epochs : 151/197 [00:01&lt;00:00,   82.45it/s]


 77%|#######7  | Repairing epochs : 152/197 [00:01&lt;00:00,   80.14it/s]


 78%|#######8  | Repairing epochs : 154/197 [00:01&lt;00:00,   78.92it/s]


 80%|#######9  | Repairing epochs : 157/197 [00:01&lt;00:00,   80.88it/s]


 81%|########  | Repairing epochs : 159/197 [00:01&lt;00:00,   81.25it/s]


 82%|########1 | Repairing epochs : 161/197 [00:01&lt;00:00,   81.08it/s]


 84%|########3 | Repairing epochs : 165/197 [00:01&lt;00:00,   85.43it/s]


 85%|########4 | Repairing epochs : 167/197 [00:01&lt;00:00,   85.55it/s]


 86%|########5 | Repairing epochs : 169/197 [00:01&lt;00:00,   85.77it/s]


 87%|########6 | Repairing epochs : 171/197 [00:02&lt;00:00,   85.72it/s]


 88%|########7 | Repairing epochs : 173/197 [00:02&lt;00:00,   83.20it/s]


 88%|########8 | Repairing epochs : 174/197 [00:02&lt;00:00,   81.35it/s]


 89%|########8 | Repairing epochs : 175/197 [00:02&lt;00:00,   79.53it/s]


 90%|########9 | Repairing epochs : 177/197 [00:02&lt;00:00,   79.80it/s]


 91%|######### | Repairing epochs : 179/197 [00:02&lt;00:00,   80.03it/s]


 92%|#########1| Repairing epochs : 181/197 [00:02&lt;00:00,   80.51it/s]


 93%|#########3| Repairing epochs : 184/197 [00:02&lt;00:00,   81.51it/s]


 94%|#########3| Repairing epochs : 185/197 [00:02&lt;00:00,   80.87it/s]


 94%|#########4| Repairing epochs : 186/197 [00:02&lt;00:00,   78.31it/s]


 95%|#########4| Repairing epochs : 187/197 [00:02&lt;00:00,   77.66it/s]


 95%|#########5| Repairing epochs : 188/197 [00:02&lt;00:00,   75.95it/s]


 96%|#########6| Repairing epochs : 190/197 [00:02&lt;00:00,   77.02it/s]


 97%|#########7| Repairing epochs : 192/197 [00:02&lt;00:00,   74.45it/s]


 98%|#########7| Repairing epochs : 193/197 [00:02&lt;00:00,   73.57it/s]


 99%|#########8| Repairing epochs : 195/197 [00:02&lt;00:00,   74.19it/s]


100%|##########| Repairing epochs : 197/197 [00:02&lt;00:00,   74.89it/s]
100%|##########| Repairing epochs : 197/197 [00:02&lt;00:00,   81.50it/s]
No bad epochs were found for your data. Returning a copy of the data you wanted to clean. Interpolation may have been done.
</pre></div>
</div>
<p>We can visualize the cross validation curve over two variables</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  <span class="c1"># noqa</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>  <span class="c1"># noqa</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">patches</span>  <span class="c1"># noqa</span>
<span class="kn">from</span> <span class="nn">autoreject</span> <span class="kn">import</span> <span class="n">set_matplotlib_defaults</span>  <span class="c1"># noqa</span>

<span class="n">set_matplotlib_defaults</span><span class="p">(</span><a href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot" class="sphx-glr-backref-module-matplotlib sphx-glr-backref-type-py-module"><span class="n">plt</span></a><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;seaborn-white&#39;</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">loss</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ar</span><span class="o">.</span><span class="n">loss_</span></a><span class="p">[</span><span class="s1">&#39;eeg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># losses are stored by channel type.</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.matshow.html#matplotlib.pyplot.matshow" title="matplotlib.pyplot.matshow" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">matshow</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">loss</span><span class="o">.</span><span class="n">T</span></a> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.get_cmap.html#matplotlib.pyplot.get_cmap" title="matplotlib.pyplot.get_cmap" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span></a><span class="p">(</span><span class="s1">&#39;viridis&#39;</span><span class="p">))</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xticks.html#matplotlib.pyplot.xticks" title="matplotlib.pyplot.xticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xticks</span></a><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ar</span><span class="o">.</span><span class="n">consensus</span></a><span class="p">)),</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ar</span><span class="o">.</span><span class="n">consensus</span></a><span class="p">])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ar</span><span class="o">.</span><span class="n">n_interpolate</span></a><span class="p">)),</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ar</span><span class="o">.</span><span class="n">n_interpolate</span></a><span class="p">)</span>

<span class="c1"># Draw rectangle at location of best parameters</span>
<a href="https://matplotlib.org/stable/api/axes_api.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.gca.html#matplotlib.pyplot.gca" title="matplotlib.pyplot.gca" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">gca</span></a><span class="p">()</span>
<a href="https://numpy.org/devdocs/reference/arrays.scalars.html#numpy.int64" title="numpy.int64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">idx</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/arrays.scalars.html#numpy.int64" title="numpy.int64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">jdx</span></a> <span class="o">=</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.unravel_index.html#numpy.unravel_index" title="numpy.unravel_index" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">loss</span></a><span class="o">.</span><span class="n">argmin</span><span class="p">(),</span> <a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">loss</span><span class="o">.</span><span class="n">shape</span></a><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.patches.Rectangle.html#matplotlib.patches.Rectangle" title="matplotlib.patches.Rectangle" class="sphx-glr-backref-module-matplotlib-patches sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rect</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.patches.Rectangle.html#matplotlib.patches.Rectangle" title="matplotlib.patches.Rectangle" class="sphx-glr-backref-module-matplotlib-patches sphx-glr-backref-type-py-class"><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span></a><span class="p">((</span><a href="https://numpy.org/devdocs/reference/arrays.scalars.html#numpy.int64" title="numpy.int64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">idx</span></a> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/arrays.scalars.html#numpy.int64" title="numpy.int64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">jdx</span></a> <span class="o">-</span> <span class="mf">0.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                         <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.add_patch.html#matplotlib.axes.Axes.add_patch" title="matplotlib.axes.Axes.add_patch" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span></a><span class="p">(</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.patches.Rectangle.html#matplotlib.patches.Rectangle" title="matplotlib.patches.Rectangle" class="sphx-glr-backref-module-matplotlib-patches sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rect</span></a><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axis.XAxis.set_ticks_position.html#matplotlib.axis.XAxis.set_ticks_position" title="matplotlib.axis.XAxis.set_ticks_position" class="sphx-glr-backref-module-matplotlib-axis sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span></a><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Consensus percentage $\kappa$&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.ylabel.html#matplotlib.pyplot.ylabel" title="matplotlib.pyplot.ylabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Max sensors interpolated $\rho$&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;Mean cross validation error (x 1e6)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_visualize_bad_epochs_001.png" srcset="../_images/sphx_glr_plot_visualize_bad_epochs_001.png" alt="Mean cross validation error (x 1e6)" class = "sphx-glr-single-img"/><p>â¦ and visualize the bad epochs and sensors. Bad sensors which have been
interpolated are in blue. Bad sensors which are not interpolated are in red.
Bad trials are also in red.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scalings</span></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="mf">40e-6</span><span class="p">)</span>
<a href="../generated/autoreject.RejectLog.html#autoreject.RejectLog.plot_epochs" title="autoreject.RejectLog.plot_epochs" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-method"><span class="n">reject_log</span><span class="o">.</span><span class="n">plot_epochs</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray" title="mne.EpochsArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">this_epoch</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scalings</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scalings</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_visualize_bad_epochs_002.png" srcset="../_images/sphx_glr_plot_visualize_bad_epochs_002.png" alt="plot visualize bad epochs" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;MNEBrowseFigure size 800x800 with 4 Axes&gt;
</pre></div>
</div>
<p>â¦ and the epochs after cleaning with autoreject</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray.plot" title="mne.EpochsArray.plot" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">epochs_ar</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scalings</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scalings</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_visualize_bad_epochs_003.png" srcset="../_images/sphx_glr_plot_visualize_bad_epochs_003.png" alt="plot visualize bad epochs" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;MNEBrowseFigure size 800x800 with 4 Axes&gt;
</pre></div>
</div>
<p>The epochs dropped by autoreject are also stored in epochs.drop_log</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray.plot_drop_log" title="mne.EpochsArray.plot_drop_log" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">epochs_ar</span><span class="o">.</span><span class="n">plot_drop_log</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_visualize_bad_epochs_004.png" srcset="../_images/sphx_glr_plot_visualize_bad_epochs_004.png" alt="0 of 197 epochs removed (0.0%)" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 640x480 with 1 Axes&gt;
</pre></div>
</div>
<p>Finally, the evoked before and after autoreject, for sanity check. We use
the <code class="docutils literal notranslate"><span class="pre">spatial_colors</span></code> argument from MNE as it allows us to see that
the eyeblinks have not yet been cleaned but the bad channels have been
repaired.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ylim</span></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray.average" title="mne.EpochsArray.average" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">epochs</span><span class="o">.</span><span class="n">average</span></a><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ylim</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ylim</span></a><span class="p">,</span> <span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray.average" title="mne.EpochsArray.average" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">epochs_ar</span><span class="o">.</span><span class="n">average</span></a><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ylim</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ylim</span></a><span class="p">,</span> <span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_plot_visualize_bad_epochs_005.png" srcset="../_images/sphx_glr_plot_visualize_bad_epochs_005.png" alt="EEG (70 channels)" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_visualize_bad_epochs_006.png" srcset="../_images/sphx_glr_plot_visualize_bad_epochs_006.png" alt="EEG (70 channels)" class = "sphx-glr-multi-img"/></li>
</ul>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 640x300 with 2 Axes&gt;
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  46.018 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-visualize-bad-epochs-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/343ec55e666b7130c35f6a4de928c39a/plot_visualize_bad_epochs.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_visualize_bad_epochs.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/9d3e69826a86abb695c16aa2b83fb4a2/plot_visualize_bad_epochs.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_visualize_bad_epochs.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


</div>

<!-- Github "fork me" ribbon -->
<a href="https://github.com/autoreject/autoreject"><img style="position: absolute; top: 50px; right: 0; border: 0;" 
src="https://camo.githubusercontent.com/652c5b9acfaddf3a9c326fa6bde407b87f7be0f4/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6f72616e67655f6666373630302e706e67"
alt="Fork me on GitHub"
data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png"></a>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2016-2023, autoreject developers. Last updated on 2023-01-12.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 6.1.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>