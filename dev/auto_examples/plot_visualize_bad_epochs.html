
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Visualize bad sensors per trial &#8212; autoreject 0.5.dev0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          autoreject</a>
        <span class="navbar-text navbar-version pull-left"><b>0.5.dev0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="index.html">Examples</a></li>
                <li><a href="../explanation.html">Explanation</a></li>
                <li><a href="../faq.html">FAQ</a></li>
                <li><a href="../api.html">API</a></li>
                <li><a href="../whats_new.html">What's new</a></li>
                <li><a href="https://github.com/autoreject/autoreject">GitHub</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
<div class="navbar-form navbar-right navbar-btn dropdown btn-group-sm" style="margin-left: 20px; margin-top: 5px; margin-bottom: 5px">
  <button type="button" class="btn btn-primary navbar-btn dropdown-toggle" id="dropdownMenu1" data-toggle="dropdown">
    v0.5.dev0
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
    <li><a href="https://autoreject.github.io/dev/index.html">Development</a></li>
    <li><a href="https://autoreject.github.io/stable/index.html">Stable</a></li>
    <li><a href="https://autoreject.github.io/v0.4/index.html">v0.4</a></li>
    <li><a href="https://autoreject.github.io/v0.3/index.html">v0.3</a></li>
    <li><a href="https://autoreject.github.io/v0.2/index.html">v0.2</a></li>
  </ul>
</div>


            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          

        </div>
    </div>
  </div>

<div class="container content-container">
  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-plot-visualize-bad-epochs-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="visualize-bad-sensors-per-trial">
<span id="sphx-glr-auto-examples-plot-visualize-bad-epochs-py"></span><h1>Visualize bad sensors per trial<a class="headerlink" href="#visualize-bad-sensors-per-trial" title="Permalink to this heading">Â¶</a></h1>
<p>This example demonstrates how to use <a class="reference internal" href="../api.html#module-autoreject" title="autoreject"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autoreject</span></code></a> to
visualize the bad sensors in each trial</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Author: Mainak Jas &lt;mainak.jas@telecom-paristech.fr&gt;</span>
<span class="c1">#         Denis A. Engemann &lt;denis.engemann@gmail.com&gt;</span>
<span class="c1"># License: BSD-3-Clause</span>

<span class="c1"># sphinx_gallery_thumbnail_number = 2</span>
</pre></div>
</div>
<p>First, we download the data from OpenfMRI which is hosted on OpenNeuro.
We will do this using <code class="docutils literal notranslate"><span class="pre">openneuro-py</span></code> which can be installed using pip
(<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">openneuro-py</span></code>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">openneuro</span>
<span class="kn">import</span> <span class="nn">autoreject</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a> <span class="o">=</span> <span class="s1">&#39;ds000117&#39;</span>  <span class="c1"># The id code on OpenNeuro for this example dataset</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject_id</span></a> <span class="o">=</span> <span class="mi">16</span>  <span class="c1"># OpenfMRI format of subject numbering</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_dir</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3/library/os.path.html#os.path.dirname" title="os.path.dirname" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span></a><span class="p">(</span><span class="n">autoreject</span><span class="o">.</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;examples&#39;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.isdir" title="os.path.isdir" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_dir</span></a><span class="p">):</span>
    <a href="https://docs.python.org/3/library/os.html#os.makedirs" title="os.makedirs" class="sphx-glr-backref-module-os sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_dir</span></a><span class="p">)</span>

<span class="n">openneuro</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_dir</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_dir</span></a><span class="p">,</span>
                   <span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;sub-</span><span class="si">{</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject_id</span></a><span class="si">}</span><span class="s1">/ses-meg/&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Hello! This is openneuro-py 2022.2.0. Great to see you!

      Please report problems and bugs at
      https://github.com/hoechenberger/openneuro-py/issues

Preparing to download ds000117 ...

Traversing directories for ds000117: 0 entities [00:00, ? entities/s]
Traversing directories for ds000117: 23 entities [00:00, 124.61 entities/s]
Traversing directories for ds000117: 36 entities [00:00, 49.29 entities/s]
Traversing directories for ds000117: 43 entities [00:01, 31.00 entities/s]
Traversing directories for ds000117: 55 entities [00:01, 39.40 entities/s]
Traversing directories for ds000117: 61 entities [00:01, 30.54 entities/s]
Traversing directories for ds000117: 73 entities [00:01, 38.68 entities/s]
Traversing directories for ds000117: 79 entities [00:02, 29.70 entities/s]
Traversing directories for ds000117: 91 entities [00:02, 37.61 entities/s]
Traversing directories for ds000117: 97 entities [00:02, 27.18 entities/s]
Traversing directories for ds000117: 107 entities [00:02, 35.39 entities/s]
Traversing directories for ds000117: 113 entities [00:03, 37.46 entities/s]
Traversing directories for ds000117: 119 entities [00:03, 26.29 entities/s]
Traversing directories for ds000117: 127 entities [00:03, 30.09 entities/s]
Traversing directories for ds000117: 133 entities [00:04, 24.56 entities/s]
Traversing directories for ds000117: 145 entities [00:04, 33.59 entities/s]
Traversing directories for ds000117: 151 entities [00:04, 26.29 entities/s]
Traversing directories for ds000117: 163 entities [00:04, 34.76 entities/s]
Traversing directories for ds000117: 169 entities [00:05, 26.63 entities/s]
Traversing directories for ds000117: 179 entities [00:05, 34.72 entities/s]
Traversing directories for ds000117: 184 entities [00:05, 35.82 entities/s]
Traversing directories for ds000117: 189 entities [00:05, 24.82 entities/s]
Traversing directories for ds000117: 197 entities [00:06, 31.50 entities/s]
Traversing directories for ds000117: 202 entities [00:06, 34.26 entities/s]
Traversing directories for ds000117: 207 entities [00:06, 24.37 entities/s]
Traversing directories for ds000117: 217 entities [00:06, 30.75 entities/s]
Traversing directories for ds000117: 223 entities [00:07, 24.69 entities/s]
Traversing directories for ds000117: 235 entities [00:07, 32.81 entities/s]
Traversing directories for ds000117: 241 entities [00:07, 26.44 entities/s]
Traversing directories for ds000117: 253 entities [00:07, 33.20 entities/s]
Traversing directories for ds000117: 259 entities [00:08, 27.49 entities/s]
Traversing directories for ds000117: 271 entities [00:08, 36.16 entities/s]
Traversing directories for ds000117: 277 entities [00:08, 29.07 entities/s]
Traversing directories for ds000117: 289 entities [00:08, 36.48 entities/s]
Traversing directories for ds000117: 295 entities [00:09, 29.12 entities/s]
Traversing directories for ds000117: 307 entities [00:09, 36.67 entities/s]
Traversing directories for ds000117: 315 entities [00:09, 33.82 entities/s]
Traversing directories for ds000117: 319 entities [00:09, 34.17 entities/s]
Traversing directories for ds000117: 329 entities [00:10, 37.64 entities/s]
Traversing directories for ds000117: 334 entities [00:10, 38.67 entities/s]
Traversing directories for ds000117: 343 entities [00:10, 39.66 entities/s]
Traversing directories for ds000117: 348 entities [00:10, 40.71 entities/s]
Traversing directories for ds000117: 357 entities [00:10, 43.88 entities/s]
Traversing directories for ds000117: 371 entities [00:10, 47.14 entities/s]
Traversing directories for ds000117: 385 entities [00:11, 49.23 entities/s]
Traversing directories for ds000117: 390 entities [00:11, 48.12 entities/s]
Traversing directories for ds000117: 399 entities [00:11, 45.40 entities/s]
Traversing directories for ds000117: 404 entities [00:11, 45.33 entities/s]
Traversing directories for ds000117: 413 entities [00:11, 44.02 entities/s]
Traversing directories for ds000117: 418 entities [00:12, 44.60 entities/s]
Traversing directories for ds000117: 427 entities [00:12, 39.58 entities/s]
Traversing directories for ds000117: 441 entities [00:12, 40.46 entities/s]
Traversing directories for ds000117: 446 entities [00:12, 36.33 entities/s]
Traversing directories for ds000117: 455 entities [00:13, 37.02 entities/s]
Traversing directories for ds000117: 459 entities [00:13, 37.28 entities/s]
Traversing directories for ds000117: 469 entities [00:13, 40.69 entities/s]
Traversing directories for ds000117: 474 entities [00:13, 42.02 entities/s]
Traversing directories for ds000117: 483 entities [00:13, 41.85 entities/s]
Traversing directories for ds000117: 488 entities [00:13, 43.13 entities/s]
Traversing directories for ds000117: 497 entities [00:14, 44.14 entities/s]
Traversing directories for ds000117: 502 entities [00:14, 44.46 entities/s]
Traversing directories for ds000117: 511 entities [00:14, 43.93 entities/s]
Traversing directories for ds000117: 516 entities [00:14, 43.75 entities/s]
Traversing directories for ds000117: 525 entities [00:14, 41.95 entities/s]
Traversing directories for ds000117: 530 entities [00:14, 42.86 entities/s]
Traversing directories for ds000117: 539 entities [00:15, 35.13 entities/s]
Traversing directories for ds000117: 543 entities [00:15, 30.67 entities/s]
Traversing directories for ds000117: 547 entities [00:15, 26.79 entities/s]
Traversing directories for ds000117: 550 entities [00:15, 22.98 entities/s]
Traversing directories for ds000117: 553 entities [00:15, 21.13 entities/s]
Traversing directories for ds000117: 556 entities [00:16, 19.62 entities/s]
Traversing directories for ds000117: 559 entities [00:16, 18.56 entities/s]
Traversing directories for ds000117: 561 entities [00:16, 16.57 entities/s]
Traversing directories for ds000117: 563 entities [00:16, 12.06 entities/s]
Traversing directories for ds000117: 1027 entities [00:17, 591.76 entities/s]
Traversing directories for ds000117: 1493 entities [00:17, 1052.44 entities/s]
Traversing directories for ds000117: 1603 entities [00:18, 313.69 entities/s]
Traversing directories for ds000117: 1682 entities [00:20, 186.50 entities/s]
Traversing directories for ds000117: 1739 entities [00:21, 151.88 entities/s]
Traversing directories for ds000117: 1781 entities [00:21, 139.76 entities/s]
Traversing directories for ds000117: 1813 entities [00:22, 117.82 entities/s]
Traversing directories for ds000117: 1837 entities [00:22, 114.17 entities/s]
Traversing directories for ds000117: 1857 entities [00:22, 99.93 entities/s]
Traversing directories for ds000117: 1873 entities [00:23, 96.62 entities/s]
Traversing directories for ds000117: 1887 entities [00:23, 100.57 entities/s]
Traversing directories for ds000117: 1909 entities [00:23, 94.16 entities/s]
Traversing directories for ds000117: 1921 entities [00:23, 88.80 entities/s]
Traversing directories for ds000117: 1932 entities [00:23, 82.74 entities/s]
Traversing directories for ds000117: 1947 entities [00:24, 82.98 entities/s]
Traversing directories for ds000117: 1965 entities [00:24, 86.71 entities/s]
Traversing directories for ds000117: 1975 entities [00:24, 77.74 entities/s]
Traversing directories for ds000117: 1983 entities [00:24, 65.43 entities/s]
Traversing directories for ds000117: 2003 entities [00:24, 78.34 entities/s]
Traversing directories for ds000117: 2025 entities [00:25, 76.59 entities/s]
Traversing directories for ds000117: 2033 entities [00:25, 68.65 entities/s]
Traversing directories for ds000117: 2043 entities [00:25, 65.06 entities/s]
Traversing directories for ds000117: 2059 entities [00:25, 80.46 entities/s]
Traversing directories for ds000117: 2081 entities [00:25, 82.25 entities/s]
Traversing directories for ds000117: 2090 entities [00:26, 69.26 entities/s]
Traversing directories for ds000117: 2099 entities [00:26, 61.50 entities/s]
Traversing directories for ds000117: 2115 entities [00:26, 76.83 entities/s]
Traversing directories for ds000117: 2124 entities [00:26, 77.93 entities/s]
Traversing directories for ds000117: 2137 entities [00:26, 76.90 entities/s]
Traversing directories for ds000117: 2146 entities [00:26, 68.10 entities/s]
Traversing directories for ds000117: 2155 entities [00:26, 61.64 entities/s]
Traversing directories for ds000117: 2175 entities [00:27, 74.39 entities/s]
Traversing directories for ds000117: 2197 entities [00:27, 73.93 entities/s]
Traversing directories for ds000117: 2205 entities [00:27, 65.44 entities/s]
Traversing directories for ds000117: 2215 entities [00:27, 59.61 entities/s]
Traversing directories for ds000117: 2235 entities [00:28, 71.72 entities/s]
Traversing directories for ds000117: 2243 entities [00:28, 72.27 entities/s]
Traversing directories for ds000117: 2257 entities [00:28, 74.77 entities/s]
Traversing directories for ds000117: 2265 entities [00:28, 64.63 entities/s]
Traversing directories for ds000117: 2275 entities [00:28, 60.76 entities/s]
Traversing directories for ds000117: 2295 entities [00:28, 74.96 entities/s]
Traversing directories for ds000117: 2317 entities [00:29, 75.95 entities/s]
Traversing directories for ds000117: 2325 entities [00:29, 67.86 entities/s]
Traversing directories for ds000117: 2335 entities [00:29, 64.93 entities/s]
Traversing directories for ds000117: 2355 entities [00:29, 77.55 entities/s]
Traversing directories for ds000117: 2377 entities [00:30, 79.05 entities/s]
Traversing directories for ds000117: 2385 entities [00:30, 70.41 entities/s]
Traversing directories for ds000117: 2395 entities [00:30, 66.23 entities/s]
Traversing directories for ds000117: 2415 entities [00:30, 78.79 entities/s]
Traversing directories for ds000117: 2435 entities [00:30, 88.91 entities/s]
Traversing directories for ds000117: 2444 entities [00:31, 38.29 entities/s]
Traversing directories for ds000117: 2450 entities [00:32, 76.34 entities/s]
Retrieving up to 22 files (5 concurrent downloads).

Skipping sub-16_ses-meg_scans.tsv: already downloaded.: 100%|##########| 475/475 [00:00&lt;?, ?B/s]


Skipping dataset_description.json: already downloaded.: 100%|##########| 1.07k/1.07k [00:00&lt;?, ?B/s]


Skipping participants.tsv: already downloaded.: 100%|##########| 333/333 [00:00&lt;?, ?B/s]


Skipping README: already downloaded.: 100%|##########| 5.92k/5.92k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_channels.tsv: already downloaded.: 100%|##########| 23.0k/23.0k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_events.tsv: already downloaded.: 100%|##########| 8.75k/8.75k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_headshape.pos: already downloaded.: 100%|##########| 4.22k/4.22k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_coordsystem.json: already downloaded.: 100%|##########| 1.81k/1.81k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_meg.json: already downloaded.: 100%|##########| 1.67k/1.67k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-02_events.tsv: already downloaded.: 100%|##########| 6.06k/6.06k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-01_events.tsv: already downloaded.: 100%|##########| 6.19k/6.19k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-03_events.tsv: already downloaded.: 100%|##########| 6.19k/6.19k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-04_events.tsv: already downloaded.: 100%|##########| 6.23k/6.23k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-05_events.tsv: already downloaded.: 100%|##########| 6.15k/6.15k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-06_events.tsv: already downloaded.: 100%|##########| 6.24k/6.24k [00:00&lt;?, ?B/s]


Skipping CHANGES: already downloaded.: 100%|##########| 1.79k/1.79k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-06_meg.fif: already downloaded.: 100%|##########| 822M/822M [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-05_meg.fif: already downloaded.: 100%|##########| 824M/824M [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-04_meg.fif: already downloaded.: 100%|##########| 830M/830M [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-03_meg.fif: already downloaded.: 100%|##########| 832M/832M [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-02_meg.fif: already downloaded.: 100%|##########| 835M/835M [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-01_meg.fif: already downloaded.: 100%|##########| 824M/824M [00:00&lt;?, ?B/s]

Finished downloading ds000117.

Please enjoy your brains.
</pre></div>
</div>
<p>We will create epochs with data starting 200 ms before trigger onset
and continuing up to 800 ms after that. The data contains visual stimuli for
famous faces, unfamiliar faces, as well as scrambled faces.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmax</span></a> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events_id</span></a> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;famous/first&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;famous/immediate&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;famous/long&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">}</span>
</pre></div>
</div>
<p>Let us now load all the epochs into memory and concatenate them</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mne</span>  <span class="c1"># noqa</span>

<a href="https://mne.tools/dev/generated/mne.BaseEpochs.html#mne.BaseEpochs" title="mne.BaseEpochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">run</span></a> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">):</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">run_fname</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_dir</span></a><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;sub-</span><span class="si">{</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject_id</span></a><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;ses-meg&#39;</span><span class="p">,</span> <span class="s1">&#39;meg&#39;</span><span class="p">,</span>
                             <span class="sa">f</span><span class="s1">&#39;sub-</span><span class="si">{</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject_id</span></a><span class="si">}</span><span class="s1">_ses-meg_task-facerecognition&#39;</span>
                             <span class="s1">&#39;_run-</span><span class="si">{:02d}</span><span class="s1">_meg.fif&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">run</span></a><span class="p">))</span>
    <a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.io.read_raw_fif.html#mne.io.read_raw_fif" title="mne.io.read_raw_fif" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_fif</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">run_fname</span></a><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw.pick_types" title="mne.io.Raw.pick_types" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">pick_types</span></a><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># less memory + computation</span>
    <a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw.filter" title="mne.io.Raw.filter" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">filter</span></a><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">,</span> <span class="n">l_trans_bandwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="s1">&#39;INFO&#39;</span><span class="p">)</span>

    <a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw.set_channel_types" title="mne.io.Raw.set_channel_types" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">set_channel_types</span></a><span class="p">({</span><span class="s1">&#39;EEG061&#39;</span><span class="p">:</span> <span class="s1">&#39;eog&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG062&#39;</span><span class="p">:</span> <span class="s1">&#39;eog&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;EEG063&#39;</span><span class="p">:</span> <span class="s1">&#39;ecg&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG064&#39;</span><span class="p">:</span> <span class="s1">&#39;misc&#39;</span><span class="p">})</span>
    <a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw.rename_channels" title="mne.io.Raw.rename_channels" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">rename_channels</span></a><span class="p">({</span><span class="s1">&#39;EEG061&#39;</span><span class="p">:</span> <span class="s1">&#39;EOG061&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG062&#39;</span><span class="p">:</span> <span class="s1">&#39;EOG062&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;EEG063&#39;</span><span class="p">:</span> <span class="s1">&#39;ECG063&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG064&#39;</span><span class="p">:</span> <span class="s1">&#39;MISC&#39;</span><span class="p">})</span>

    <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.find_events.html#mne.find_events" title="mne.find_events" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">find_events</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">,</span> <span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;STI101&#39;</span><span class="p">,</span>
                             <span class="n">consecutive</span><span class="o">=</span><span class="s1">&#39;increasing&#39;</span><span class="p">,</span>
                             <span class="n">min_duration</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Read epochs</span>
    <a href="https://mne.tools/dev/generated/mne.set_eeg_reference.html#mne.set_eeg_reference" title="mne.set_eeg_reference" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">set_eeg_reference</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">)</span>

    <a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epoch</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class"><span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events_id</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmax</span></a><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">baseline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">preload</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reject</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">decim</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <a href="https://mne.tools/dev/generated/mne.BaseEpochs.html#mne.BaseEpochs" title="mne.BaseEpochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span><span class="o">.</span><span class="n">append</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epoch</span></a><span class="p">)</span>

    <span class="c1"># Same `dev_head_t` for all runs so that we can concatenate them.</span>
    <a href="https://mne.tools/dev/generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epoch</span><span class="o">.</span><span class="n">info</span></a><span class="p">[</span><span class="s1">&#39;dev_head_t&#39;</span><span class="p">]</span> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.BaseEpochs.html#mne.BaseEpochs" title="mne.BaseEpochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;dev_head_t&#39;</span><span class="p">]</span>


<a href="https://mne.tools/dev/generated/mne.BaseEpochs.html#mne.BaseEpochs" title="mne.BaseEpochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.concatenate_epochs.html#mne.concatenate_epochs" title="mne.concatenate_epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">epochs</span><span class="o">.</span><span class="n">concatenate_epochs</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.BaseEpochs.html#mne.BaseEpochs" title="mne.BaseEpochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Opening raw data file /home/circleci/project/autoreject/../examples/ds000117/sub-16/ses-meg/meg/sub-16_ses-meg_task-facerecognition_run-03_meg.fif...
    Read a total of 8 projection items:
        mag_ssp_upright.fif : PCA-mags-v1 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v2 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v3 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v4 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v5 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v1 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v2 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v3 (1 x 306)  idle
    Range : 40700 ... 588499 =     37.000 ...   534.999 secs
Ready.
Reading 0 ... 547799  =      0.000 ...   497.999 secs...
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v3, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v4, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v5, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v3, active : False, n_channels : 306&gt;
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 0.75 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 7261 samples (6.601 sec)

296 events found
Event IDs: [   5    6    7   13   14   15   17   18   19  261  262  263  269  271
  273  274  275 4096 4101 4102 4103 4109 4110 4111 4113 4114 4115]
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom (&#39;EEG&#39;,) reference.
Not setting metadata
49 matching events found
No baseline correction applied
0 projection items activated
Opening raw data file /home/circleci/project/autoreject/../examples/ds000117/sub-16/ses-meg/meg/sub-16_ses-meg_task-facerecognition_run-04_meg.fif...
    Read a total of 8 projection items:
        mag_ssp_upright.fif : PCA-mags-v1 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v2 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v3 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v4 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v5 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v1 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v2 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v3 (1 x 306)  idle
    Range : 36300 ... 582999 =     33.000 ...   529.999 secs
Ready.
Reading 0 ... 546699  =      0.000 ...   496.999 secs...
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v3, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v4, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v5, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v3, active : False, n_channels : 306&gt;
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 0.75 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 7261 samples (6.601 sec)

296 events found
Event IDs: [   5    6    7   13   14   15   17   18   19  256  261  262  263  269
  271  273  274  275 4096 4101 4102 4103 4109 4110 4111 4113 4114 4115]
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom (&#39;EEG&#39;,) reference.
Not setting metadata
49 matching events found
No baseline correction applied
0 projection items activated
Opening raw data file /home/circleci/project/autoreject/../examples/ds000117/sub-16/ses-meg/meg/sub-16_ses-meg_task-facerecognition_run-05_meg.fif...
    Read a total of 8 projection items:
        mag_ssp_upright.fif : PCA-mags-v1 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v2 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v3 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v4 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v5 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v1 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v2 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v3 (1 x 306)  idle
    Range : 60500 ... 602799 =     55.000 ...   547.999 secs
Ready.
Reading 0 ... 542299  =      0.000 ...   492.999 secs...
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v3, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v4, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v5, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v3, active : False, n_channels : 306&gt;
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 0.75 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 7261 samples (6.601 sec)

292 events found
Event IDs: [   5    6    7   13   14   15   17   18   19  256  261  269  271  273
  274  275 4096 4101 4102 4103 4109 4110 4111 4113 4114 4115]
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom (&#39;EEG&#39;,) reference.
Not setting metadata
49 matching events found
No baseline correction applied
0 projection items activated
Opening raw data file /home/circleci/project/autoreject/../examples/ds000117/sub-16/ses-meg/meg/sub-16_ses-meg_task-facerecognition_run-06_meg.fif...
    Read a total of 8 projection items:
        mag_ssp_upright.fif : PCA-mags-v1 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v2 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v3 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v4 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v5 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v1 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v2 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v3 (1 x 306)  idle
    Range : 27500 ... 568699 =     25.000 ...   516.999 secs
Ready.
Reading 0 ... 541199  =      0.000 ...   491.999 secs...
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v3, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v4, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v5, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v3, active : False, n_channels : 306&gt;
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 0.75 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 7261 samples (6.601 sec)

295 events found
Event IDs: [   5    6    7   13   14   15   17   18   19  256  261  262  263  269
  270  271  273  274  275 4096 4101 4102 4103 4109 4110 4111 4113 4114
 4115]
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom (&#39;EEG&#39;,) reference.
Not setting metadata
50 matching events found
No baseline correction applied
0 projection items activated
Using data from preloaded Raw for 49 events and 1101 original time points (prior to decimation) ...
0 bad epochs dropped
Using data from preloaded Raw for 49 events and 1101 original time points (prior to decimation) ...
0 bad epochs dropped
Using data from preloaded Raw for 49 events and 1101 original time points (prior to decimation) ...
0 bad epochs dropped
Using data from preloaded Raw for 50 events and 1101 original time points (prior to decimation) ...
0 bad epochs dropped
Using data from preloaded Raw for 49 events and 1101 original time points (prior to decimation) ...
Using data from preloaded Raw for 49 events and 1101 original time points (prior to decimation) ...
Using data from preloaded Raw for 49 events and 1101 original time points (prior to decimation) ...
Using data from preloaded Raw for 50 events and 1101 original time points (prior to decimation) ...
Not setting metadata
197 matching events found
No baseline correction applied
</pre></div>
</div>
<p>Now, we apply autoreject</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">autoreject</span> <span class="kn">import</span> <a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject" title="autoreject.AutoReject" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class"><span class="n">AutoReject</span></a><span class="p">,</span> <span class="n">compute_thresholds</span>  <span class="c1"># noqa</span>

<a href="https://mne.tools/dev/generated/mne.BaseEpochs.html#mne.BaseEpochs" title="mne.BaseEpochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">this_epoch</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.BaseEpochs.html#mne.BaseEpochs" title="mne.BaseEpochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="s1">&#39;famous&#39;</span><span class="p">]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">exclude</span></a> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># XXX</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">picks</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.pick_types.html#mne.pick_types" title="mne.pick_types" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">eog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">exclude</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">exclude</span></a><span class="p">)</span>
</pre></div>
</div>
<p>Note that <a class="reference internal" href="../generated/autoreject.AutoReject.html#autoreject.AutoReject" title="autoreject.AutoReject"><code class="xref py py-class docutils literal notranslate"><span class="pre">autoreject.AutoReject</span></code></a> by design supports multiple
channels. If no picks are passed separate solutions will be computed for each
channel type and internally combines. This then readily supports cleaning
unseen epochs from the different channel types used during fit.
Here we only use a subset of channels to save time.</p>
<p>Also note that once the parameters are learned, any data can be repaired
that contains channels that were used during fit. This also means that time
may be saved by fitting <a class="reference internal" href="../generated/autoreject.AutoReject.html#autoreject.AutoReject" title="autoreject.AutoReject"><code class="xref py py-class docutils literal notranslate"><span class="pre">autoreject.AutoReject</span></code></a> on a
representative subsample of the data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject" title="autoreject.AutoReject" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ar</span></a> <span class="o">=</span> <a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject" title="autoreject.AutoReject" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class"><span class="n">AutoReject</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">picks</span></a><span class="o">=</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">picks</span></a><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<a href="https://mne.tools/dev/generated/mne.BaseEpochs.html#mne.BaseEpochs" title="mne.BaseEpochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_ar</span></a><span class="p">,</span> <a href="../generated/autoreject.RejectLog.html#autoreject.RejectLog" title="autoreject.RejectLog" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reject_log</span></a> <span class="o">=</span> <a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject.fit_transform" title="autoreject.AutoReject.fit_transform" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-method"><span class="n">ar</span><span class="o">.</span><span class="n">fit_transform</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.BaseEpochs.html#mne.BaseEpochs" title="mne.BaseEpochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">this_epoch</span></a><span class="p">,</span> <span class="n">return_log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Running autoreject on ch_type=eeg

  0%|          | Creating augmented epochs : 0/70 [00:00&lt;?,       ?it/s]
  1%|1         | Creating augmented epochs : 1/70 [00:00&lt;00:01,   55.79it/s]
  3%|2         | Creating augmented epochs : 2/70 [00:00&lt;00:01,   55.28it/s]
  4%|4         | Creating augmented epochs : 3/70 [00:00&lt;00:01,   55.31it/s]
  6%|5         | Creating augmented epochs : 4/70 [00:00&lt;00:01,   55.19it/s]
  7%|7         | Creating augmented epochs : 5/70 [00:00&lt;00:01,   54.76it/s]
  9%|8         | Creating augmented epochs : 6/70 [00:00&lt;00:01,   54.80it/s]
 10%|#         | Creating augmented epochs : 7/70 [00:00&lt;00:01,   54.88it/s]
 11%|#1        | Creating augmented epochs : 8/70 [00:00&lt;00:01,   55.07it/s]
 13%|#2        | Creating augmented epochs : 9/70 [00:00&lt;00:01,   54.95it/s]
 14%|#4        | Creating augmented epochs : 10/70 [00:00&lt;00:01,   54.94it/s]
 16%|#5        | Creating augmented epochs : 11/70 [00:00&lt;00:01,   54.63it/s]
 17%|#7        | Creating augmented epochs : 12/70 [00:00&lt;00:01,   54.49it/s]
 19%|#8        | Creating augmented epochs : 13/70 [00:00&lt;00:01,   54.52it/s]
 20%|##        | Creating augmented epochs : 14/70 [00:00&lt;00:01,   54.47it/s]
 21%|##1       | Creating augmented epochs : 15/70 [00:00&lt;00:01,   54.56it/s]
 23%|##2       | Creating augmented epochs : 16/70 [00:00&lt;00:00,   54.66it/s]
 24%|##4       | Creating augmented epochs : 17/70 [00:00&lt;00:01,   52.43it/s]
 26%|##5       | Creating augmented epochs : 18/70 [00:00&lt;00:01,   49.26it/s]
 27%|##7       | Creating augmented epochs : 19/70 [00:00&lt;00:01,   46.49it/s]
 29%|##8       | Creating augmented epochs : 20/70 [00:00&lt;00:01,   44.33it/s]
 30%|###       | Creating augmented epochs : 21/70 [00:00&lt;00:01,   42.39it/s]
 31%|###1      | Creating augmented epochs : 22/70 [00:00&lt;00:01,   41.01it/s]
 33%|###2      | Creating augmented epochs : 23/70 [00:00&lt;00:01,   39.73it/s]
 34%|###4      | Creating augmented epochs : 24/70 [00:00&lt;00:01,   38.76it/s]
 36%|###5      | Creating augmented epochs : 25/70 [00:00&lt;00:01,   37.79it/s]
 37%|###7      | Creating augmented epochs : 26/70 [00:00&lt;00:01,   37.09it/s]
 39%|###8      | Creating augmented epochs : 27/70 [00:00&lt;00:01,   37.36it/s]
 40%|####      | Creating augmented epochs : 28/70 [00:00&lt;00:01,   38.13it/s]
 41%|####1     | Creating augmented epochs : 29/70 [00:00&lt;00:01,   38.86it/s]
 43%|####2     | Creating augmented epochs : 30/70 [00:00&lt;00:01,   39.64it/s]
 44%|####4     | Creating augmented epochs : 31/70 [00:00&lt;00:00,   40.40it/s]
 46%|####5     | Creating augmented epochs : 32/70 [00:00&lt;00:00,   41.05it/s]
 47%|####7     | Creating augmented epochs : 33/70 [00:00&lt;00:00,   41.72it/s]
 49%|####8     | Creating augmented epochs : 34/70 [00:00&lt;00:00,   42.32it/s]
 50%|#####     | Creating augmented epochs : 35/70 [00:00&lt;00:00,   41.13it/s]
 51%|#####1    | Creating augmented epochs : 36/70 [00:00&lt;00:00,   41.75it/s]
 53%|#####2    | Creating augmented epochs : 37/70 [00:00&lt;00:00,   42.38it/s]
 54%|#####4    | Creating augmented epochs : 38/70 [00:00&lt;00:00,   42.96it/s]
 56%|#####5    | Creating augmented epochs : 39/70 [00:00&lt;00:00,   43.43it/s]
 57%|#####7    | Creating augmented epochs : 40/70 [00:00&lt;00:00,   43.91it/s]
 59%|#####8    | Creating augmented epochs : 41/70 [00:00&lt;00:00,   44.38it/s]
 60%|######    | Creating augmented epochs : 42/70 [00:00&lt;00:00,   44.85it/s]
 61%|######1   | Creating augmented epochs : 43/70 [00:00&lt;00:00,   45.30it/s]
 63%|######2   | Creating augmented epochs : 44/70 [00:00&lt;00:00,   45.64it/s]
 64%|######4   | Creating augmented epochs : 45/70 [00:01&lt;00:00,   46.06it/s]
 66%|######5   | Creating augmented epochs : 46/70 [00:01&lt;00:00,   46.41it/s]
 67%|######7   | Creating augmented epochs : 47/70 [00:01&lt;00:00,   46.77it/s]
 69%|######8   | Creating augmented epochs : 48/70 [00:01&lt;00:00,   46.29it/s]
 70%|#######   | Creating augmented epochs : 49/70 [00:01&lt;00:00,   44.86it/s]
 71%|#######1  | Creating augmented epochs : 50/70 [00:01&lt;00:00,   43.66it/s]
 73%|#######2  | Creating augmented epochs : 51/70 [00:01&lt;00:00,   42.39it/s]
 74%|#######4  | Creating augmented epochs : 52/70 [00:01&lt;00:00,   41.31it/s]
 76%|#######5  | Creating augmented epochs : 53/70 [00:01&lt;00:00,   40.44it/s]
 77%|#######7  | Creating augmented epochs : 54/70 [00:01&lt;00:00,   39.61it/s]
 79%|#######8  | Creating augmented epochs : 55/70 [00:01&lt;00:00,   38.72it/s]
 80%|########  | Creating augmented epochs : 56/70 [00:01&lt;00:00,   38.01it/s]
 81%|########1 | Creating augmented epochs : 57/70 [00:01&lt;00:00,   37.25it/s]
 83%|########2 | Creating augmented epochs : 58/70 [00:01&lt;00:00,   36.66it/s]
 84%|########4 | Creating augmented epochs : 59/70 [00:01&lt;00:00,   36.14it/s]
 86%|########5 | Creating augmented epochs : 60/70 [00:01&lt;00:00,   35.60it/s]
 87%|########7 | Creating augmented epochs : 61/70 [00:01&lt;00:00,   35.22it/s]
 89%|########8 | Creating augmented epochs : 62/70 [00:01&lt;00:00,   34.80it/s]
 90%|######### | Creating augmented epochs : 63/70 [00:01&lt;00:00,   34.44it/s]
 91%|#########1| Creating augmented epochs : 64/70 [00:01&lt;00:00,   34.10it/s]
 93%|#########2| Creating augmented epochs : 65/70 [00:01&lt;00:00,   33.76it/s]
 94%|#########4| Creating augmented epochs : 66/70 [00:01&lt;00:00,   33.42it/s]
 96%|#########5| Creating augmented epochs : 67/70 [00:01&lt;00:00,   33.86it/s]
 97%|#########7| Creating augmented epochs : 68/70 [00:01&lt;00:00,   34.58it/s]
 99%|#########8| Creating augmented epochs : 69/70 [00:01&lt;00:00,   35.19it/s]
100%|##########| Creating augmented epochs : 70/70 [00:01&lt;00:00,   35.77it/s]
100%|##########| Creating augmented epochs : 70/70 [00:01&lt;00:00,   39.45it/s]

  0%|          | Computing thresholds ... : 0/70 [00:00&lt;?,       ?it/s]
  1%|1         | Computing thresholds ... : 1/70 [00:00&lt;00:42,    1.64it/s]
  3%|2         | Computing thresholds ... : 2/70 [00:01&lt;00:40,    1.68it/s]
  4%|4         | Computing thresholds ... : 3/70 [00:01&lt;00:39,    1.70it/s]
  6%|5         | Computing thresholds ... : 4/70 [00:02&lt;00:38,    1.69it/s]
  7%|7         | Computing thresholds ... : 5/70 [00:03&lt;00:39,    1.65it/s]
  9%|8         | Computing thresholds ... : 6/70 [00:03&lt;00:38,    1.67it/s]
 10%|#         | Computing thresholds ... : 7/70 [00:04&lt;00:37,    1.68it/s]
 11%|#1        | Computing thresholds ... : 8/70 [00:04&lt;00:37,    1.66it/s]
 13%|#2        | Computing thresholds ... : 9/70 [00:05&lt;00:36,    1.69it/s]
 14%|#4        | Computing thresholds ... : 10/70 [00:05&lt;00:35,    1.70it/s]
 16%|#5        | Computing thresholds ... : 11/70 [00:06&lt;00:34,    1.69it/s]
 17%|#7        | Computing thresholds ... : 12/70 [00:07&lt;00:34,    1.70it/s]
 19%|#8        | Computing thresholds ... : 13/70 [00:07&lt;00:33,    1.72it/s]
 20%|##        | Computing thresholds ... : 14/70 [00:08&lt;00:32,    1.71it/s]
 21%|##1       | Computing thresholds ... : 15/70 [00:08&lt;00:32,    1.71it/s]
 23%|##2       | Computing thresholds ... : 16/70 [00:09&lt;00:31,    1.72it/s]
 24%|##4       | Computing thresholds ... : 17/70 [00:09&lt;00:30,    1.72it/s]
 26%|##5       | Computing thresholds ... : 18/70 [00:10&lt;00:30,    1.73it/s]
 27%|##7       | Computing thresholds ... : 19/70 [00:11&lt;00:29,    1.72it/s]
 29%|##8       | Computing thresholds ... : 20/70 [00:11&lt;00:29,    1.71it/s]
 30%|###       | Computing thresholds ... : 21/70 [00:12&lt;00:28,    1.70it/s]
 31%|###1      | Computing thresholds ... : 22/70 [00:13&lt;00:28,    1.67it/s]
 33%|###2      | Computing thresholds ... : 23/70 [00:13&lt;00:28,    1.67it/s]
 34%|###4      | Computing thresholds ... : 24/70 [00:14&lt;00:27,    1.66it/s]
 36%|###5      | Computing thresholds ... : 25/70 [00:14&lt;00:27,    1.66it/s]
 37%|###7      | Computing thresholds ... : 26/70 [00:15&lt;00:26,    1.67it/s]
 39%|###8      | Computing thresholds ... : 27/70 [00:16&lt;00:25,    1.67it/s]
 40%|####      | Computing thresholds ... : 28/70 [00:16&lt;00:25,    1.68it/s]
 41%|####1     | Computing thresholds ... : 29/70 [00:17&lt;00:24,    1.68it/s]
 43%|####2     | Computing thresholds ... : 30/70 [00:17&lt;00:23,    1.69it/s]
 44%|####4     | Computing thresholds ... : 31/70 [00:18&lt;00:23,    1.69it/s]
 46%|####5     | Computing thresholds ... : 32/70 [00:18&lt;00:22,    1.69it/s]
 47%|####7     | Computing thresholds ... : 33/70 [00:19&lt;00:21,    1.69it/s]
 49%|####8     | Computing thresholds ... : 34/70 [00:20&lt;00:21,    1.69it/s]
 50%|#####     | Computing thresholds ... : 35/70 [00:20&lt;00:20,    1.69it/s]
 51%|#####1    | Computing thresholds ... : 36/70 [00:21&lt;00:20,    1.69it/s]
 53%|#####2    | Computing thresholds ... : 37/70 [00:21&lt;00:19,    1.69it/s]
 54%|#####4    | Computing thresholds ... : 38/70 [00:22&lt;00:18,    1.70it/s]
 56%|#####5    | Computing thresholds ... : 39/70 [00:23&lt;00:18,    1.70it/s]
 57%|#####7    | Computing thresholds ... : 40/70 [00:23&lt;00:17,    1.68it/s]
 59%|#####8    | Computing thresholds ... : 41/70 [00:24&lt;00:17,    1.67it/s]
 60%|######    | Computing thresholds ... : 42/70 [00:24&lt;00:16,    1.68it/s]
 61%|######1   | Computing thresholds ... : 43/70 [00:25&lt;00:16,    1.67it/s]
 63%|######2   | Computing thresholds ... : 44/70 [00:26&lt;00:15,    1.68it/s]
 64%|######4   | Computing thresholds ... : 45/70 [00:26&lt;00:14,    1.68it/s]
 66%|######5   | Computing thresholds ... : 46/70 [00:27&lt;00:14,    1.68it/s]
 67%|######7   | Computing thresholds ... : 47/70 [00:27&lt;00:13,    1.68it/s]
 69%|######8   | Computing thresholds ... : 48/70 [00:28&lt;00:13,    1.69it/s]
 70%|#######   | Computing thresholds ... : 49/70 [00:29&lt;00:12,    1.68it/s]
 71%|#######1  | Computing thresholds ... : 50/70 [00:29&lt;00:11,    1.68it/s]
 73%|#######2  | Computing thresholds ... : 51/70 [00:30&lt;00:11,    1.69it/s]
 74%|#######4  | Computing thresholds ... : 52/70 [00:30&lt;00:10,    1.68it/s]
 76%|#######5  | Computing thresholds ... : 53/70 [00:31&lt;00:10,    1.69it/s]
 77%|#######7  | Computing thresholds ... : 54/70 [00:31&lt;00:09,    1.69it/s]
 79%|#######8  | Computing thresholds ... : 55/70 [00:32&lt;00:08,    1.69it/s]
 80%|########  | Computing thresholds ... : 56/70 [00:33&lt;00:08,    1.69it/s]
 81%|########1 | Computing thresholds ... : 57/70 [00:33&lt;00:07,    1.69it/s]
 83%|########2 | Computing thresholds ... : 58/70 [00:34&lt;00:07,    1.67it/s]
 84%|########4 | Computing thresholds ... : 59/70 [00:35&lt;00:06,    1.67it/s]
 86%|########5 | Computing thresholds ... : 60/70 [00:35&lt;00:05,    1.67it/s]
 87%|########7 | Computing thresholds ... : 61/70 [00:36&lt;00:05,    1.65it/s]
 89%|########8 | Computing thresholds ... : 62/70 [00:37&lt;00:04,    1.65it/s]
 90%|######### | Computing thresholds ... : 63/70 [00:37&lt;00:04,    1.65it/s]
 91%|#########1| Computing thresholds ... : 64/70 [00:38&lt;00:03,    1.65it/s]
 93%|#########2| Computing thresholds ... : 65/70 [00:38&lt;00:03,    1.66it/s]
 94%|#########4| Computing thresholds ... : 66/70 [00:39&lt;00:02,    1.66it/s]
 96%|#########5| Computing thresholds ... : 67/70 [00:39&lt;00:01,    1.66it/s]
 97%|#########7| Computing thresholds ... : 68/70 [00:40&lt;00:01,    1.67it/s]
 99%|#########8| Computing thresholds ... : 69/70 [00:41&lt;00:00,    1.67it/s]
100%|##########| Computing thresholds ... : 70/70 [00:41&lt;00:00,    1.67it/s]
100%|##########| Computing thresholds ... : 70/70 [00:41&lt;00:00,    1.68it/s]



  0%|          | Repairing epochs : 0/197 [00:00&lt;?,       ?it/s]


  4%|3         | Repairing epochs : 7/197 [00:00&lt;00:00,  420.93it/s]


  7%|7         | Repairing epochs : 14/197 [00:00&lt;00:00,  425.37it/s]


 11%|#         | Repairing epochs : 21/197 [00:00&lt;00:00,  426.43it/s]


 14%|#4        | Repairing epochs : 28/197 [00:00&lt;00:00,  426.25it/s]


 18%|#7        | Repairing epochs : 35/197 [00:00&lt;00:00,  427.24it/s]


 21%|##1       | Repairing epochs : 42/197 [00:00&lt;00:00,  427.09it/s]


 25%|##4       | Repairing epochs : 49/197 [00:00&lt;00:00,  427.18it/s]


 28%|##8       | Repairing epochs : 56/197 [00:00&lt;00:00,  427.44it/s]


 32%|###1      | Repairing epochs : 63/197 [00:00&lt;00:00,  427.41it/s]


 36%|###5      | Repairing epochs : 70/197 [00:00&lt;00:00,  427.19it/s]


 39%|###9      | Repairing epochs : 77/197 [00:00&lt;00:00,  427.15it/s]


 43%|####2     | Repairing epochs : 84/197 [00:00&lt;00:00,  427.15it/s]


 46%|####6     | Repairing epochs : 91/197 [00:00&lt;00:00,  427.19it/s]


 50%|####9     | Repairing epochs : 98/197 [00:00&lt;00:00,  427.37it/s]


 53%|#####3    | Repairing epochs : 105/197 [00:00&lt;00:00,  427.22it/s]


 57%|#####6    | Repairing epochs : 112/197 [00:00&lt;00:00,  427.35it/s]


 60%|######    | Repairing epochs : 119/197 [00:00&lt;00:00,  427.20it/s]


 64%|######3   | Repairing epochs : 126/197 [00:00&lt;00:00,  427.15it/s]


 68%|######7   | Repairing epochs : 133/197 [00:00&lt;00:00,  427.05it/s]


 71%|#######1  | Repairing epochs : 140/197 [00:00&lt;00:00,  427.04it/s]


 75%|#######4  | Repairing epochs : 147/197 [00:00&lt;00:00,  427.18it/s]


 78%|#######8  | Repairing epochs : 154/197 [00:00&lt;00:00,  427.22it/s]


 82%|########1 | Repairing epochs : 161/197 [00:00&lt;00:00,  427.06it/s]


 85%|########5 | Repairing epochs : 168/197 [00:00&lt;00:00,  426.77it/s]


 89%|########8 | Repairing epochs : 175/197 [00:00&lt;00:00,  426.81it/s]


 92%|#########2| Repairing epochs : 182/197 [00:00&lt;00:00,  426.78it/s]


 96%|#########5| Repairing epochs : 189/197 [00:00&lt;00:00,  426.67it/s]


 99%|#########9| Repairing epochs : 196/197 [00:00&lt;00:00,  426.68it/s]
100%|##########| Repairing epochs : 197/197 [00:00&lt;00:00,  426.61it/s]


  0%|          | n_interp : 0/3 [00:00&lt;?,       ?it/s]


  0%|          | Repairing epochs : 0/197 [00:00&lt;?,       ?it/s]


  1%|1         | Repairing epochs : 2/197 [00:00&lt;00:01,  102.85it/s]


  2%|2         | Repairing epochs : 4/197 [00:00&lt;00:02,   90.39it/s]


  3%|3         | Repairing epochs : 6/197 [00:00&lt;00:02,   89.06it/s]


  4%|4         | Repairing epochs : 8/197 [00:00&lt;00:02,   88.62it/s]


  5%|5         | Repairing epochs : 10/197 [00:00&lt;00:02,   88.21it/s]


  6%|6         | Repairing epochs : 12/197 [00:00&lt;00:02,   87.94it/s]


  7%|7         | Repairing epochs : 14/197 [00:00&lt;00:02,   87.94it/s]


  8%|8         | Repairing epochs : 16/197 [00:00&lt;00:02,   87.84it/s]


  9%|9         | Repairing epochs : 18/197 [00:00&lt;00:02,   87.71it/s]


 10%|#         | Repairing epochs : 20/197 [00:00&lt;00:02,   87.54it/s]


 11%|#1        | Repairing epochs : 22/197 [00:00&lt;00:02,   87.19it/s]


 12%|#2        | Repairing epochs : 24/197 [00:00&lt;00:02,   82.51it/s]


 13%|#2        | Repairing epochs : 25/197 [00:00&lt;00:02,   78.59it/s]


 13%|#3        | Repairing epochs : 26/197 [00:00&lt;00:02,   75.29it/s]


 14%|#3        | Repairing epochs : 27/197 [00:00&lt;00:02,   72.46it/s]


 14%|#4        | Repairing epochs : 28/197 [00:00&lt;00:02,   69.87it/s]


 15%|#4        | Repairing epochs : 29/197 [00:00&lt;00:02,   67.50it/s]


 15%|#5        | Repairing epochs : 30/197 [00:00&lt;00:02,   65.60it/s]


 16%|#5        | Repairing epochs : 31/197 [00:00&lt;00:02,   63.77it/s]


 16%|#6        | Repairing epochs : 32/197 [00:00&lt;00:02,   62.25it/s]


 17%|#6        | Repairing epochs : 33/197 [00:00&lt;00:02,   60.87it/s]


 17%|#7        | Repairing epochs : 34/197 [00:00&lt;00:02,   59.61it/s]


 18%|#7        | Repairing epochs : 35/197 [00:00&lt;00:02,   58.48it/s]


 18%|#8        | Repairing epochs : 36/197 [00:00&lt;00:02,   58.40it/s]


 19%|#9        | Repairing epochs : 38/197 [00:00&lt;00:02,   60.34it/s]


 20%|##        | Repairing epochs : 40/197 [00:00&lt;00:02,   62.12it/s]


 21%|##1       | Repairing epochs : 42/197 [00:00&lt;00:02,   63.73it/s]


 22%|##1       | Repairing epochs : 43/197 [00:00&lt;00:02,   63.18it/s]


 22%|##2       | Repairing epochs : 44/197 [00:00&lt;00:02,   61.67it/s]


 23%|##2       | Repairing epochs : 45/197 [00:00&lt;00:02,   60.58it/s]


 24%|##3       | Repairing epochs : 47/197 [00:00&lt;00:02,   60.88it/s]


 24%|##4       | Repairing epochs : 48/197 [00:00&lt;00:02,   59.80it/s]


 25%|##4       | Repairing epochs : 49/197 [00:00&lt;00:02,   58.76it/s]


 25%|##5       | Repairing epochs : 50/197 [00:00&lt;00:02,   57.53it/s]


 26%|##6       | Repairing epochs : 52/197 [00:00&lt;00:02,   58.02it/s]


 27%|##6       | Repairing epochs : 53/197 [00:00&lt;00:02,   57.17it/s]


 27%|##7       | Repairing epochs : 54/197 [00:00&lt;00:02,   56.04it/s]


 28%|##7       | Repairing epochs : 55/197 [00:00&lt;00:02,   55.32it/s]


 28%|##8       | Repairing epochs : 56/197 [00:00&lt;00:02,   54.64it/s]


 29%|##8       | Repairing epochs : 57/197 [00:00&lt;00:02,   53.98it/s]


 29%|##9       | Repairing epochs : 58/197 [00:00&lt;00:02,   53.16it/s]


 30%|##9       | Repairing epochs : 59/197 [00:00&lt;00:02,   52.62it/s]


 31%|###       | Repairing epochs : 61/197 [00:01&lt;00:02,   53.27it/s]


 32%|###1      | Repairing epochs : 63/197 [00:01&lt;00:02,   53.83it/s]


 32%|###2      | Repairing epochs : 64/197 [00:01&lt;00:02,   53.26it/s]


 33%|###2      | Repairing epochs : 65/197 [00:01&lt;00:02,   52.52it/s]


 34%|###3      | Repairing epochs : 66/197 [00:01&lt;00:02,   52.10it/s]


 34%|###4      | Repairing epochs : 67/197 [00:01&lt;00:02,   51.69it/s]


 35%|###4      | Repairing epochs : 68/197 [00:01&lt;00:02,   51.09it/s]


 35%|###5      | Repairing epochs : 69/197 [00:01&lt;00:02,   50.76it/s]


 37%|###6      | Repairing epochs : 72/197 [00:01&lt;00:02,   52.84it/s]


 37%|###7      | Repairing epochs : 73/197 [00:01&lt;00:02,   52.40it/s]


 38%|###7      | Repairing epochs : 74/197 [00:01&lt;00:02,   51.77it/s]


 38%|###8      | Repairing epochs : 75/197 [00:01&lt;00:02,   51.19it/s]


 39%|###8      | Repairing epochs : 76/197 [00:01&lt;00:02,   50.76it/s]


 39%|###9      | Repairing epochs : 77/197 [00:01&lt;00:02,   50.39it/s]


 40%|###9      | Repairing epochs : 78/197 [00:01&lt;00:02,   49.98it/s]


 41%|####      | Repairing epochs : 80/197 [00:01&lt;00:02,   51.72it/s]


 42%|####1     | Repairing epochs : 82/197 [00:01&lt;00:02,   53.41it/s]


 43%|####2     | Repairing epochs : 84/197 [00:01&lt;00:02,   54.93it/s]


 44%|####3     | Repairing epochs : 86/197 [00:01&lt;00:02,   54.76it/s]


 44%|####4     | Repairing epochs : 87/197 [00:01&lt;00:02,   54.21it/s]


 45%|####4     | Repairing epochs : 88/197 [00:01&lt;00:02,   53.56it/s]


 46%|####6     | Repairing epochs : 91/197 [00:01&lt;00:01,   55.30it/s]


 47%|####6     | Repairing epochs : 92/197 [00:01&lt;00:01,   54.74it/s]


 47%|####7     | Repairing epochs : 93/197 [00:01&lt;00:01,   54.51it/s]


 48%|####8     | Repairing epochs : 95/197 [00:01&lt;00:01,   55.99it/s]


 49%|####9     | Repairing epochs : 97/197 [00:01&lt;00:01,   57.34it/s]


 50%|#####     | Repairing epochs : 99/197 [00:01&lt;00:01,   58.70it/s]


 51%|#####     | Repairing epochs : 100/197 [00:01&lt;00:01,   58.36it/s]


 51%|#####1    | Repairing epochs : 101/197 [00:01&lt;00:01,   57.62it/s]


 52%|#####1    | Repairing epochs : 102/197 [00:01&lt;00:01,   56.83it/s]


 53%|#####2    | Repairing epochs : 104/197 [00:01&lt;00:01,   57.03it/s]


 53%|#####3    | Repairing epochs : 105/197 [00:01&lt;00:01,   56.25it/s]


 54%|#####3    | Repairing epochs : 106/197 [00:01&lt;00:01,   55.47it/s]


 55%|#####4    | Repairing epochs : 108/197 [00:01&lt;00:01,   57.11it/s]


 56%|#####5    | Repairing epochs : 110/197 [00:01&lt;00:01,   58.38it/s]


 57%|#####6    | Repairing epochs : 112/197 [00:01&lt;00:01,   59.51it/s]


 58%|#####7    | Repairing epochs : 114/197 [00:01&lt;00:01,   60.30it/s]


 58%|#####8    | Repairing epochs : 115/197 [00:01&lt;00:01,   59.30it/s]


 59%|#####8    | Repairing epochs : 116/197 [00:01&lt;00:01,   58.41it/s]


 60%|#####9    | Repairing epochs : 118/197 [00:02&lt;00:01,   58.53it/s]


 60%|######    | Repairing epochs : 119/197 [00:02&lt;00:01,   57.82it/s]


 61%|######    | Repairing epochs : 120/197 [00:02&lt;00:01,   57.03it/s]


 61%|######1   | Repairing epochs : 121/197 [00:02&lt;00:01,   56.21it/s]


 62%|######1   | Repairing epochs : 122/197 [00:02&lt;00:01,   55.44it/s]


 62%|######2   | Repairing epochs : 123/197 [00:02&lt;00:01,   54.80it/s]


 63%|######2   | Repairing epochs : 124/197 [00:02&lt;00:01,   54.15it/s]


 63%|######3   | Repairing epochs : 125/197 [00:02&lt;00:01,   53.47it/s]


 65%|######4   | Repairing epochs : 128/197 [00:02&lt;00:01,   55.19it/s]


 65%|######5   | Repairing epochs : 129/197 [00:02&lt;00:01,   54.58it/s]


 66%|######5   | Repairing epochs : 130/197 [00:02&lt;00:01,   54.07it/s]


 66%|######6   | Repairing epochs : 131/197 [00:02&lt;00:01,   53.56it/s]


 67%|######7   | Repairing epochs : 132/197 [00:02&lt;00:01,   53.11it/s]


 68%|######7   | Repairing epochs : 133/197 [00:02&lt;00:01,   52.63it/s]


 68%|######8   | Repairing epochs : 134/197 [00:02&lt;00:01,   52.22it/s]


 69%|######8   | Repairing epochs : 135/197 [00:02&lt;00:01,   51.83it/s]


 69%|######9   | Repairing epochs : 136/197 [00:02&lt;00:01,   51.44it/s]


 70%|######9   | Repairing epochs : 137/197 [00:02&lt;00:01,   50.98it/s]


 70%|#######   | Repairing epochs : 138/197 [00:02&lt;00:01,   50.61it/s]


 71%|#######   | Repairing epochs : 139/197 [00:02&lt;00:01,   50.24it/s]


 71%|#######1  | Repairing epochs : 140/197 [00:02&lt;00:01,   49.95it/s]


 72%|#######1  | Repairing epochs : 141/197 [00:02&lt;00:01,   49.59it/s]


 72%|#######2  | Repairing epochs : 142/197 [00:02&lt;00:01,   49.29it/s]


 73%|#######2  | Repairing epochs : 143/197 [00:02&lt;00:01,   49.08it/s]


 73%|#######3  | Repairing epochs : 144/197 [00:02&lt;00:01,   48.82it/s]


 74%|#######3  | Repairing epochs : 145/197 [00:02&lt;00:01,   48.58it/s]


 74%|#######4  | Repairing epochs : 146/197 [00:02&lt;00:01,   48.26it/s]


 75%|#######5  | Repairing epochs : 148/197 [00:02&lt;00:00,   49.12it/s]


 76%|#######6  | Repairing epochs : 150/197 [00:02&lt;00:00,   50.73it/s]


 77%|#######7  | Repairing epochs : 152/197 [00:02&lt;00:00,   53.15it/s]


 78%|#######8  | Repairing epochs : 154/197 [00:02&lt;00:00,   55.49it/s]


 79%|#######9  | Repairing epochs : 156/197 [00:02&lt;00:00,   57.72it/s]


 80%|#######9  | Repairing epochs : 157/197 [00:02&lt;00:00,   57.81it/s]


 80%|########  | Repairing epochs : 158/197 [00:02&lt;00:00,   56.87it/s]


 81%|########  | Repairing epochs : 159/197 [00:02&lt;00:00,   56.03it/s]


 81%|########1 | Repairing epochs : 160/197 [00:02&lt;00:00,   55.20it/s]


 82%|########1 | Repairing epochs : 161/197 [00:02&lt;00:00,   54.42it/s]


 83%|########3 | Repairing epochs : 164/197 [00:02&lt;00:00,   57.90it/s]


 84%|########3 | Repairing epochs : 165/197 [00:02&lt;00:00,   57.03it/s]


 85%|########4 | Repairing epochs : 167/197 [00:02&lt;00:00,   58.41it/s]


 86%|########5 | Repairing epochs : 169/197 [00:02&lt;00:00,   59.75it/s]


 87%|########6 | Repairing epochs : 171/197 [00:02&lt;00:00,   60.91it/s]


 87%|########7 | Repairing epochs : 172/197 [00:03&lt;00:00,   60.60it/s]


 88%|########7 | Repairing epochs : 173/197 [00:03&lt;00:00,   59.60it/s]


 88%|########8 | Repairing epochs : 174/197 [00:03&lt;00:00,   58.63it/s]


 89%|########8 | Repairing epochs : 175/197 [00:03&lt;00:00,   57.66it/s]


 89%|########9 | Repairing epochs : 176/197 [00:03&lt;00:00,   56.77it/s]


 90%|########9 | Repairing epochs : 177/197 [00:03&lt;00:00,   56.09it/s]


 90%|######### | Repairing epochs : 178/197 [00:03&lt;00:00,   55.31it/s]


 91%|######### | Repairing epochs : 179/197 [00:03&lt;00:00,   54.57it/s]


 91%|#########1| Repairing epochs : 180/197 [00:03&lt;00:00,   53.97it/s]


 92%|#########1| Repairing epochs : 181/197 [00:03&lt;00:00,   53.46it/s]


 93%|#########2| Repairing epochs : 183/197 [00:03&lt;00:00,   54.13it/s]


 93%|#########3| Repairing epochs : 184/197 [00:03&lt;00:00,   53.44it/s]


 94%|#########3| Repairing epochs : 185/197 [00:03&lt;00:00,   52.82it/s]


 94%|#########4| Repairing epochs : 186/197 [00:03&lt;00:00,   52.20it/s]


 95%|#########4| Repairing epochs : 187/197 [00:03&lt;00:00,   51.80it/s]


 95%|#########5| Repairing epochs : 188/197 [00:03&lt;00:00,   51.42it/s]


 96%|#########6| Repairing epochs : 190/197 [00:03&lt;00:00,   52.23it/s]


 97%|#########6| Repairing epochs : 191/197 [00:03&lt;00:00,   51.79it/s]


 97%|#########7| Repairing epochs : 192/197 [00:03&lt;00:00,   51.20it/s]


 98%|#########7| Repairing epochs : 193/197 [00:03&lt;00:00,   50.89it/s]


 98%|#########8| Repairing epochs : 194/197 [00:03&lt;00:00,   50.35it/s]


 99%|#########8| Repairing epochs : 195/197 [00:03&lt;00:00,   49.80it/s]


 99%|#########9| Repairing epochs : 196/197 [00:03&lt;00:00,   49.39it/s]


100%|##########| Repairing epochs : 197/197 [00:03&lt;00:00,   48.91it/s]
100%|##########| Repairing epochs : 197/197 [00:03&lt;00:00,   55.05it/s]




  0%|          | Fold : 0/10 [00:00&lt;?,       ?it/s]



 10%|#         | Fold : 1/10 [00:00&lt;00:02,    3.63it/s]



 20%|##        | Fold : 2/10 [00:00&lt;00:02,    3.99it/s]



 30%|###       | Fold : 3/10 [00:00&lt;00:01,    4.16it/s]



 40%|####      | Fold : 4/10 [00:00&lt;00:01,    4.22it/s]



 50%|#####     | Fold : 5/10 [00:01&lt;00:01,    4.25it/s]



 60%|######    | Fold : 6/10 [00:01&lt;00:00,    4.30it/s]



 70%|#######   | Fold : 7/10 [00:01&lt;00:00,    4.33it/s]



 80%|########  | Fold : 8/10 [00:01&lt;00:00,    4.37it/s]



 90%|######### | Fold : 9/10 [00:02&lt;00:00,    4.39it/s]



100%|##########| Fold : 10/10 [00:02&lt;00:00,    4.40it/s]
100%|##########| Fold : 10/10 [00:02&lt;00:00,    4.37it/s]


 33%|###3      | n_interp : 1/3 [00:06&lt;00:12,    6.04s/it]


  0%|          | Repairing epochs : 0/197 [00:00&lt;?,       ?it/s]


  1%|1         | Repairing epochs : 2/197 [00:00&lt;00:01,  102.82it/s]


  2%|2         | Repairing epochs : 4/197 [00:00&lt;00:02,   92.20it/s]


  3%|3         | Repairing epochs : 6/197 [00:00&lt;00:02,   88.69it/s]


  4%|4         | Repairing epochs : 8/197 [00:00&lt;00:02,   87.46it/s]


  5%|5         | Repairing epochs : 10/197 [00:00&lt;00:02,   86.42it/s]


  6%|6         | Repairing epochs : 12/197 [00:00&lt;00:02,   86.59it/s]


  7%|7         | Repairing epochs : 14/197 [00:00&lt;00:02,   86.69it/s]


  8%|8         | Repairing epochs : 16/197 [00:00&lt;00:02,   86.68it/s]


  9%|9         | Repairing epochs : 18/197 [00:00&lt;00:02,   86.41it/s]


 10%|#         | Repairing epochs : 20/197 [00:00&lt;00:02,   86.37it/s]


 11%|#1        | Repairing epochs : 22/197 [00:00&lt;00:02,   86.10it/s]


 12%|#2        | Repairing epochs : 24/197 [00:00&lt;00:02,   86.17it/s]


 13%|#3        | Repairing epochs : 26/197 [00:00&lt;00:01,   85.86it/s]


 14%|#4        | Repairing epochs : 28/197 [00:00&lt;00:01,   85.63it/s]


 15%|#5        | Repairing epochs : 30/197 [00:00&lt;00:01,   85.79it/s]


 16%|#6        | Repairing epochs : 32/197 [00:00&lt;00:01,   85.82it/s]


 17%|#7        | Repairing epochs : 34/197 [00:00&lt;00:01,   86.07it/s]


 18%|#8        | Repairing epochs : 36/197 [00:00&lt;00:01,   85.83it/s]


 19%|#9        | Repairing epochs : 38/197 [00:00&lt;00:01,   85.84it/s]


 20%|##        | Repairing epochs : 40/197 [00:00&lt;00:01,   85.90it/s]


 21%|##1       | Repairing epochs : 42/197 [00:00&lt;00:01,   86.05it/s]


 22%|##2       | Repairing epochs : 44/197 [00:00&lt;00:01,   86.06it/s]


 23%|##3       | Repairing epochs : 46/197 [00:00&lt;00:01,   87.89it/s]


 24%|##4       | Repairing epochs : 48/197 [00:00&lt;00:01,   87.89it/s]


 25%|##5       | Repairing epochs : 50/197 [00:00&lt;00:01,   87.84it/s]


 26%|##6       | Repairing epochs : 52/197 [00:00&lt;00:01,   89.63it/s]


 27%|##7       | Repairing epochs : 54/197 [00:00&lt;00:01,   89.48it/s]


 28%|##8       | Repairing epochs : 56/197 [00:00&lt;00:01,   89.02it/s]


 29%|##9       | Repairing epochs : 58/197 [00:00&lt;00:01,   88.85it/s]


 30%|###       | Repairing epochs : 60/197 [00:00&lt;00:01,   90.28it/s]


 31%|###1      | Repairing epochs : 62/197 [00:00&lt;00:01,   91.85it/s]


 32%|###2      | Repairing epochs : 64/197 [00:00&lt;00:01,   91.33it/s]


 34%|###3      | Repairing epochs : 66/197 [00:00&lt;00:01,   90.92it/s]


 35%|###4      | Repairing epochs : 68/197 [00:00&lt;00:01,   90.48it/s]


 36%|###5      | Repairing epochs : 70/197 [00:00&lt;00:01,   91.96it/s]


 37%|###7      | Repairing epochs : 73/197 [00:00&lt;00:01,   93.24it/s]


 38%|###8      | Repairing epochs : 75/197 [00:00&lt;00:01,   92.76it/s]


 39%|###9      | Repairing epochs : 77/197 [00:00&lt;00:01,   92.22it/s]


 40%|####      | Repairing epochs : 79/197 [00:00&lt;00:01,   91.75it/s]


 41%|####1     | Repairing epochs : 81/197 [00:00&lt;00:01,   91.26it/s]


 42%|####2     | Repairing epochs : 83/197 [00:00&lt;00:01,   90.61it/s]


 43%|####2     | Repairing epochs : 84/197 [00:00&lt;00:01,   88.71it/s]


 43%|####3     | Repairing epochs : 85/197 [00:00&lt;00:01,   86.05it/s]


 44%|####3     | Repairing epochs : 86/197 [00:00&lt;00:01,   83.56it/s]


 44%|####4     | Repairing epochs : 87/197 [00:01&lt;00:01,   81.05it/s]


 46%|####5     | Repairing epochs : 90/197 [00:01&lt;00:01,   84.47it/s]


 47%|####6     | Repairing epochs : 92/197 [00:01&lt;00:01,   84.70it/s]


 48%|####7     | Repairing epochs : 94/197 [00:01&lt;00:01,   84.76it/s]


 49%|####8     | Repairing epochs : 96/197 [00:01&lt;00:01,   84.70it/s]


 50%|####9     | Repairing epochs : 98/197 [00:01&lt;00:01,   84.86it/s]


 51%|#####     | Repairing epochs : 100/197 [00:01&lt;00:01,   84.86it/s]


 52%|#####1    | Repairing epochs : 102/197 [00:01&lt;00:01,   84.90it/s]


 53%|#####2    | Repairing epochs : 104/197 [00:01&lt;00:01,   86.24it/s]


 54%|#####3    | Repairing epochs : 106/197 [00:01&lt;00:01,   86.01it/s]


 55%|#####4    | Repairing epochs : 108/197 [00:01&lt;00:01,   87.45it/s]


 56%|#####5    | Repairing epochs : 110/197 [00:01&lt;00:00,   87.09it/s]


 57%|#####6    | Repairing epochs : 112/197 [00:01&lt;00:00,   86.86it/s]


 58%|#####7    | Repairing epochs : 114/197 [00:01&lt;00:00,   86.73it/s]


 59%|#####8    | Repairing epochs : 116/197 [00:01&lt;00:00,   86.32it/s]


 60%|#####9    | Repairing epochs : 118/197 [00:01&lt;00:00,   87.61it/s]


 61%|######    | Repairing epochs : 120/197 [00:01&lt;00:00,   87.20it/s]


 61%|######1   | Repairing epochs : 121/197 [00:01&lt;00:00,   84.85it/s]


 62%|######1   | Repairing epochs : 122/197 [00:01&lt;00:00,   82.65it/s]


 62%|######2   | Repairing epochs : 123/197 [00:01&lt;00:00,   81.50it/s]


 63%|######3   | Repairing epochs : 125/197 [00:01&lt;00:00,   81.62it/s]


 65%|######4   | Repairing epochs : 128/197 [00:01&lt;00:00,   84.74it/s]


 66%|######5   | Repairing epochs : 130/197 [00:01&lt;00:00,   84.69it/s]


 67%|######7   | Repairing epochs : 132/197 [00:01&lt;00:00,   84.80it/s]


 68%|######8   | Repairing epochs : 134/197 [00:01&lt;00:00,   84.70it/s]


 69%|######9   | Repairing epochs : 136/197 [00:01&lt;00:00,   84.54it/s]


 70%|#######   | Repairing epochs : 138/197 [00:01&lt;00:00,   84.55it/s]


 71%|#######1  | Repairing epochs : 140/197 [00:01&lt;00:00,   84.53it/s]


 72%|#######2  | Repairing epochs : 142/197 [00:01&lt;00:00,   84.60it/s]


 73%|#######3  | Repairing epochs : 144/197 [00:01&lt;00:00,   84.58it/s]


 74%|#######4  | Repairing epochs : 146/197 [00:01&lt;00:00,   84.61it/s]


 76%|#######5  | Repairing epochs : 149/197 [00:01&lt;00:00,   85.97it/s]


 77%|#######6  | Repairing epochs : 151/197 [00:01&lt;00:00,   87.13it/s]


 78%|#######8  | Repairing epochs : 154/197 [00:01&lt;00:00,   85.87it/s]


 79%|#######8  | Repairing epochs : 155/197 [00:01&lt;00:00,   83.70it/s]


 80%|#######9  | Repairing epochs : 157/197 [00:01&lt;00:00,   84.38it/s]


 81%|########  | Repairing epochs : 159/197 [00:01&lt;00:00,   84.43it/s]


 82%|########1 | Repairing epochs : 161/197 [00:01&lt;00:00,   84.40it/s]


 84%|########3 | Repairing epochs : 165/197 [00:01&lt;00:00,   88.75it/s]


 85%|########4 | Repairing epochs : 167/197 [00:01&lt;00:00,   88.55it/s]


 86%|########5 | Repairing epochs : 169/197 [00:01&lt;00:00,   88.43it/s]


 87%|########6 | Repairing epochs : 171/197 [00:01&lt;00:00,   88.34it/s]


 88%|########7 | Repairing epochs : 173/197 [00:01&lt;00:00,   88.12it/s]


 89%|########8 | Repairing epochs : 175/197 [00:02&lt;00:00,   87.81it/s]


 90%|########9 | Repairing epochs : 177/197 [00:02&lt;00:00,   87.76it/s]


 91%|######### | Repairing epochs : 179/197 [00:02&lt;00:00,   87.42it/s]


 92%|#########1| Repairing epochs : 181/197 [00:02&lt;00:00,   85.46it/s]


 93%|#########2| Repairing epochs : 183/197 [00:02&lt;00:00,   84.11it/s]


 93%|#########3| Repairing epochs : 184/197 [00:02&lt;00:00,   82.22it/s]


 94%|#########3| Repairing epochs : 185/197 [00:02&lt;00:00,   80.18it/s]


 94%|#########4| Repairing epochs : 186/197 [00:02&lt;00:00,   78.43it/s]


 95%|#########4| Repairing epochs : 187/197 [00:02&lt;00:00,   76.76it/s]


 96%|#########5| Repairing epochs : 189/197 [00:02&lt;00:00,   78.29it/s]


 97%|#########6| Repairing epochs : 191/197 [00:02&lt;00:00,   76.20it/s]


 97%|#########7| Repairing epochs : 192/197 [00:02&lt;00:00,   74.61it/s]


 98%|#########7| Repairing epochs : 193/197 [00:02&lt;00:00,   72.89it/s]


 98%|#########8| Repairing epochs : 194/197 [00:02&lt;00:00,   72.04it/s]


 99%|#########9| Repairing epochs : 196/197 [00:02&lt;00:00,   72.70it/s]
100%|##########| Repairing epochs : 197/197 [00:02&lt;00:00,   82.91it/s]




  0%|          | Fold : 0/10 [00:00&lt;?,       ?it/s]



 10%|#         | Fold : 1/10 [00:00&lt;00:02,    4.22it/s]



 20%|##        | Fold : 2/10 [00:00&lt;00:01,    4.32it/s]



 30%|###       | Fold : 3/10 [00:00&lt;00:01,    4.34it/s]



 40%|####      | Fold : 4/10 [00:00&lt;00:01,    4.37it/s]



 50%|#####     | Fold : 5/10 [00:01&lt;00:01,    4.39it/s]



 60%|######    | Fold : 6/10 [00:01&lt;00:00,    4.40it/s]



 70%|#######   | Fold : 7/10 [00:01&lt;00:00,    4.39it/s]



 80%|########  | Fold : 8/10 [00:01&lt;00:00,    4.40it/s]



 90%|######### | Fold : 9/10 [00:02&lt;00:00,    4.42it/s]



100%|##########| Fold : 10/10 [00:02&lt;00:00,    4.43it/s]
100%|##########| Fold : 10/10 [00:02&lt;00:00,    4.42it/s]


 67%|######6   | n_interp : 2/3 [00:10&lt;00:05,    5.39s/it]


  0%|          | Repairing epochs : 0/197 [00:00&lt;?,       ?it/s]


  2%|1         | Repairing epochs : 3/197 [00:00&lt;00:01,  116.17it/s]


  2%|2         | Repairing epochs : 4/197 [00:00&lt;00:02,   94.25it/s]


  3%|2         | Repairing epochs : 5/197 [00:00&lt;00:02,   75.07it/s]


  3%|3         | Repairing epochs : 6/197 [00:00&lt;00:02,   64.86it/s]


  4%|3         | Repairing epochs : 7/197 [00:00&lt;00:03,   59.99it/s]


  4%|4         | Repairing epochs : 8/197 [00:00&lt;00:03,   59.33it/s]


  5%|5         | Repairing epochs : 10/197 [00:00&lt;00:02,   63.72it/s]


  6%|6         | Repairing epochs : 12/197 [00:00&lt;00:02,   66.57it/s]


  7%|7         | Repairing epochs : 14/197 [00:00&lt;00:02,   69.30it/s]


  8%|8         | Repairing epochs : 16/197 [00:00&lt;00:02,   72.01it/s]


  9%|9         | Repairing epochs : 18/197 [00:00&lt;00:02,   73.81it/s]


 10%|#         | Repairing epochs : 20/197 [00:00&lt;00:02,   75.00it/s]


 11%|#1        | Repairing epochs : 22/197 [00:00&lt;00:02,   76.84it/s]


 12%|#2        | Repairing epochs : 24/197 [00:00&lt;00:02,   77.65it/s]


 13%|#3        | Repairing epochs : 26/197 [00:00&lt;00:02,   78.65it/s]


 14%|#4        | Repairing epochs : 28/197 [00:00&lt;00:02,   79.47it/s]


 15%|#5        | Repairing epochs : 30/197 [00:00&lt;00:02,   80.35it/s]


 16%|#6        | Repairing epochs : 32/197 [00:00&lt;00:02,   81.08it/s]


 17%|#7        | Repairing epochs : 34/197 [00:00&lt;00:01,   81.54it/s]


 18%|#8        | Repairing epochs : 36/197 [00:00&lt;00:01,   81.86it/s]


 19%|#9        | Repairing epochs : 38/197 [00:00&lt;00:01,   82.01it/s]


 20%|##        | Repairing epochs : 40/197 [00:00&lt;00:01,   82.33it/s]


 21%|##1       | Repairing epochs : 42/197 [00:00&lt;00:01,   82.84it/s]


 22%|##2       | Repairing epochs : 44/197 [00:00&lt;00:01,   82.83it/s]


 23%|##3       | Repairing epochs : 46/197 [00:00&lt;00:01,   84.83it/s]


 24%|##4       | Repairing epochs : 48/197 [00:00&lt;00:01,   85.13it/s]


 25%|##5       | Repairing epochs : 50/197 [00:00&lt;00:01,   85.17it/s]


 26%|##6       | Repairing epochs : 52/197 [00:00&lt;00:01,   87.07it/s]


 27%|##7       | Repairing epochs : 54/197 [00:00&lt;00:01,   84.52it/s]


 28%|##7       | Repairing epochs : 55/197 [00:00&lt;00:01,   80.76it/s]


 28%|##8       | Repairing epochs : 56/197 [00:00&lt;00:01,   78.47it/s]


 29%|##8       | Repairing epochs : 57/197 [00:00&lt;00:01,   77.63it/s]


 30%|##9       | Repairing epochs : 59/197 [00:00&lt;00:01,   78.07it/s]


 31%|###1      | Repairing epochs : 62/197 [00:00&lt;00:01,   82.00it/s]


 32%|###2      | Repairing epochs : 64/197 [00:00&lt;00:01,   82.20it/s]


 34%|###3      | Repairing epochs : 66/197 [00:00&lt;00:01,   82.30it/s]


 35%|###4      | Repairing epochs : 68/197 [00:00&lt;00:01,   82.60it/s]


 36%|###6      | Repairing epochs : 71/197 [00:00&lt;00:01,   86.25it/s]


 37%|###7      | Repairing epochs : 73/197 [00:00&lt;00:01,   86.26it/s]


 38%|###8      | Repairing epochs : 75/197 [00:00&lt;00:01,   86.27it/s]


 39%|###9      | Repairing epochs : 77/197 [00:00&lt;00:01,   86.00it/s]


 40%|####      | Repairing epochs : 79/197 [00:00&lt;00:01,   86.01it/s]


 41%|####1     | Repairing epochs : 81/197 [00:00&lt;00:01,   85.73it/s]


 42%|####2     | Repairing epochs : 83/197 [00:00&lt;00:01,   85.71it/s]


 43%|####2     | Repairing epochs : 84/197 [00:01&lt;00:01,   83.53it/s]


 43%|####3     | Repairing epochs : 85/197 [00:01&lt;00:01,   81.22it/s]


 44%|####3     | Repairing epochs : 86/197 [00:01&lt;00:01,   79.10it/s]


 44%|####4     | Repairing epochs : 87/197 [00:01&lt;00:01,   76.94it/s]


 46%|####5     | Repairing epochs : 90/197 [00:01&lt;00:01,   80.44it/s]


 47%|####6     | Repairing epochs : 92/197 [00:01&lt;00:01,   81.01it/s]


 48%|####7     | Repairing epochs : 94/197 [00:01&lt;00:01,   81.17it/s]


 49%|####8     | Repairing epochs : 96/197 [00:01&lt;00:01,   81.42it/s]


 50%|####9     | Repairing epochs : 98/197 [00:01&lt;00:01,   81.83it/s]


 51%|#####     | Repairing epochs : 100/197 [00:01&lt;00:01,   81.27it/s]


 51%|#####1    | Repairing epochs : 101/197 [00:01&lt;00:01,   79.33it/s]


 52%|#####1    | Repairing epochs : 102/197 [00:01&lt;00:01,   77.41it/s]


 53%|#####2    | Repairing epochs : 104/197 [00:01&lt;00:01,   76.04it/s]


 54%|#####3    | Repairing epochs : 106/197 [00:01&lt;00:01,   76.41it/s]


 55%|#####5    | Repairing epochs : 109/197 [00:01&lt;00:01,   78.36it/s]


 56%|#####6    | Repairing epochs : 111/197 [00:01&lt;00:01,   78.54it/s]


 57%|#####7    | Repairing epochs : 113/197 [00:01&lt;00:01,   78.61it/s]


 58%|#####8    | Repairing epochs : 115/197 [00:01&lt;00:01,   78.66it/s]


 59%|#####9    | Repairing epochs : 117/197 [00:01&lt;00:00,   80.19it/s]


 60%|######    | Repairing epochs : 119/197 [00:01&lt;00:00,   79.92it/s]


 61%|######    | Repairing epochs : 120/197 [00:01&lt;00:00,   77.94it/s]


 61%|######1   | Repairing epochs : 121/197 [00:01&lt;00:00,   76.33it/s]


 62%|######1   | Repairing epochs : 122/197 [00:01&lt;00:01,   74.66it/s]


 62%|######2   | Repairing epochs : 123/197 [00:01&lt;00:00,   74.17it/s]


 63%|######3   | Repairing epochs : 125/197 [00:01&lt;00:00,   74.81it/s]


 65%|######4   | Repairing epochs : 128/197 [00:01&lt;00:00,   78.19it/s]


 66%|######5   | Repairing epochs : 130/197 [00:01&lt;00:00,   78.71it/s]


 67%|######7   | Repairing epochs : 132/197 [00:01&lt;00:00,   78.38it/s]


 68%|######7   | Repairing epochs : 133/197 [00:01&lt;00:00,   76.50it/s]


 68%|######8   | Repairing epochs : 134/197 [00:01&lt;00:00,   74.70it/s]


 69%|######9   | Repairing epochs : 136/197 [00:01&lt;00:00,   75.19it/s]


 70%|#######   | Repairing epochs : 138/197 [00:01&lt;00:00,   75.72it/s]


 71%|#######1  | Repairing epochs : 140/197 [00:01&lt;00:00,   76.22it/s]


 72%|#######2  | Repairing epochs : 142/197 [00:01&lt;00:00,   76.88it/s]


 73%|#######3  | Repairing epochs : 144/197 [00:01&lt;00:00,   77.37it/s]


 74%|#######4  | Repairing epochs : 146/197 [00:01&lt;00:00,   77.86it/s]


 75%|#######5  | Repairing epochs : 148/197 [00:01&lt;00:00,   79.36it/s]


 76%|#######5  | Repairing epochs : 149/197 [00:01&lt;00:00,   77.32it/s]


 76%|#######6  | Repairing epochs : 150/197 [00:01&lt;00:00,   75.34it/s]


 77%|#######7  | Repairing epochs : 152/197 [00:01&lt;00:00,   74.58it/s]


 78%|#######8  | Repairing epochs : 154/197 [00:01&lt;00:00,   76.19it/s]


 79%|#######9  | Repairing epochs : 156/197 [00:01&lt;00:00,   77.84it/s]


 80%|########  | Repairing epochs : 158/197 [00:01&lt;00:00,   78.30it/s]


 81%|########1 | Repairing epochs : 160/197 [00:02&lt;00:00,   78.73it/s]


 82%|########2 | Repairing epochs : 162/197 [00:02&lt;00:00,   80.23it/s]


 84%|########3 | Repairing epochs : 165/197 [00:02&lt;00:00,   83.46it/s]


 85%|########4 | Repairing epochs : 167/197 [00:02&lt;00:00,   83.49it/s]


 86%|########5 | Repairing epochs : 169/197 [00:02&lt;00:00,   83.67it/s]


 87%|########6 | Repairing epochs : 171/197 [00:02&lt;00:00,   83.71it/s]


 88%|########7 | Repairing epochs : 173/197 [00:02&lt;00:00,   83.77it/s]


 89%|########8 | Repairing epochs : 175/197 [00:02&lt;00:00,   83.79it/s]


 90%|########9 | Repairing epochs : 177/197 [00:02&lt;00:00,   83.77it/s]


 91%|######### | Repairing epochs : 179/197 [00:02&lt;00:00,   83.60it/s]


 92%|#########1| Repairing epochs : 181/197 [00:02&lt;00:00,   83.88it/s]


 93%|#########2| Repairing epochs : 183/197 [00:02&lt;00:00,   82.39it/s]


 93%|#########3| Repairing epochs : 184/197 [00:02&lt;00:00,   80.38it/s]


 94%|#########3| Repairing epochs : 185/197 [00:02&lt;00:00,   79.17it/s]


 94%|#########4| Repairing epochs : 186/197 [00:02&lt;00:00,   76.79it/s]


 95%|#########4| Repairing epochs : 187/197 [00:02&lt;00:00,   76.14it/s]


 95%|#########5| Repairing epochs : 188/197 [00:02&lt;00:00,   75.38it/s]


 96%|#########6| Repairing epochs : 190/197 [00:02&lt;00:00,   76.48it/s]


 97%|#########6| Repairing epochs : 191/197 [00:02&lt;00:00,   75.64it/s]


 97%|#########7| Repairing epochs : 192/197 [00:02&lt;00:00,   73.44it/s]


 98%|#########7| Repairing epochs : 193/197 [00:02&lt;00:00,   71.72it/s]


 98%|#########8| Repairing epochs : 194/197 [00:02&lt;00:00,   70.66it/s]


 99%|#########9| Repairing epochs : 196/197 [00:02&lt;00:00,   71.60it/s]
100%|##########| Repairing epochs : 197/197 [00:02&lt;00:00,   77.98it/s]




  0%|          | Fold : 0/10 [00:00&lt;?,       ?it/s]



 10%|#         | Fold : 1/10 [00:00&lt;00:01,    6.73it/s]



 20%|##        | Fold : 2/10 [00:00&lt;00:01,    7.07it/s]



 30%|###       | Fold : 3/10 [00:00&lt;00:00,    7.21it/s]



 40%|####      | Fold : 4/10 [00:00&lt;00:00,    7.25it/s]



 50%|#####     | Fold : 5/10 [00:00&lt;00:00,    7.29it/s]



 60%|######    | Fold : 6/10 [00:00&lt;00:00,    7.29it/s]



 70%|#######   | Fold : 7/10 [00:00&lt;00:00,    7.32it/s]



 80%|########  | Fold : 8/10 [00:01&lt;00:00,    7.35it/s]



 90%|######### | Fold : 9/10 [00:01&lt;00:00,    7.37it/s]



100%|##########| Fold : 10/10 [00:01&lt;00:00,    7.39it/s]
100%|##########| Fold : 10/10 [00:01&lt;00:00,    7.37it/s]


100%|##########| n_interp : 3/3 [00:14&lt;00:00,    4.89s/it]
100%|##########| n_interp : 3/3 [00:14&lt;00:00,    4.92s/it]




Estimated consensus=1.00 and n_interpolate=32



  0%|          | Repairing epochs : 0/197 [00:00&lt;?,       ?it/s]


  2%|1         | Repairing epochs : 3/197 [00:00&lt;00:01,  111.86it/s]


  2%|2         | Repairing epochs : 4/197 [00:00&lt;00:02,   92.77it/s]


  3%|2         | Repairing epochs : 5/197 [00:00&lt;00:02,   74.46it/s]


  4%|3         | Repairing epochs : 7/197 [00:00&lt;00:02,   77.39it/s]


  5%|4         | Repairing epochs : 9/197 [00:00&lt;00:02,   78.02it/s]


  6%|5         | Repairing epochs : 11/197 [00:00&lt;00:02,   79.06it/s]


  7%|6         | Repairing epochs : 13/197 [00:00&lt;00:02,   80.55it/s]


  8%|7         | Repairing epochs : 15/197 [00:00&lt;00:02,   81.91it/s]


  9%|8         | Repairing epochs : 17/197 [00:00&lt;00:02,   82.69it/s]


 10%|9         | Repairing epochs : 19/197 [00:00&lt;00:02,   83.50it/s]


 11%|#         | Repairing epochs : 21/197 [00:00&lt;00:02,   83.99it/s]


 12%|#1        | Repairing epochs : 23/197 [00:00&lt;00:02,   84.22it/s]


 13%|#2        | Repairing epochs : 25/197 [00:00&lt;00:02,   84.59it/s]


 14%|#3        | Repairing epochs : 27/197 [00:00&lt;00:02,   84.99it/s]


 15%|#4        | Repairing epochs : 29/197 [00:00&lt;00:01,   85.29it/s]


 16%|#5        | Repairing epochs : 31/197 [00:00&lt;00:01,   85.54it/s]


 17%|#6        | Repairing epochs : 33/197 [00:00&lt;00:01,   85.76it/s]


 18%|#7        | Repairing epochs : 35/197 [00:00&lt;00:01,   85.79it/s]


 19%|#8        | Repairing epochs : 37/197 [00:00&lt;00:01,   85.57it/s]


 20%|#9        | Repairing epochs : 39/197 [00:00&lt;00:01,   85.46it/s]


 21%|##        | Repairing epochs : 41/197 [00:00&lt;00:01,   85.81it/s]


 22%|##1       | Repairing epochs : 43/197 [00:00&lt;00:01,   85.54it/s]


 23%|##2       | Repairing epochs : 45/197 [00:00&lt;00:01,   85.58it/s]


 24%|##4       | Repairing epochs : 48/197 [00:00&lt;00:01,   87.76it/s]


 25%|##5       | Repairing epochs : 50/197 [00:00&lt;00:01,   87.62it/s]


 26%|##6       | Repairing epochs : 52/197 [00:00&lt;00:01,   89.38it/s]


 27%|##7       | Repairing epochs : 54/197 [00:00&lt;00:01,   89.03it/s]


 28%|##8       | Repairing epochs : 56/197 [00:00&lt;00:01,   88.73it/s]


 29%|##9       | Repairing epochs : 58/197 [00:00&lt;00:01,   88.71it/s]


 30%|###       | Repairing epochs : 60/197 [00:00&lt;00:01,   90.02it/s]


 31%|###1      | Repairing epochs : 62/197 [00:00&lt;00:01,   91.42it/s]


 32%|###2      | Repairing epochs : 64/197 [00:00&lt;00:01,   90.98it/s]


 34%|###3      | Repairing epochs : 66/197 [00:00&lt;00:01,   90.54it/s]


 35%|###4      | Repairing epochs : 68/197 [00:00&lt;00:01,   90.39it/s]


 36%|###6      | Repairing epochs : 71/197 [00:00&lt;00:01,   93.72it/s]


 37%|###7      | Repairing epochs : 73/197 [00:00&lt;00:01,   93.35it/s]


 38%|###8      | Repairing epochs : 75/197 [00:00&lt;00:01,   92.85it/s]


 39%|###9      | Repairing epochs : 77/197 [00:00&lt;00:01,   92.11it/s]


 40%|####      | Repairing epochs : 79/197 [00:00&lt;00:01,   91.26it/s]


 41%|####1     | Repairing epochs : 81/197 [00:00&lt;00:01,   90.69it/s]


 42%|####2     | Repairing epochs : 83/197 [00:00&lt;00:01,   90.49it/s]


 43%|####3     | Repairing epochs : 85/197 [00:00&lt;00:01,   87.04it/s]


 44%|####3     | Repairing epochs : 86/197 [00:00&lt;00:01,   84.63it/s]


 44%|####4     | Repairing epochs : 87/197 [00:01&lt;00:01,   82.20it/s]


 45%|####5     | Repairing epochs : 89/197 [00:01&lt;00:01,   83.73it/s]


 47%|####6     | Repairing epochs : 92/197 [00:01&lt;00:01,   85.56it/s]


 48%|####7     | Repairing epochs : 94/197 [00:01&lt;00:01,   85.60it/s]


 49%|####8     | Repairing epochs : 96/197 [00:01&lt;00:01,   85.60it/s]


 50%|####9     | Repairing epochs : 98/197 [00:01&lt;00:01,   85.78it/s]


 51%|#####     | Repairing epochs : 100/197 [00:01&lt;00:01,   84.97it/s]


 51%|#####1    | Repairing epochs : 101/197 [00:01&lt;00:01,   82.88it/s]


 52%|#####1    | Repairing epochs : 102/197 [00:01&lt;00:01,   80.76it/s]


 53%|#####2    | Repairing epochs : 104/197 [00:01&lt;00:01,   79.13it/s]


 53%|#####3    | Repairing epochs : 105/197 [00:01&lt;00:01,   78.51it/s]


 54%|#####4    | Repairing epochs : 107/197 [00:01&lt;00:01,   80.07it/s]


 55%|#####5    | Repairing epochs : 109/197 [00:01&lt;00:01,   80.40it/s]


 56%|#####6    | Repairing epochs : 111/197 [00:01&lt;00:01,   80.41it/s]


 57%|#####6    | Repairing epochs : 112/197 [00:01&lt;00:01,   79.66it/s]


 57%|#####7    | Repairing epochs : 113/197 [00:01&lt;00:01,   77.36it/s]


 58%|#####7    | Repairing epochs : 114/197 [00:01&lt;00:01,   75.14it/s]


 58%|#####8    | Repairing epochs : 115/197 [00:01&lt;00:01,   73.13it/s]


 59%|#####8    | Repairing epochs : 116/197 [00:01&lt;00:01,   71.44it/s]


 60%|#####9    | Repairing epochs : 118/197 [00:01&lt;00:01,   73.28it/s]


 61%|######    | Repairing epochs : 120/197 [00:01&lt;00:01,   73.82it/s]


 62%|######1   | Repairing epochs : 122/197 [00:01&lt;00:01,   74.53it/s]


 63%|######2   | Repairing epochs : 124/197 [00:01&lt;00:00,   74.97it/s]


 64%|######3   | Repairing epochs : 126/197 [00:01&lt;00:00,   76.76it/s]


 65%|######5   | Repairing epochs : 129/197 [00:01&lt;00:00,   78.89it/s]


 66%|######6   | Repairing epochs : 131/197 [00:01&lt;00:00,   79.41it/s]


 68%|######7   | Repairing epochs : 133/197 [00:01&lt;00:00,   79.72it/s]


 69%|######8   | Repairing epochs : 135/197 [00:01&lt;00:00,   80.05it/s]


 70%|######9   | Repairing epochs : 137/197 [00:01&lt;00:00,   80.33it/s]


 71%|#######   | Repairing epochs : 139/197 [00:01&lt;00:00,   80.48it/s]


 72%|#######1  | Repairing epochs : 141/197 [00:01&lt;00:00,   80.76it/s]


 73%|#######2  | Repairing epochs : 143/197 [00:01&lt;00:00,   80.90it/s]


 74%|#######3  | Repairing epochs : 145/197 [00:01&lt;00:00,   79.80it/s]


 74%|#######4  | Repairing epochs : 146/197 [00:01&lt;00:00,   79.12it/s]


 75%|#######5  | Repairing epochs : 148/197 [00:01&lt;00:00,   78.72it/s]


 76%|#######6  | Repairing epochs : 150/197 [00:01&lt;00:00,   79.09it/s]


 78%|#######7  | Repairing epochs : 153/197 [00:01&lt;00:00,   82.17it/s]


 79%|#######8  | Repairing epochs : 155/197 [00:01&lt;00:00,   82.19it/s]


 80%|########  | Repairing epochs : 158/197 [00:01&lt;00:00,   83.69it/s]


 81%|########1 | Repairing epochs : 160/197 [00:01&lt;00:00,   83.63it/s]


 82%|########2 | Repairing epochs : 162/197 [00:01&lt;00:00,   84.66it/s]


 84%|########3 | Repairing epochs : 165/197 [00:01&lt;00:00,   87.61it/s]


 85%|########4 | Repairing epochs : 167/197 [00:01&lt;00:00,   87.49it/s]


 86%|########5 | Repairing epochs : 169/197 [00:02&lt;00:00,   87.52it/s]


 87%|########6 | Repairing epochs : 171/197 [00:02&lt;00:00,   87.26it/s]


 88%|########7 | Repairing epochs : 173/197 [00:02&lt;00:00,   87.13it/s]


 89%|########8 | Repairing epochs : 175/197 [00:02&lt;00:00,   87.01it/s]


 90%|########9 | Repairing epochs : 177/197 [00:02&lt;00:00,   86.73it/s]


 90%|######### | Repairing epochs : 178/197 [00:02&lt;00:00,   84.33it/s]


 91%|######### | Repairing epochs : 179/197 [00:02&lt;00:00,   81.97it/s]


 91%|#########1| Repairing epochs : 180/197 [00:02&lt;00:00,   79.99it/s]


 92%|#########2| Repairing epochs : 182/197 [00:02&lt;00:00,   80.86it/s]


 93%|#########3| Repairing epochs : 184/197 [00:02&lt;00:00,   81.16it/s]


 94%|#########4| Repairing epochs : 186/197 [00:02&lt;00:00,   81.61it/s]


 95%|#########5| Repairing epochs : 188/197 [00:02&lt;00:00,   81.59it/s]


 96%|#########6| Repairing epochs : 190/197 [00:02&lt;00:00,   83.05it/s]


 97%|#########7| Repairing epochs : 192/197 [00:02&lt;00:00,   83.41it/s]


 98%|#########8| Repairing epochs : 194/197 [00:02&lt;00:00,   83.37it/s]


 99%|#########9| Repairing epochs : 196/197 [00:02&lt;00:00,   82.07it/s]


100%|##########| Repairing epochs : 197/197 [00:02&lt;00:00,   80.75it/s]
100%|##########| Repairing epochs : 197/197 [00:02&lt;00:00,   82.81it/s]
No bad epochs were found for your data. Returning a copy of the data you wanted to clean. Interpolation may have been done.
</pre></div>
</div>
<p>We can visualize the cross validation curve over two variables</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  <span class="c1"># noqa</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>  <span class="c1"># noqa</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">patches</span>  <span class="c1"># noqa</span>
<span class="kn">from</span> <span class="nn">autoreject</span> <span class="kn">import</span> <span class="n">set_matplotlib_defaults</span>  <span class="c1"># noqa</span>

<span class="n">set_matplotlib_defaults</span><span class="p">(</span><a href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot" class="sphx-glr-backref-module-matplotlib sphx-glr-backref-type-py-module"><span class="n">plt</span></a><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;seaborn-white&#39;</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">loss</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ar</span><span class="o">.</span><span class="n">loss_</span></a><span class="p">[</span><span class="s1">&#39;eeg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># losses are stored by channel type.</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.matshow.html#matplotlib.pyplot.matshow" title="matplotlib.pyplot.matshow" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">matshow</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">loss</span><span class="o">.</span><span class="n">T</span></a> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.get_cmap.html#matplotlib.pyplot.get_cmap" title="matplotlib.pyplot.get_cmap" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span></a><span class="p">(</span><span class="s1">&#39;viridis&#39;</span><span class="p">))</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xticks.html#matplotlib.pyplot.xticks" title="matplotlib.pyplot.xticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xticks</span></a><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ar</span><span class="o">.</span><span class="n">consensus</span></a><span class="p">)),</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ar</span><span class="o">.</span><span class="n">consensus</span></a><span class="p">])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ar</span><span class="o">.</span><span class="n">n_interpolate</span></a><span class="p">)),</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ar</span><span class="o">.</span><span class="n">n_interpolate</span></a><span class="p">)</span>

<span class="c1"># Draw rectangle at location of best parameters</span>
<a href="https://matplotlib.org/stable/api/axes_api.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.gca.html#matplotlib.pyplot.gca" title="matplotlib.pyplot.gca" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">gca</span></a><span class="p">()</span>
<a href="https://numpy.org/devdocs/reference/arrays.scalars.html#numpy.int64" title="numpy.int64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">idx</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/arrays.scalars.html#numpy.int64" title="numpy.int64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">jdx</span></a> <span class="o">=</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.unravel_index.html#numpy.unravel_index" title="numpy.unravel_index" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">loss</span></a><span class="o">.</span><span class="n">argmin</span><span class="p">(),</span> <a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">loss</span><span class="o">.</span><span class="n">shape</span></a><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.patches.Rectangle.html#matplotlib.patches.Rectangle" title="matplotlib.patches.Rectangle" class="sphx-glr-backref-module-matplotlib-patches sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rect</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.patches.Rectangle.html#matplotlib.patches.Rectangle" title="matplotlib.patches.Rectangle" class="sphx-glr-backref-module-matplotlib-patches sphx-glr-backref-type-py-class"><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span></a><span class="p">((</span><a href="https://numpy.org/devdocs/reference/arrays.scalars.html#numpy.int64" title="numpy.int64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">idx</span></a> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/arrays.scalars.html#numpy.int64" title="numpy.int64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">jdx</span></a> <span class="o">-</span> <span class="mf">0.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                         <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.add_patch.html#matplotlib.axes.Axes.add_patch" title="matplotlib.axes.Axes.add_patch" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span></a><span class="p">(</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.patches.Rectangle.html#matplotlib.patches.Rectangle" title="matplotlib.patches.Rectangle" class="sphx-glr-backref-module-matplotlib-patches sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rect</span></a><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axis.XAxis.set_ticks_position.html#matplotlib.axis.XAxis.set_ticks_position" title="matplotlib.axis.XAxis.set_ticks_position" class="sphx-glr-backref-module-matplotlib-axis sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span></a><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Consensus percentage $\kappa$&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.ylabel.html#matplotlib.pyplot.ylabel" title="matplotlib.pyplot.ylabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Max sensors interpolated $\rho$&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;Mean cross validation error (x 1e6)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_visualize_bad_epochs_001.png" srcset="../_images/sphx_glr_plot_visualize_bad_epochs_001.png" alt="Mean cross validation error (x 1e6)" class = "sphx-glr-single-img"/><p>â¦ and visualize the bad epochs and sensors. Bad sensors which have been
interpolated are in blue. Bad sensors which are not interpolated are in red.
Bad trials are also in red.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scalings</span></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="mf">40e-6</span><span class="p">)</span>
<a href="../generated/autoreject.RejectLog.html#autoreject.RejectLog.plot_epochs" title="autoreject.RejectLog.plot_epochs" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-method"><span class="n">reject_log</span><span class="o">.</span><span class="n">plot_epochs</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.BaseEpochs.html#mne.BaseEpochs" title="mne.BaseEpochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">this_epoch</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scalings</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scalings</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_visualize_bad_epochs_002.png" srcset="../_images/sphx_glr_plot_visualize_bad_epochs_002.png" alt="plot visualize bad epochs" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;MNEBrowseFigure size 800x800 with 4 Axes&gt;
</pre></div>
</div>
<p>â¦ and the epochs after cleaning with autoreject</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://mne.tools/dev/generated/mne.BaseEpochs.html#mne.BaseEpochs" title="mne.BaseEpochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_ar</span></a><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scalings</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scalings</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_visualize_bad_epochs_003.png" srcset="../_images/sphx_glr_plot_visualize_bad_epochs_003.png" alt="plot visualize bad epochs" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;MNEBrowseFigure size 800x800 with 4 Axes&gt;
</pre></div>
</div>
<p>The epochs dropped by autoreject are also stored in epochs.drop_log</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://mne.tools/dev/generated/mne.BaseEpochs.html#mne.BaseEpochs" title="mne.BaseEpochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_ar</span></a><span class="o">.</span><span class="n">plot_drop_log</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_visualize_bad_epochs_004.png" srcset="../_images/sphx_glr_plot_visualize_bad_epochs_004.png" alt="0 of 197 epochs removed (0.0%)" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 640x480 with 1 Axes&gt;
</pre></div>
</div>
<p>Finally, the evoked before and after autoreject, for sanity check. We use
the <code class="docutils literal notranslate"><span class="pre">spatial_colors</span></code> argument from MNE as it allows us to see that
the eyeblinks have not yet been cleaned but the bad channels have been
repaired.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ylim</span></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<a href="https://mne.tools/dev/generated/mne.BaseEpochs.html#mne.BaseEpochs" title="mne.BaseEpochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="o">.</span><span class="n">average</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ylim</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ylim</span></a><span class="p">,</span> <span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="https://mne.tools/dev/generated/mne.BaseEpochs.html#mne.BaseEpochs" title="mne.BaseEpochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_ar</span></a><span class="o">.</span><span class="n">average</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ylim</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ylim</span></a><span class="p">,</span> <span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_plot_visualize_bad_epochs_005.png" srcset="../_images/sphx_glr_plot_visualize_bad_epochs_005.png" alt="EEG (70 channels)" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_visualize_bad_epochs_006.png" srcset="../_images/sphx_glr_plot_visualize_bad_epochs_006.png" alt="EEG (70 channels)" class = "sphx-glr-multi-img"/></li>
</ul>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 640x300 with 2 Axes&gt;
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 2 minutes  10.052 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-visualize-bad-epochs-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/343ec55e666b7130c35f6a4de928c39a/plot_visualize_bad_epochs.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_visualize_bad_epochs.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/9d3e69826a86abb695c16aa2b83fb4a2/plot_visualize_bad_epochs.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_visualize_bad_epochs.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


</div>

<!-- Github "fork me" ribbon -->
<a href="https://github.com/autoreject/autoreject"><img style="position: absolute; top: 50px; right: 0; border: 0;" 
src="https://camo.githubusercontent.com/652c5b9acfaddf3a9c326fa6bde407b87f7be0f4/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6f72616e67655f6666373630302e706e67"
alt="Fork me on GitHub"
data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png"></a>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2016-2022, autoreject developers. Last updated on 2022-11-14.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>