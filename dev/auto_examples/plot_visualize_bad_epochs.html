
<!DOCTYPE html>


<html lang="en" data-theme="auto">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Visualize bad sensors per trial &#8212; autoreject 0.5.dev2 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "auto";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css?v=ea06ca08" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script src="../_static/documentation_options.js?v=a75859d3"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=fd10adb8"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'auto_examples/plot_visualize_bad_epochs';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.14.3';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://raw.githubusercontent.com/autoreject/autoreject/master/doc/_static/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'dev';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Explanation" href="../explanation.html" />
    <link rel="prev" title="Preprocessing workflow with autoreject and ICA" href="plot_autoreject_workflow.html" />
    <link rel="canonical" href="https://autoreject.github.io/stable/index.html" />
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <script type="text/javascript" src="../_static/scrollfix.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="auto">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">autoreject 0.5.dev2 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../explanation.html">
                        Explanation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../faq.html">
                        FAQ
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../whats_new.html">
                        What's new
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Quick Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/autoreject/autoreject" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../explanation.html">
                        Explanation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../faq.html">
                        FAQ
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../whats_new.html">
                        What's new
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Quick Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/autoreject/autoreject" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="plot_estimate_global_reject.html">Find global rejection threshold</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_channel_thresholds.html">Plot channel-level thresholds</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_auto_repair.html">Automatically repair epochs</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_global_reject.html">Plotting the cross-validation curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_ransac.html">Detect bad sensors using RANSAC</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_autoreject_workflow.html">Preprocessing workflow with <code class="docutils literal notranslate"><span class="pre">autoreject</span></code> and ICA</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Visualize bad sensors per trial</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Examples Gallery</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Visualize...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-plot-visualize-bad-epochs-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="visualize-bad-sensors-per-trial">
<span id="sphx-glr-auto-examples-plot-visualize-bad-epochs-py"></span><h1>Visualize bad sensors per trial<a class="headerlink" href="#visualize-bad-sensors-per-trial" title="Link to this heading">#</a></h1>
<p>This example demonstrates how to use <a class="reference internal" href="../api.html#module-autoreject" title="autoreject"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autoreject</span></code></a> to
visualize the bad sensors in each trial</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Author: Mainak Jas &lt;mainak.jas@telecom-paristech.fr&gt;</span>
<span class="c1">#         Denis A. Engemann &lt;denis.engemann@gmail.com&gt;</span>
<span class="c1"># License: BSD-3-Clause</span>

<span class="c1"># sphinx_gallery_thumbnail_number = 2</span>
</pre></div>
</div>
<p>First, we download the data from OpenfMRI which is hosted on OpenNeuro.
We will do this using <code class="docutils literal notranslate"><span class="pre">openneuro-py</span></code> which can be installed using pip
(<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">openneuro-py</span></code>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">openneuro</span>
<span class="kn">import</span> <span class="nn">autoreject</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a> <span class="o">=</span> <span class="s1">&#39;ds000117&#39;</span>  <span class="c1"># The id code on OpenNeuro for this example dataset</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject_id</span></a> <span class="o">=</span> <span class="mi">16</span>  <span class="c1"># OpenfMRI format of subject numbering</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_dir</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3/library/os.path.html#os.path.dirname" title="os.path.dirname" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span></a><span class="p">(</span><span class="n">autoreject</span><span class="o">.</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;examples&#39;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">)</span>
<a href="https://docs.python.org/3/library/os.html#os.makedirs" title="os.makedirs" class="sphx-glr-backref-module-os sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_dir</span></a><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">openneuro</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_dir</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_dir</span></a><span class="p">,</span>
                   <span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;sub-</span><span class="si">{</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject_id</span></a><span class="si">}</span><span class="s1">/ses-meg/&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>👋 Hello! This is openneuro-py 2023.1.0. Great to see you! 🤗

   👉 Please report problems 🤯 and bugs 🪲 at
      https://github.com/hoechenberger/openneuro-py/issues

🌍 Preparing to download ds000117 …

📁 Traversing directories for ds000117 : 0 entities [00:00, ? entities/s]
📁 Traversing directories for ds000117 : 23 entities [00:00, 117.97 entities/s]
📁 Traversing directories for ds000117 : 35 entities [00:00, 30.55 entities/s]
📁 Traversing directories for ds000117 : 490 entities [00:01, 378.80 entities/s]
📁 Traversing directories for ds000117 : 956 entities [00:01, 741.82 entities/s]
📁 Traversing directories for ds000117 : 1066 entities [00:07, 139.08 entities/s]
📥 Retrieving up to 22 files (5 concurrent downloads).

Skipping participants.tsv: already downloaded.: 100%|██████████| 333/333 [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_scans.tsv: already downloaded.: 100%|██████████| 475/475 [00:00&lt;?, ?B/s]


Skipping CHANGES: already downloaded.: 100%|██████████| 1.79k/1.79k [00:00&lt;?, ?B/s]


Skipping dataset_description.json: already downloaded.: 100%|██████████| 1.07k/1.07k [00:00&lt;?, ?B/s]


Skipping README: already downloaded.: 100%|██████████| 5.92k/5.92k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_channels.tsv: already downloaded.: 100%|██████████| 23.0k/23.0k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_headshape.pos: already downloaded.: 100%|██████████| 4.22k/4.22k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_meg.json: already downloaded.: 100%|██████████| 1.67k/1.67k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-02_events.tsv: already downloaded.: 100%|██████████| 6.06k/6.06k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_coordsystem.json: already downloaded.: 100%|██████████| 1.81k/1.81k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-03_events.tsv: already downloaded.: 100%|██████████| 6.19k/6.19k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-01_events.tsv: already downloaded.: 100%|██████████| 6.19k/6.19k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_events.tsv: already downloaded.: 100%|██████████| 8.75k/8.75k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-06_events.tsv: already downloaded.: 100%|██████████| 6.24k/6.24k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-04_events.tsv: already downloaded.: 100%|██████████| 6.23k/6.23k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-05_events.tsv: already downloaded.: 100%|██████████| 6.15k/6.15k [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-01_meg.fif: already downloaded.: 100%|██████████| 824M/824M [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-06_meg.fif: already downloaded.: 100%|██████████| 822M/822M [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-05_meg.fif: already downloaded.: 100%|██████████| 824M/824M [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-03_meg.fif: already downloaded.: 100%|██████████| 832M/832M [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-04_meg.fif: already downloaded.: 100%|██████████| 830M/830M [00:00&lt;?, ?B/s]


Skipping sub-16_ses-meg_task-facerecognition_run-02_meg.fif: already downloaded.: 100%|██████████| 835M/835M [00:00&lt;?, ?B/s]

✅ Finished downloading ds000117.

🧠 Please enjoy your brains.
</pre></div>
</div>
<p>We will create epochs with data starting 200 ms before trigger onset
and continuing up to 800 ms after that. The data contains visual stimuli for
famous faces, unfamiliar faces, as well as scrambled faces.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmax</span></a> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events_id</span></a> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;famous/first&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;famous/immediate&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;famous/long&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">}</span>
</pre></div>
</div>
<p>Let us now load all the epochs into memory and concatenate them</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mne</span>  <span class="c1"># noqa</span>

<a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray" title="mne.EpochsArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">run</span></a> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">):</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">run_fname</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_dir</span></a><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;sub-</span><span class="si">{</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject_id</span></a><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;ses-meg&#39;</span><span class="p">,</span> <span class="s1">&#39;meg&#39;</span><span class="p">,</span>
                             <span class="sa">f</span><span class="s1">&#39;sub-</span><span class="si">{</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject_id</span></a><span class="si">}</span><span class="s1">_ses-meg_task-facerecognition&#39;</span>
                             <span class="s1">&#39;_run-</span><span class="si">{:02d}</span><span class="s1">_meg.fif&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">run</span></a><span class="p">))</span>
    <a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.io.read_raw_fif.html#mne.io.read_raw_fif" title="mne.io.read_raw_fif" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_fif</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">run_fname</span></a><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw.pick_types" title="mne.io.Raw.pick_types" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">pick_types</span></a><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># less memory + computation</span>
    <a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw.filter" title="mne.io.Raw.filter" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">filter</span></a><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">,</span> <span class="n">l_trans_bandwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="s1">&#39;INFO&#39;</span><span class="p">)</span>

    <a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw.set_channel_types" title="mne.io.Raw.set_channel_types" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">set_channel_types</span></a><span class="p">({</span><span class="s1">&#39;EEG061&#39;</span><span class="p">:</span> <span class="s1">&#39;eog&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG062&#39;</span><span class="p">:</span> <span class="s1">&#39;eog&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;EEG063&#39;</span><span class="p">:</span> <span class="s1">&#39;ecg&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG064&#39;</span><span class="p">:</span> <span class="s1">&#39;misc&#39;</span><span class="p">})</span>
    <a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw.rename_channels" title="mne.io.Raw.rename_channels" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-method"><span class="n">raw</span><span class="o">.</span><span class="n">rename_channels</span></a><span class="p">({</span><span class="s1">&#39;EEG061&#39;</span><span class="p">:</span> <span class="s1">&#39;EOG061&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG062&#39;</span><span class="p">:</span> <span class="s1">&#39;EOG062&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;EEG063&#39;</span><span class="p">:</span> <span class="s1">&#39;ECG063&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG064&#39;</span><span class="p">:</span> <span class="s1">&#39;MISC&#39;</span><span class="p">})</span>

    <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.find_events.html#mne.find_events" title="mne.find_events" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">find_events</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">,</span> <span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;STI101&#39;</span><span class="p">,</span>
                             <span class="n">consecutive</span><span class="o">=</span><span class="s1">&#39;increasing&#39;</span><span class="p">,</span>
                             <span class="n">min_duration</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Read epochs</span>
    <a href="https://mne.tools/dev/generated/mne.set_eeg_reference.html#mne.set_eeg_reference" title="mne.set_eeg_reference" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">set_eeg_reference</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">)</span>

    <a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epoch</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class"><span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events_id</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmax</span></a><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">baseline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">preload</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reject</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">decim</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray" title="mne.EpochsArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span><span class="o">.</span><span class="n">append</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epoch</span></a><span class="p">)</span>

    <span class="c1"># Same `dev_head_t` for all runs so that we can concatenate them.</span>
    <a href="https://mne.tools/dev/generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epoch</span><span class="o">.</span><span class="n">info</span></a><span class="p">[</span><span class="s1">&#39;dev_head_t&#39;</span><span class="p">]</span> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray" title="mne.EpochsArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;dev_head_t&#39;</span><span class="p">]</span>


<a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray" title="mne.EpochsArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.concatenate_epochs.html#mne.concatenate_epochs" title="mne.concatenate_epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">epochs</span><span class="o">.</span><span class="n">concatenate_epochs</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray" title="mne.EpochsArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Opening raw data file /home/circleci/project/autoreject/../examples/ds000117/sub-16/ses-meg/meg/sub-16_ses-meg_task-facerecognition_run-03_meg.fif...
    Read a total of 8 projection items:
        mag_ssp_upright.fif : PCA-mags-v1 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v2 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v3 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v4 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v5 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v1 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v2 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v3 (1 x 306)  idle
    Range : 40700 ... 588499 =     37.000 ...   534.999 secs
Ready.
Reading 0 ... 547799  =      0.000 ...   497.999 secs...
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v3, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v4, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v5, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v3, active : False, n_channels : 306&gt;
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 0.75 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 7261 samples (6.601 s)

/home/circleci/project/examples/plot_visualize_bad_epochs.py:57: RuntimeWarning: The unit for channel(s) EEG064 has changed from V to NA.
  raw.set_channel_types({&#39;EEG061&#39;: &#39;eog&#39;, &#39;EEG062&#39;: &#39;eog&#39;,
296 events found
Event IDs: [   5    6    7   13   14   15   17   18   19  261  262  263  269  271
  273  274  275 4096 4101 4102 4103 4109 4110 4111 4113 4114 4115]
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom (&#39;EEG&#39;,) reference.
Not setting metadata
49 matching events found
No baseline correction applied
0 projection items activated
Opening raw data file /home/circleci/project/autoreject/../examples/ds000117/sub-16/ses-meg/meg/sub-16_ses-meg_task-facerecognition_run-04_meg.fif...
    Read a total of 8 projection items:
        mag_ssp_upright.fif : PCA-mags-v1 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v2 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v3 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v4 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v5 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v1 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v2 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v3 (1 x 306)  idle
    Range : 36300 ... 582999 =     33.000 ...   529.999 secs
Ready.
Reading 0 ... 546699  =      0.000 ...   496.999 secs...
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v3, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v4, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v5, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v3, active : False, n_channels : 306&gt;
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 0.75 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 7261 samples (6.601 s)

/home/circleci/project/examples/plot_visualize_bad_epochs.py:57: RuntimeWarning: The unit for channel(s) EEG064 has changed from V to NA.
  raw.set_channel_types({&#39;EEG061&#39;: &#39;eog&#39;, &#39;EEG062&#39;: &#39;eog&#39;,
296 events found
Event IDs: [   5    6    7   13   14   15   17   18   19  256  261  262  263  269
  271  273  274  275 4096 4101 4102 4103 4109 4110 4111 4113 4114 4115]
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom (&#39;EEG&#39;,) reference.
Not setting metadata
49 matching events found
No baseline correction applied
0 projection items activated
Opening raw data file /home/circleci/project/autoreject/../examples/ds000117/sub-16/ses-meg/meg/sub-16_ses-meg_task-facerecognition_run-05_meg.fif...
    Read a total of 8 projection items:
        mag_ssp_upright.fif : PCA-mags-v1 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v2 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v3 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v4 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v5 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v1 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v2 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v3 (1 x 306)  idle
    Range : 60500 ... 602799 =     55.000 ...   547.999 secs
Ready.
Reading 0 ... 542299  =      0.000 ...   492.999 secs...
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v3, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v4, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v5, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v3, active : False, n_channels : 306&gt;
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 0.75 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 7261 samples (6.601 s)

/home/circleci/project/examples/plot_visualize_bad_epochs.py:57: RuntimeWarning: The unit for channel(s) EEG064 has changed from V to NA.
  raw.set_channel_types({&#39;EEG061&#39;: &#39;eog&#39;, &#39;EEG062&#39;: &#39;eog&#39;,
292 events found
Event IDs: [   5    6    7   13   14   15   17   18   19  256  261  269  271  273
  274  275 4096 4101 4102 4103 4109 4110 4111 4113 4114 4115]
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom (&#39;EEG&#39;,) reference.
Not setting metadata
49 matching events found
No baseline correction applied
0 projection items activated
Opening raw data file /home/circleci/project/autoreject/../examples/ds000117/sub-16/ses-meg/meg/sub-16_ses-meg_task-facerecognition_run-06_meg.fif...
    Read a total of 8 projection items:
        mag_ssp_upright.fif : PCA-mags-v1 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v2 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v3 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v4 (1 x 306)  idle
        mag_ssp_upright.fif : PCA-mags-v5 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v1 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v2 (1 x 306)  idle
        grad_ssp_upright.fif : PCA-grad-v3 (1 x 306)  idle
    Range : 27500 ... 568699 =     25.000 ...   516.999 secs
Ready.
Reading 0 ... 541199  =      0.000 ...   491.999 secs...
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v3, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v4, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | mag_ssp_upright.fif : PCA-mags-v5, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v1, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v2, active : False, n_channels : 306&gt;
Removing projector &lt;Projection | grad_ssp_upright.fif : PCA-grad-v3, active : False, n_channels : 306&gt;
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 0.75 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 7261 samples (6.601 s)

/home/circleci/project/examples/plot_visualize_bad_epochs.py:57: RuntimeWarning: The unit for channel(s) EEG064 has changed from V to NA.
  raw.set_channel_types({&#39;EEG061&#39;: &#39;eog&#39;, &#39;EEG062&#39;: &#39;eog&#39;,
295 events found
Event IDs: [   5    6    7   13   14   15   17   18   19  256  261  262  263  269
  270  271  273  274  275 4096 4101 4102 4103 4109 4110 4111 4113 4114
 4115]
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom (&#39;EEG&#39;,) reference.
Not setting metadata
50 matching events found
No baseline correction applied
0 projection items activated
Using data from preloaded Raw for 49 events and 1101 original time points (prior to decimation) ...
0 bad epochs dropped
Using data from preloaded Raw for 49 events and 1101 original time points (prior to decimation) ...
0 bad epochs dropped
Using data from preloaded Raw for 49 events and 1101 original time points (prior to decimation) ...
0 bad epochs dropped
Using data from preloaded Raw for 50 events and 1101 original time points (prior to decimation) ...
0 bad epochs dropped
Using data from preloaded Raw for 49 events and 1101 original time points (prior to decimation) ...
Using data from preloaded Raw for 49 events and 1101 original time points (prior to decimation) ...
Using data from preloaded Raw for 49 events and 1101 original time points (prior to decimation) ...
Using data from preloaded Raw for 50 events and 1101 original time points (prior to decimation) ...
Not setting metadata
197 matching events found
No baseline correction applied
</pre></div>
</div>
<p>Now, we apply autoreject</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">autoreject</span> <span class="kn">import</span> <a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject" title="autoreject.AutoReject" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class"><span class="n">AutoReject</span></a><span class="p">,</span> <span class="n">compute_thresholds</span>  <span class="c1"># noqa</span>

<a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray" title="mne.EpochsArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">this_epoch</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray" title="mne.EpochsArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="s1">&#39;famous&#39;</span><span class="p">]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">exclude</span></a> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># XXX</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">picks</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.pick_types.html#mne.pick_types" title="mne.pick_types" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">eog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">exclude</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">exclude</span></a><span class="p">)</span>
</pre></div>
</div>
<p>Note that <a class="reference internal" href="../generated/autoreject.AutoReject.html#autoreject.AutoReject" title="autoreject.AutoReject"><code class="xref py py-class docutils literal notranslate"><span class="pre">autoreject.AutoReject</span></code></a> by design supports multiple
channels. If no picks are passed separate solutions will be computed for each
channel type and internally combines. This then readily supports cleaning
unseen epochs from the different channel types used during fit.
Here we only use a subset of channels to save time.</p>
<p>Also note that once the parameters are learned, any data can be repaired
that contains channels that were used during fit. This also means that time
may be saved by fitting <a class="reference internal" href="../generated/autoreject.AutoReject.html#autoreject.AutoReject" title="autoreject.AutoReject"><code class="xref py py-class docutils literal notranslate"><span class="pre">autoreject.AutoReject</span></code></a> on a
representative subsample of the data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject" title="autoreject.AutoReject" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ar</span></a> <span class="o">=</span> <a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject" title="autoreject.AutoReject" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class"><span class="n">AutoReject</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">picks</span></a><span class="o">=</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">picks</span></a><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray" title="mne.EpochsArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_ar</span></a><span class="p">,</span> <a href="../generated/autoreject.RejectLog.html#autoreject.RejectLog" title="autoreject.RejectLog" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reject_log</span></a> <span class="o">=</span> <a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject.fit_transform" title="autoreject.AutoReject.fit_transform" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-method"><span class="n">ar</span><span class="o">.</span><span class="n">fit_transform</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray" title="mne.EpochsArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">this_epoch</span></a><span class="p">,</span> <span class="n">return_log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Running autoreject on ch_type=eeg

  0%|          | Creating augmented epochs : 0/70 [00:00&lt;?,       ?it/s]
  1%|▏         | Creating augmented epochs : 1/70 [00:00&lt;00:01,   52.67it/s]
  3%|▎         | Creating augmented epochs : 2/70 [00:00&lt;00:01,   37.92it/s]
  4%|▍         | Creating augmented epochs : 3/70 [00:00&lt;00:01,   34.57it/s]
  6%|▌         | Creating augmented epochs : 4/70 [00:00&lt;00:01,   33.13it/s]
  7%|▋         | Creating augmented epochs : 5/70 [00:00&lt;00:02,   32.06it/s]
  9%|▊         | Creating augmented epochs : 6/70 [00:00&lt;00:01,   32.03it/s]
 10%|█         | Creating augmented epochs : 7/70 [00:00&lt;00:01,   34.33it/s]
 11%|█▏        | Creating augmented epochs : 8/70 [00:00&lt;00:01,   36.40it/s]
 13%|█▎        | Creating augmented epochs : 9/70 [00:00&lt;00:01,   38.11it/s]
 14%|█▍        | Creating augmented epochs : 10/70 [00:00&lt;00:01,   39.66it/s]
 16%|█▌        | Creating augmented epochs : 11/70 [00:00&lt;00:01,   40.84it/s]
 17%|█▋        | Creating augmented epochs : 12/70 [00:00&lt;00:01,   41.95it/s]
 19%|█▊        | Creating augmented epochs : 13/70 [00:00&lt;00:01,   42.99it/s]
 20%|██        | Creating augmented epochs : 14/70 [00:00&lt;00:01,   43.46it/s]
 21%|██▏       | Creating augmented epochs : 15/70 [00:00&lt;00:01,   41.54it/s]
 23%|██▎       | Creating augmented epochs : 16/70 [00:00&lt;00:01,   40.00it/s]
 24%|██▍       | Creating augmented epochs : 17/70 [00:00&lt;00:01,   38.78it/s]
 26%|██▌       | Creating augmented epochs : 18/70 [00:00&lt;00:01,   37.83it/s]
 27%|██▋       | Creating augmented epochs : 19/70 [00:00&lt;00:01,   37.10it/s]
 29%|██▊       | Creating augmented epochs : 20/70 [00:00&lt;00:01,   36.35it/s]
 30%|███       | Creating augmented epochs : 21/70 [00:00&lt;00:01,   35.62it/s]
 31%|███▏      | Creating augmented epochs : 22/70 [00:00&lt;00:01,   35.10it/s]
 33%|███▎      | Creating augmented epochs : 23/70 [00:00&lt;00:01,   34.50it/s]
 34%|███▍      | Creating augmented epochs : 24/70 [00:00&lt;00:01,   34.02it/s]
 36%|███▌      | Creating augmented epochs : 25/70 [00:00&lt;00:01,   33.32it/s]
 37%|███▋      | Creating augmented epochs : 26/70 [00:00&lt;00:01,   32.91it/s]
 39%|███▊      | Creating augmented epochs : 27/70 [00:00&lt;00:01,   32.99it/s]
 40%|████      | Creating augmented epochs : 28/70 [00:00&lt;00:01,   33.85it/s]
 41%|████▏     | Creating augmented epochs : 29/70 [00:00&lt;00:01,   34.70it/s]
 43%|████▎     | Creating augmented epochs : 30/70 [00:00&lt;00:01,   35.59it/s]
 44%|████▍     | Creating augmented epochs : 31/70 [00:00&lt;00:01,   36.43it/s]
 46%|████▌     | Creating augmented epochs : 32/70 [00:00&lt;00:01,   37.23it/s]
 47%|████▋     | Creating augmented epochs : 33/70 [00:00&lt;00:00,   38.03it/s]
 49%|████▊     | Creating augmented epochs : 34/70 [00:00&lt;00:00,   38.73it/s]
 50%|█████     | Creating augmented epochs : 35/70 [00:00&lt;00:00,   39.28it/s]
 51%|█████▏    | Creating augmented epochs : 36/70 [00:00&lt;00:00,   38.37it/s]
 53%|█████▎    | Creating augmented epochs : 37/70 [00:00&lt;00:00,   37.69it/s]
 54%|█████▍    | Creating augmented epochs : 38/70 [00:01&lt;00:00,   37.14it/s]
 56%|█████▌    | Creating augmented epochs : 39/70 [00:01&lt;00:00,   36.43it/s]
 57%|█████▋    | Creating augmented epochs : 40/70 [00:01&lt;00:00,   35.85it/s]
 59%|█████▊    | Creating augmented epochs : 41/70 [00:01&lt;00:00,   35.33it/s]
 60%|██████    | Creating augmented epochs : 42/70 [00:01&lt;00:00,   34.85it/s]
 61%|██████▏   | Creating augmented epochs : 43/70 [00:01&lt;00:00,   34.28it/s]
 63%|██████▎   | Creating augmented epochs : 44/70 [00:01&lt;00:00,   33.76it/s]
 64%|██████▍   | Creating augmented epochs : 45/70 [00:01&lt;00:00,   33.43it/s]
 66%|██████▌   | Creating augmented epochs : 46/70 [00:01&lt;00:00,   33.08it/s]
 67%|██████▋   | Creating augmented epochs : 47/70 [00:01&lt;00:00,   32.76it/s]
 69%|██████▊   | Creating augmented epochs : 48/70 [00:01&lt;00:00,   33.13it/s]
 70%|███████   | Creating augmented epochs : 49/70 [00:01&lt;00:00,   33.90it/s]
 71%|███████▏  | Creating augmented epochs : 50/70 [00:01&lt;00:00,   34.66it/s]
 73%|███████▎  | Creating augmented epochs : 51/70 [00:01&lt;00:00,   35.36it/s]
 74%|███████▍  | Creating augmented epochs : 52/70 [00:01&lt;00:00,   36.09it/s]
 76%|███████▌  | Creating augmented epochs : 53/70 [00:01&lt;00:00,   36.79it/s]
 77%|███████▋  | Creating augmented epochs : 54/70 [00:01&lt;00:00,   37.46it/s]
 79%|███████▊  | Creating augmented epochs : 55/70 [00:01&lt;00:00,   37.99it/s]
 80%|████████  | Creating augmented epochs : 56/70 [00:01&lt;00:00,   38.24it/s]
 81%|████████▏ | Creating augmented epochs : 57/70 [00:01&lt;00:00,   37.54it/s]
 83%|████████▎ | Creating augmented epochs : 58/70 [00:01&lt;00:00,   36.97it/s]
 84%|████████▍ | Creating augmented epochs : 59/70 [00:01&lt;00:00,   36.38it/s]
 86%|████████▌ | Creating augmented epochs : 60/70 [00:01&lt;00:00,   35.73it/s]
 87%|████████▋ | Creating augmented epochs : 61/70 [00:01&lt;00:00,   35.16it/s]
 89%|████████▊ | Creating augmented epochs : 62/70 [00:01&lt;00:00,   34.69it/s]
 90%|█████████ | Creating augmented epochs : 63/70 [00:01&lt;00:00,   34.31it/s]
 91%|█████████▏| Creating augmented epochs : 64/70 [00:01&lt;00:00,   33.95it/s]
 93%|█████████▎| Creating augmented epochs : 65/70 [00:01&lt;00:00,   33.65it/s]
 94%|█████████▍| Creating augmented epochs : 66/70 [00:01&lt;00:00,   33.33it/s]
 96%|█████████▌| Creating augmented epochs : 67/70 [00:01&lt;00:00,   33.08it/s]
 97%|█████████▋| Creating augmented epochs : 68/70 [00:01&lt;00:00,   32.87it/s]
 99%|█████████▊| Creating augmented epochs : 69/70 [00:01&lt;00:00,   32.58it/s]
100%|██████████| Creating augmented epochs : 70/70 [00:02&lt;00:00,   32.37it/s]
100%|██████████| Creating augmented epochs : 70/70 [00:02&lt;00:00,   34.66it/s]

  0%|          | Computing thresholds ... : 0/70 [00:00&lt;?,       ?it/s]
  1%|▏         | Computing thresholds ... : 1/70 [00:00&lt;00:40,    1.69it/s]
  3%|▎         | Computing thresholds ... : 2/70 [00:01&lt;00:40,    1.68it/s]
  4%|▍         | Computing thresholds ... : 3/70 [00:01&lt;00:39,    1.69it/s]
  6%|▌         | Computing thresholds ... : 4/70 [00:02&lt;00:37,    1.74it/s]
  7%|▋         | Computing thresholds ... : 5/70 [00:02&lt;00:36,    1.79it/s]
  9%|▊         | Computing thresholds ... : 6/70 [00:03&lt;00:35,    1.81it/s]
 10%|█         | Computing thresholds ... : 7/70 [00:03&lt;00:34,    1.81it/s]
 11%|█▏        | Computing thresholds ... : 8/70 [00:04&lt;00:34,    1.82it/s]
 13%|█▎        | Computing thresholds ... : 9/70 [00:04&lt;00:33,    1.83it/s]
 14%|█▍        | Computing thresholds ... : 10/70 [00:05&lt;00:32,    1.83it/s]
 16%|█▌        | Computing thresholds ... : 11/70 [00:06&lt;00:32,    1.83it/s]
 17%|█▋        | Computing thresholds ... : 12/70 [00:06&lt;00:31,    1.84it/s]
 19%|█▊        | Computing thresholds ... : 13/70 [00:07&lt;00:30,    1.85it/s]
 20%|██        | Computing thresholds ... : 14/70 [00:07&lt;00:30,    1.86it/s]
 21%|██▏       | Computing thresholds ... : 15/70 [00:08&lt;00:29,    1.85it/s]
 23%|██▎       | Computing thresholds ... : 16/70 [00:08&lt;00:29,    1.86it/s]
 24%|██▍       | Computing thresholds ... : 17/70 [00:09&lt;00:28,    1.87it/s]
 26%|██▌       | Computing thresholds ... : 18/70 [00:09&lt;00:27,    1.88it/s]
 27%|██▋       | Computing thresholds ... : 19/70 [00:10&lt;00:27,    1.88it/s]
 29%|██▊       | Computing thresholds ... : 20/70 [00:10&lt;00:26,    1.87it/s]
 30%|███       | Computing thresholds ... : 21/70 [00:11&lt;00:26,    1.87it/s]
 31%|███▏      | Computing thresholds ... : 22/70 [00:11&lt;00:25,    1.86it/s]
 33%|███▎      | Computing thresholds ... : 23/70 [00:12&lt;00:25,    1.85it/s]
 34%|███▍      | Computing thresholds ... : 24/70 [00:12&lt;00:24,    1.86it/s]
 36%|███▌      | Computing thresholds ... : 25/70 [00:13&lt;00:24,    1.86it/s]
 37%|███▋      | Computing thresholds ... : 26/70 [00:14&lt;00:23,    1.85it/s]
 39%|███▊      | Computing thresholds ... : 27/70 [00:14&lt;00:23,    1.85it/s]
 40%|████      | Computing thresholds ... : 28/70 [00:15&lt;00:22,    1.85it/s]
 41%|████▏     | Computing thresholds ... : 29/70 [00:15&lt;00:22,    1.85it/s]
 43%|████▎     | Computing thresholds ... : 30/70 [00:16&lt;00:21,    1.86it/s]
 44%|████▍     | Computing thresholds ... : 31/70 [00:16&lt;00:21,    1.85it/s]
 46%|████▌     | Computing thresholds ... : 32/70 [00:17&lt;00:20,    1.85it/s]
 47%|████▋     | Computing thresholds ... : 33/70 [00:17&lt;00:20,    1.85it/s]
 49%|████▊     | Computing thresholds ... : 34/70 [00:18&lt;00:19,    1.85it/s]
 50%|█████     | Computing thresholds ... : 35/70 [00:18&lt;00:19,    1.84it/s]
 51%|█████▏    | Computing thresholds ... : 36/70 [00:19&lt;00:18,    1.84it/s]
 53%|█████▎    | Computing thresholds ... : 37/70 [00:20&lt;00:17,    1.84it/s]
 54%|█████▍    | Computing thresholds ... : 38/70 [00:20&lt;00:17,    1.85it/s]
 56%|█████▌    | Computing thresholds ... : 39/70 [00:21&lt;00:16,    1.86it/s]
 57%|█████▋    | Computing thresholds ... : 40/70 [00:21&lt;00:16,    1.86it/s]
 59%|█████▊    | Computing thresholds ... : 41/70 [00:22&lt;00:15,    1.83it/s]
 60%|██████    | Computing thresholds ... : 42/70 [00:22&lt;00:15,    1.80it/s]
 61%|██████▏   | Computing thresholds ... : 43/70 [00:23&lt;00:15,    1.80it/s]
 63%|██████▎   | Computing thresholds ... : 44/70 [00:24&lt;00:14,    1.80it/s]
 64%|██████▍   | Computing thresholds ... : 45/70 [00:24&lt;00:13,    1.80it/s]
 66%|██████▌   | Computing thresholds ... : 46/70 [00:25&lt;00:13,    1.80it/s]
 67%|██████▋   | Computing thresholds ... : 47/70 [00:25&lt;00:12,    1.80it/s]
 69%|██████▊   | Computing thresholds ... : 48/70 [00:26&lt;00:12,    1.81it/s]
 70%|███████   | Computing thresholds ... : 49/70 [00:26&lt;00:11,    1.81it/s]
 71%|███████▏  | Computing thresholds ... : 50/70 [00:27&lt;00:11,    1.81it/s]
 73%|███████▎  | Computing thresholds ... : 51/70 [00:27&lt;00:10,    1.81it/s]
 74%|███████▍  | Computing thresholds ... : 52/70 [00:28&lt;00:09,    1.81it/s]
 76%|███████▌  | Computing thresholds ... : 53/70 [00:29&lt;00:09,    1.81it/s]
 77%|███████▋  | Computing thresholds ... : 54/70 [00:29&lt;00:08,    1.81it/s]
 79%|███████▊  | Computing thresholds ... : 55/70 [00:30&lt;00:08,    1.80it/s]
 80%|████████  | Computing thresholds ... : 56/70 [00:30&lt;00:07,    1.79it/s]
 81%|████████▏ | Computing thresholds ... : 57/70 [00:31&lt;00:07,    1.79it/s]
 83%|████████▎ | Computing thresholds ... : 58/70 [00:31&lt;00:06,    1.79it/s]
 84%|████████▍ | Computing thresholds ... : 59/70 [00:32&lt;00:06,    1.79it/s]
 86%|████████▌ | Computing thresholds ... : 60/70 [00:33&lt;00:05,    1.79it/s]
 87%|████████▋ | Computing thresholds ... : 61/70 [00:33&lt;00:05,    1.79it/s]
 89%|████████▊ | Computing thresholds ... : 62/70 [00:34&lt;00:04,    1.77it/s]
 90%|█████████ | Computing thresholds ... : 63/70 [00:34&lt;00:03,    1.77it/s]
 91%|█████████▏| Computing thresholds ... : 64/70 [00:35&lt;00:03,    1.76it/s]
 93%|█████████▎| Computing thresholds ... : 65/70 [00:36&lt;00:02,    1.76it/s]
 94%|█████████▍| Computing thresholds ... : 66/70 [00:36&lt;00:02,    1.76it/s]
 96%|█████████▌| Computing thresholds ... : 67/70 [00:37&lt;00:01,    1.76it/s]
 97%|█████████▋| Computing thresholds ... : 68/70 [00:37&lt;00:01,    1.76it/s]
 99%|█████████▊| Computing thresholds ... : 69/70 [00:38&lt;00:00,    1.76it/s]
100%|██████████| Computing thresholds ... : 70/70 [00:38&lt;00:00,    1.76it/s]
100%|██████████| Computing thresholds ... : 70/70 [00:38&lt;00:00,    1.80it/s]



  0%|          | Repairing epochs : 0/197 [00:00&lt;?,       ?it/s]


  4%|▎         | Repairing epochs : 7/197 [00:00&lt;00:00,  390.22it/s]


  7%|▋         | Repairing epochs : 14/197 [00:00&lt;00:00,  394.54it/s]


 11%|█         | Repairing epochs : 21/197 [00:00&lt;00:00,  396.05it/s]


 14%|█▍        | Repairing epochs : 28/197 [00:00&lt;00:00,  397.32it/s]


 18%|█▊        | Repairing epochs : 35/197 [00:00&lt;00:00,  398.74it/s]


 21%|██▏       | Repairing epochs : 42/197 [00:00&lt;00:00,  398.81it/s]


 25%|██▍       | Repairing epochs : 49/197 [00:00&lt;00:00,  399.15it/s]


 28%|██▊       | Repairing epochs : 56/197 [00:00&lt;00:00,  399.50it/s]


 32%|███▏      | Repairing epochs : 63/197 [00:00&lt;00:00,  399.50it/s]


 36%|███▌      | Repairing epochs : 70/197 [00:00&lt;00:00,  399.62it/s]


 39%|███▉      | Repairing epochs : 77/197 [00:00&lt;00:00,  400.07it/s]


 43%|████▎     | Repairing epochs : 84/197 [00:00&lt;00:00,  400.28it/s]


 46%|████▌     | Repairing epochs : 91/197 [00:00&lt;00:00,  400.51it/s]


 50%|████▉     | Repairing epochs : 98/197 [00:00&lt;00:00,  400.46it/s]


 53%|█████▎    | Repairing epochs : 105/197 [00:00&lt;00:00,  400.58it/s]


 57%|█████▋    | Repairing epochs : 112/197 [00:00&lt;00:00,  400.70it/s]


 60%|██████    | Repairing epochs : 119/197 [00:00&lt;00:00,  400.68it/s]


 64%|██████▍   | Repairing epochs : 126/197 [00:00&lt;00:00,  400.64it/s]


 68%|██████▊   | Repairing epochs : 133/197 [00:00&lt;00:00,  400.68it/s]


 71%|███████   | Repairing epochs : 140/197 [00:00&lt;00:00,  400.68it/s]


 75%|███████▍  | Repairing epochs : 147/197 [00:00&lt;00:00,  400.64it/s]


 78%|███████▊  | Repairing epochs : 154/197 [00:00&lt;00:00,  400.65it/s]


 82%|████████▏ | Repairing epochs : 161/197 [00:00&lt;00:00,  400.67it/s]


 85%|████████▌ | Repairing epochs : 168/197 [00:00&lt;00:00,  400.46it/s]


 89%|████████▉ | Repairing epochs : 175/197 [00:00&lt;00:00,  400.47it/s]


 92%|█████████▏| Repairing epochs : 182/197 [00:00&lt;00:00,  400.45it/s]


 96%|█████████▌| Repairing epochs : 189/197 [00:00&lt;00:00,  400.44it/s]


 99%|█████████▉| Repairing epochs : 196/197 [00:00&lt;00:00,  400.46it/s]
100%|██████████| Repairing epochs : 197/197 [00:00&lt;00:00,  400.12it/s]


  0%|          | n_interp : 0/3 [00:00&lt;?,       ?it/s]


  0%|          | Repairing epochs : 0/197 [00:00&lt;?,       ?it/s]


  1%|          | Repairing epochs : 2/197 [00:00&lt;00:01,   99.73it/s]


  2%|▏         | Repairing epochs : 4/197 [00:00&lt;00:02,   85.35it/s]


  3%|▎         | Repairing epochs : 6/197 [00:00&lt;00:02,   84.34it/s]


  4%|▍         | Repairing epochs : 8/197 [00:00&lt;00:02,   83.77it/s]


  5%|▌         | Repairing epochs : 10/197 [00:00&lt;00:02,   83.54it/s]


  6%|▌         | Repairing epochs : 12/197 [00:00&lt;00:02,   83.48it/s]


  7%|▋         | Repairing epochs : 14/197 [00:00&lt;00:02,   83.44it/s]


  8%|▊         | Repairing epochs : 16/197 [00:00&lt;00:02,   83.32it/s]


  9%|▉         | Repairing epochs : 18/197 [00:00&lt;00:02,   83.24it/s]


 10%|█         | Repairing epochs : 20/197 [00:00&lt;00:02,   83.07it/s]


 11%|█         | Repairing epochs : 22/197 [00:00&lt;00:02,   82.77it/s]


 12%|█▏        | Repairing epochs : 24/197 [00:00&lt;00:02,   82.79it/s]


 13%|█▎        | Repairing epochs : 26/197 [00:00&lt;00:02,   82.77it/s]


 14%|█▍        | Repairing epochs : 28/197 [00:00&lt;00:02,   82.67it/s]


 15%|█▌        | Repairing epochs : 30/197 [00:00&lt;00:02,   82.46it/s]


 16%|█▌        | Repairing epochs : 32/197 [00:00&lt;00:02,   80.87it/s]


 17%|█▋        | Repairing epochs : 33/197 [00:00&lt;00:02,   77.49it/s]


 17%|█▋        | Repairing epochs : 34/197 [00:00&lt;00:02,   74.53it/s]


 18%|█▊        | Repairing epochs : 35/197 [00:00&lt;00:02,   71.67it/s]


 18%|█▊        | Repairing epochs : 36/197 [00:00&lt;00:02,   69.24it/s]


 19%|█▉        | Repairing epochs : 37/197 [00:00&lt;00:02,   67.16it/s]


 20%|█▉        | Repairing epochs : 39/197 [00:00&lt;00:02,   68.13it/s]


 21%|██        | Repairing epochs : 41/197 [00:00&lt;00:02,   67.93it/s]


 21%|██▏       | Repairing epochs : 42/197 [00:00&lt;00:02,   66.14it/s]


 22%|██▏       | Repairing epochs : 43/197 [00:00&lt;00:02,   64.07it/s]


 22%|██▏       | Repairing epochs : 44/197 [00:00&lt;00:02,   62.37it/s]


 23%|██▎       | Repairing epochs : 45/197 [00:00&lt;00:02,   61.03it/s]


 24%|██▍       | Repairing epochs : 47/197 [00:00&lt;00:02,   60.87it/s]


 24%|██▍       | Repairing epochs : 48/197 [00:00&lt;00:02,   59.69it/s]


 25%|██▍       | Repairing epochs : 49/197 [00:00&lt;00:02,   58.59it/s]


 25%|██▌       | Repairing epochs : 50/197 [00:00&lt;00:02,   57.25it/s]


 26%|██▋       | Repairing epochs : 52/197 [00:00&lt;00:02,   57.40it/s]


 27%|██▋       | Repairing epochs : 53/197 [00:00&lt;00:02,   56.34it/s]


 27%|██▋       | Repairing epochs : 54/197 [00:00&lt;00:02,   54.93it/s]


 28%|██▊       | Repairing epochs : 55/197 [00:00&lt;00:02,   54.00it/s]


 28%|██▊       | Repairing epochs : 56/197 [00:00&lt;00:02,   53.17it/s]


 29%|██▉       | Repairing epochs : 57/197 [00:00&lt;00:02,   52.41it/s]


 29%|██▉       | Repairing epochs : 58/197 [00:00&lt;00:02,   51.54it/s]


 30%|██▉       | Repairing epochs : 59/197 [00:00&lt;00:02,   50.98it/s]


 31%|███       | Repairing epochs : 61/197 [00:01&lt;00:02,   51.44it/s]


 32%|███▏      | Repairing epochs : 63/197 [00:01&lt;00:02,   51.78it/s]


 32%|███▏      | Repairing epochs : 64/197 [00:01&lt;00:02,   51.19it/s]


 33%|███▎      | Repairing epochs : 65/197 [00:01&lt;00:02,   50.30it/s]


 34%|███▎      | Repairing epochs : 66/197 [00:01&lt;00:02,   49.78it/s]


 34%|███▍      | Repairing epochs : 67/197 [00:01&lt;00:02,   49.30it/s]


 35%|███▍      | Repairing epochs : 68/197 [00:01&lt;00:02,   48.68it/s]


 35%|███▌      | Repairing epochs : 69/197 [00:01&lt;00:02,   48.32it/s]


 36%|███▌      | Repairing epochs : 71/197 [00:01&lt;00:02,   50.87it/s]


 37%|███▋      | Repairing epochs : 72/197 [00:01&lt;00:02,   50.12it/s]


 37%|███▋      | Repairing epochs : 73/197 [00:01&lt;00:02,   49.70it/s]


 38%|███▊      | Repairing epochs : 74/197 [00:01&lt;00:02,   49.04it/s]


 38%|███▊      | Repairing epochs : 75/197 [00:01&lt;00:02,   48.44it/s]


 39%|███▊      | Repairing epochs : 76/197 [00:01&lt;00:02,   47.82it/s]


 39%|███▉      | Repairing epochs : 77/197 [00:01&lt;00:02,   47.44it/s]


 40%|███▉      | Repairing epochs : 78/197 [00:01&lt;00:02,   47.04it/s]


 40%|████      | Repairing epochs : 79/197 [00:01&lt;00:02,   46.73it/s]


 41%|████      | Repairing epochs : 80/197 [00:01&lt;00:02,   46.42it/s]


 41%|████      | Repairing epochs : 81/197 [00:01&lt;00:02,   46.11it/s]


 42%|████▏     | Repairing epochs : 82/197 [00:01&lt;00:02,   45.83it/s]


 42%|████▏     | Repairing epochs : 83/197 [00:01&lt;00:02,   45.49it/s]


 43%|████▎     | Repairing epochs : 84/197 [00:01&lt;00:02,   45.10it/s]


 43%|████▎     | Repairing epochs : 85/197 [00:01&lt;00:02,   44.89it/s]


 44%|████▎     | Repairing epochs : 86/197 [00:01&lt;00:02,   44.62it/s]


 44%|████▍     | Repairing epochs : 87/197 [00:01&lt;00:02,   44.48it/s]


 45%|████▍     | Repairing epochs : 88/197 [00:01&lt;00:02,   44.11it/s]


 46%|████▌     | Repairing epochs : 90/197 [00:01&lt;00:02,   46.66it/s]


 46%|████▌     | Repairing epochs : 91/197 [00:01&lt;00:02,   46.27it/s]


 47%|████▋     | Repairing epochs : 92/197 [00:01&lt;00:02,   46.02it/s]


 47%|████▋     | Repairing epochs : 93/197 [00:01&lt;00:02,   45.65it/s]


 48%|████▊     | Repairing epochs : 94/197 [00:01&lt;00:02,   45.44it/s]


 48%|████▊     | Repairing epochs : 95/197 [00:01&lt;00:02,   45.16it/s]


 49%|████▊     | Repairing epochs : 96/197 [00:01&lt;00:02,   44.88it/s]


 49%|████▉     | Repairing epochs : 97/197 [00:01&lt;00:02,   44.53it/s]


 50%|████▉     | Repairing epochs : 98/197 [00:01&lt;00:02,   44.09it/s]


 50%|█████     | Repairing epochs : 99/197 [00:01&lt;00:02,   43.80it/s]


 51%|█████     | Repairing epochs : 100/197 [00:01&lt;00:02,   43.40it/s]


 51%|█████▏    | Repairing epochs : 101/197 [00:01&lt;00:02,   43.16it/s]


 52%|█████▏    | Repairing epochs : 102/197 [00:01&lt;00:02,   42.99it/s]


 53%|█████▎    | Repairing epochs : 104/197 [00:02&lt;00:02,   43.91it/s]


 53%|█████▎    | Repairing epochs : 105/197 [00:02&lt;00:02,   43.68it/s]


 54%|█████▍    | Repairing epochs : 106/197 [00:02&lt;00:02,   43.37it/s]


 55%|█████▍    | Repairing epochs : 108/197 [00:02&lt;00:02,   44.24it/s]


 55%|█████▌    | Repairing epochs : 109/197 [00:02&lt;00:02,   43.92it/s]


 56%|█████▌    | Repairing epochs : 110/197 [00:02&lt;00:01,   43.63it/s]


 56%|█████▋    | Repairing epochs : 111/197 [00:02&lt;00:01,   43.32it/s]


 57%|█████▋    | Repairing epochs : 112/197 [00:02&lt;00:01,   43.03it/s]


 57%|█████▋    | Repairing epochs : 113/197 [00:02&lt;00:01,   42.85it/s]


 58%|█████▊    | Repairing epochs : 114/197 [00:02&lt;00:01,   42.65it/s]


 58%|█████▊    | Repairing epochs : 115/197 [00:02&lt;00:01,   42.40it/s]


 59%|█████▉    | Repairing epochs : 116/197 [00:02&lt;00:01,   42.22it/s]


 60%|█████▉    | Repairing epochs : 118/197 [00:02&lt;00:01,   43.12it/s]


 60%|██████    | Repairing epochs : 119/197 [00:02&lt;00:01,   42.94it/s]


 61%|██████    | Repairing epochs : 120/197 [00:02&lt;00:01,   42.68it/s]


 61%|██████▏   | Repairing epochs : 121/197 [00:02&lt;00:01,   42.42it/s]


 62%|██████▏   | Repairing epochs : 122/197 [00:02&lt;00:01,   42.19it/s]


 62%|██████▏   | Repairing epochs : 123/197 [00:02&lt;00:01,   42.00it/s]


 63%|██████▎   | Repairing epochs : 124/197 [00:02&lt;00:01,   41.84it/s]


 63%|██████▎   | Repairing epochs : 125/197 [00:02&lt;00:01,   41.65it/s]


 64%|██████▍   | Repairing epochs : 127/197 [00:02&lt;00:01,   44.15it/s]


 65%|██████▍   | Repairing epochs : 128/197 [00:02&lt;00:01,   43.83it/s]


 65%|██████▌   | Repairing epochs : 129/197 [00:02&lt;00:01,   43.63it/s]


 66%|██████▌   | Repairing epochs : 130/197 [00:02&lt;00:01,   43.54it/s]


 66%|██████▋   | Repairing epochs : 131/197 [00:02&lt;00:01,   43.36it/s]


 67%|██████▋   | Repairing epochs : 132/197 [00:02&lt;00:01,   43.18it/s]


 68%|██████▊   | Repairing epochs : 133/197 [00:02&lt;00:01,   43.08it/s]


 68%|██████▊   | Repairing epochs : 134/197 [00:02&lt;00:01,   42.92it/s]


 69%|██████▊   | Repairing epochs : 135/197 [00:02&lt;00:01,   42.87it/s]


 69%|██████▉   | Repairing epochs : 136/197 [00:02&lt;00:01,   42.80it/s]


 70%|██████▉   | Repairing epochs : 137/197 [00:02&lt;00:01,   42.64it/s]


 70%|███████   | Repairing epochs : 138/197 [00:02&lt;00:01,   42.57it/s]


 71%|███████   | Repairing epochs : 139/197 [00:02&lt;00:01,   42.45it/s]


 71%|███████   | Repairing epochs : 140/197 [00:02&lt;00:01,   42.35it/s]


 72%|███████▏  | Repairing epochs : 141/197 [00:02&lt;00:01,   42.24it/s]


 72%|███████▏  | Repairing epochs : 142/197 [00:02&lt;00:01,   42.14it/s]


 73%|███████▎  | Repairing epochs : 143/197 [00:02&lt;00:01,   42.13it/s]


 73%|███████▎  | Repairing epochs : 144/197 [00:02&lt;00:01,   42.10it/s]


 74%|███████▎  | Repairing epochs : 145/197 [00:03&lt;00:01,   42.07it/s]


 74%|███████▍  | Repairing epochs : 146/197 [00:03&lt;00:01,   41.96it/s]


 75%|███████▌  | Repairing epochs : 148/197 [00:03&lt;00:01,   42.96it/s]


 76%|███████▌  | Repairing epochs : 149/197 [00:03&lt;00:01,   42.70it/s]


 76%|███████▌  | Repairing epochs : 150/197 [00:03&lt;00:01,   42.37it/s]


 77%|███████▋  | Repairing epochs : 152/197 [00:03&lt;00:01,   43.27it/s]


 78%|███████▊  | Repairing epochs : 154/197 [00:03&lt;00:00,   44.09it/s]


 79%|███████▊  | Repairing epochs : 155/197 [00:03&lt;00:00,   43.80it/s]


 80%|███████▉  | Repairing epochs : 157/197 [00:03&lt;00:00,   44.81it/s]


 80%|████████  | Repairing epochs : 158/197 [00:03&lt;00:00,   44.47it/s]


 81%|████████  | Repairing epochs : 159/197 [00:03&lt;00:00,   44.22it/s]


 81%|████████  | Repairing epochs : 160/197 [00:03&lt;00:00,   43.90it/s]


 82%|████████▏ | Repairing epochs : 161/197 [00:03&lt;00:00,   43.60it/s]


 84%|████████▍ | Repairing epochs : 165/197 [00:03&lt;00:00,   48.82it/s]


 85%|████████▍ | Repairing epochs : 167/197 [00:03&lt;00:00,   49.64it/s]


 85%|████████▌ | Repairing epochs : 168/197 [00:03&lt;00:00,   49.22it/s]


 86%|████████▌ | Repairing epochs : 169/197 [00:03&lt;00:00,   48.75it/s]


 86%|████████▋ | Repairing epochs : 170/197 [00:03&lt;00:00,   48.29it/s]


 87%|████████▋ | Repairing epochs : 171/197 [00:03&lt;00:00,   47.77it/s]


 87%|████████▋ | Repairing epochs : 172/197 [00:03&lt;00:00,   47.29it/s]


 88%|████████▊ | Repairing epochs : 173/197 [00:03&lt;00:00,   46.73it/s]


 88%|████████▊ | Repairing epochs : 174/197 [00:03&lt;00:00,   46.37it/s]


 89%|████████▉ | Repairing epochs : 175/197 [00:03&lt;00:00,   45.84it/s]


 89%|████████▉ | Repairing epochs : 176/197 [00:03&lt;00:00,   45.35it/s]


 90%|████████▉ | Repairing epochs : 177/197 [00:03&lt;00:00,   45.06it/s]


 90%|█████████ | Repairing epochs : 178/197 [00:03&lt;00:00,   44.55it/s]


 91%|█████████ | Repairing epochs : 179/197 [00:03&lt;00:00,   44.13it/s]


 91%|█████████▏| Repairing epochs : 180/197 [00:03&lt;00:00,   43.80it/s]


 92%|█████████▏| Repairing epochs : 181/197 [00:03&lt;00:00,   43.62it/s]


 93%|█████████▎| Repairing epochs : 183/197 [00:03&lt;00:00,   44.56it/s]


 93%|█████████▎| Repairing epochs : 184/197 [00:03&lt;00:00,   44.92it/s]


 94%|█████████▍| Repairing epochs : 186/197 [00:03&lt;00:00,   46.41it/s]


 95%|█████████▍| Repairing epochs : 187/197 [00:03&lt;00:00,   46.87it/s]


 95%|█████████▌| Repairing epochs : 188/197 [00:03&lt;00:00,   46.57it/s]


 96%|█████████▋| Repairing epochs : 190/197 [00:03&lt;00:00,   47.38it/s]


 97%|█████████▋| Repairing epochs : 191/197 [00:03&lt;00:00,   47.06it/s]


 97%|█████████▋| Repairing epochs : 192/197 [00:03&lt;00:00,   46.60it/s]


 98%|█████████▊| Repairing epochs : 193/197 [00:04&lt;00:00,   46.35it/s]


 98%|█████████▊| Repairing epochs : 194/197 [00:04&lt;00:00,   45.90it/s]


 99%|█████████▉| Repairing epochs : 195/197 [00:04&lt;00:00,   45.51it/s]


 99%|█████████▉| Repairing epochs : 196/197 [00:04&lt;00:00,   45.25it/s]


100%|██████████| Repairing epochs : 197/197 [00:04&lt;00:00,   44.96it/s]
100%|██████████| Repairing epochs : 197/197 [00:04&lt;00:00,   47.88it/s]




  0%|          | Fold : 0/10 [00:00&lt;?,       ?it/s]



 10%|█         | Fold : 1/10 [00:00&lt;00:02,    3.99it/s]



 20%|██        | Fold : 2/10 [00:00&lt;00:01,    4.26it/s]



 30%|███       | Fold : 3/10 [00:00&lt;00:01,    4.34it/s]



 40%|████      | Fold : 4/10 [00:00&lt;00:01,    4.39it/s]



 50%|█████     | Fold : 5/10 [00:01&lt;00:01,    4.43it/s]



 60%|██████    | Fold : 6/10 [00:01&lt;00:00,    4.42it/s]



 70%|███████   | Fold : 7/10 [00:01&lt;00:00,    4.44it/s]



 80%|████████  | Fold : 8/10 [00:01&lt;00:00,    4.44it/s]



 90%|█████████ | Fold : 9/10 [00:02&lt;00:00,    4.48it/s]



100%|██████████| Fold : 10/10 [00:02&lt;00:00,    4.48it/s]
100%|██████████| Fold : 10/10 [00:02&lt;00:00,    4.47it/s]


 33%|███▎      | n_interp : 1/3 [00:06&lt;00:13,    6.55s/it]


  0%|          | Repairing epochs : 0/197 [00:00&lt;?,       ?it/s]


  1%|          | Repairing epochs : 2/197 [00:00&lt;00:01,  100.59it/s]


  2%|▏         | Repairing epochs : 4/197 [00:00&lt;00:02,   81.62it/s]


  3%|▎         | Repairing epochs : 5/197 [00:00&lt;00:02,   67.39it/s]


  3%|▎         | Repairing epochs : 6/197 [00:00&lt;00:03,   59.19it/s]


  4%|▎         | Repairing epochs : 7/197 [00:00&lt;00:03,   55.20it/s]


  4%|▍         | Repairing epochs : 8/197 [00:00&lt;00:03,   54.82it/s]


  5%|▌         | Repairing epochs : 10/197 [00:00&lt;00:03,   59.26it/s]


  6%|▌         | Repairing epochs : 12/197 [00:00&lt;00:02,   63.06it/s]


  7%|▋         | Repairing epochs : 14/197 [00:00&lt;00:02,   65.69it/s]


  8%|▊         | Repairing epochs : 16/197 [00:00&lt;00:02,   67.82it/s]


  9%|▉         | Repairing epochs : 18/197 [00:00&lt;00:02,   69.19it/s]


 10%|█         | Repairing epochs : 20/197 [00:00&lt;00:02,   70.43it/s]


 11%|█         | Repairing epochs : 22/197 [00:00&lt;00:02,   71.12it/s]


 12%|█▏        | Repairing epochs : 24/197 [00:00&lt;00:02,   71.80it/s]


 13%|█▎        | Repairing epochs : 26/197 [00:00&lt;00:02,   72.21it/s]


 14%|█▍        | Repairing epochs : 28/197 [00:00&lt;00:02,   72.56it/s]


 15%|█▌        | Repairing epochs : 30/197 [00:00&lt;00:02,   73.33it/s]


 16%|█▌        | Repairing epochs : 32/197 [00:00&lt;00:02,   73.93it/s]


 17%|█▋        | Repairing epochs : 34/197 [00:00&lt;00:02,   74.72it/s]


 18%|█▊        | Repairing epochs : 36/197 [00:00&lt;00:02,   74.91it/s]


 19%|█▉        | Repairing epochs : 38/197 [00:00&lt;00:02,   75.36it/s]


 20%|██        | Repairing epochs : 40/197 [00:00&lt;00:02,   75.89it/s]


 21%|██▏       | Repairing epochs : 42/197 [00:00&lt;00:02,   76.38it/s]


 22%|██▏       | Repairing epochs : 44/197 [00:00&lt;00:01,   76.73it/s]


 23%|██▎       | Repairing epochs : 46/197 [00:00&lt;00:01,   78.43it/s]


 24%|██▍       | Repairing epochs : 48/197 [00:00&lt;00:01,   78.65it/s]


 25%|██▌       | Repairing epochs : 50/197 [00:00&lt;00:01,   78.91it/s]


 26%|██▋       | Repairing epochs : 52/197 [00:00&lt;00:01,   80.66it/s]


 27%|██▋       | Repairing epochs : 53/197 [00:00&lt;00:01,   79.76it/s]


 28%|██▊       | Repairing epochs : 55/197 [00:00&lt;00:01,   79.83it/s]


 29%|██▉       | Repairing epochs : 57/197 [00:00&lt;00:01,   79.80it/s]


 30%|██▉       | Repairing epochs : 59/197 [00:00&lt;00:01,   79.93it/s]


 31%|███       | Repairing epochs : 61/197 [00:00&lt;00:01,   81.65it/s]


 32%|███▏      | Repairing epochs : 63/197 [00:00&lt;00:01,   83.09it/s]


 33%|███▎      | Repairing epochs : 65/197 [00:00&lt;00:01,   82.90it/s]


 34%|███▍      | Repairing epochs : 67/197 [00:00&lt;00:01,   82.59it/s]


 35%|███▌      | Repairing epochs : 69/197 [00:00&lt;00:01,   82.05it/s]


 37%|███▋      | Repairing epochs : 72/197 [00:00&lt;00:01,   84.99it/s]


 38%|███▊      | Repairing epochs : 74/197 [00:00&lt;00:01,   84.66it/s]


 39%|███▊      | Repairing epochs : 76/197 [00:00&lt;00:01,   84.24it/s]


 40%|███▉      | Repairing epochs : 78/197 [00:00&lt;00:01,   83.93it/s]


 41%|████      | Repairing epochs : 80/197 [00:01&lt;00:01,   83.91it/s]


 42%|████▏     | Repairing epochs : 82/197 [00:01&lt;00:01,   83.39it/s]


 42%|████▏     | Repairing epochs : 83/197 [00:01&lt;00:01,   82.35it/s]


 43%|████▎     | Repairing epochs : 85/197 [00:01&lt;00:01,   82.33it/s]


 44%|████▍     | Repairing epochs : 87/197 [00:01&lt;00:01,   81.43it/s]


 45%|████▍     | Repairing epochs : 88/197 [00:01&lt;00:01,   79.20it/s]


 46%|████▌     | Repairing epochs : 91/197 [00:01&lt;00:01,   81.12it/s]


 47%|████▋     | Repairing epochs : 93/197 [00:01&lt;00:01,   81.21it/s]


 48%|████▊     | Repairing epochs : 95/197 [00:01&lt;00:01,   81.16it/s]


 49%|████▉     | Repairing epochs : 97/197 [00:01&lt;00:01,   81.25it/s]


 50%|█████     | Repairing epochs : 99/197 [00:01&lt;00:01,   81.39it/s]


 51%|█████▏    | Repairing epochs : 101/197 [00:01&lt;00:01,   81.30it/s]


 52%|█████▏    | Repairing epochs : 103/197 [00:01&lt;00:01,   82.69it/s]


 53%|█████▎    | Repairing epochs : 105/197 [00:01&lt;00:01,   82.41it/s]


 54%|█████▍    | Repairing epochs : 107/197 [00:01&lt;00:01,   83.54it/s]


 55%|█████▌    | Repairing epochs : 109/197 [00:01&lt;00:01,   83.17it/s]


 56%|█████▋    | Repairing epochs : 111/197 [00:01&lt;00:01,   82.67it/s]


 57%|█████▋    | Repairing epochs : 113/197 [00:01&lt;00:01,   82.34it/s]


 58%|█████▊    | Repairing epochs : 115/197 [00:01&lt;00:01,   81.88it/s]


 59%|█████▉    | Repairing epochs : 117/197 [00:01&lt;00:00,   82.97it/s]


 60%|██████    | Repairing epochs : 119/197 [00:01&lt;00:00,   82.73it/s]


 61%|██████▏   | Repairing epochs : 121/197 [00:01&lt;00:00,   81.49it/s]


 62%|██████▏   | Repairing epochs : 122/197 [00:01&lt;00:00,   79.45it/s]


 62%|██████▏   | Repairing epochs : 123/197 [00:01&lt;00:00,   77.23it/s]


 63%|██████▎   | Repairing epochs : 125/197 [00:01&lt;00:00,   77.33it/s]


 65%|██████▍   | Repairing epochs : 128/197 [00:01&lt;00:00,   80.12it/s]


 66%|██████▌   | Repairing epochs : 130/197 [00:01&lt;00:00,   79.90it/s]


 67%|██████▋   | Repairing epochs : 132/197 [00:01&lt;00:00,   79.25it/s]


 68%|██████▊   | Repairing epochs : 133/197 [00:01&lt;00:00,   77.06it/s]


 68%|██████▊   | Repairing epochs : 134/197 [00:01&lt;00:00,   75.00it/s]


 69%|██████▊   | Repairing epochs : 135/197 [00:01&lt;00:00,   73.93it/s]


 70%|██████▉   | Repairing epochs : 137/197 [00:01&lt;00:00,   74.10it/s]


 71%|███████   | Repairing epochs : 139/197 [00:01&lt;00:00,   74.43it/s]


 72%|███████▏  | Repairing epochs : 141/197 [00:01&lt;00:00,   74.82it/s]


 73%|███████▎  | Repairing epochs : 143/197 [00:01&lt;00:00,   75.09it/s]


 74%|███████▎  | Repairing epochs : 145/197 [00:01&lt;00:00,   75.20it/s]


 75%|███████▍  | Repairing epochs : 147/197 [00:01&lt;00:00,   76.59it/s]


 75%|███████▌  | Repairing epochs : 148/197 [00:01&lt;00:00,   75.99it/s]


 76%|███████▌  | Repairing epochs : 149/197 [00:01&lt;00:00,   75.12it/s]


 76%|███████▌  | Repairing epochs : 150/197 [00:01&lt;00:00,   72.86it/s]


 77%|███████▋  | Repairing epochs : 152/197 [00:01&lt;00:00,   71.91it/s]


 78%|███████▊  | Repairing epochs : 154/197 [00:02&lt;00:00,   71.61it/s]


 79%|███████▉  | Repairing epochs : 156/197 [00:02&lt;00:00,   73.20it/s]


 80%|████████  | Repairing epochs : 158/197 [00:02&lt;00:00,   73.57it/s]


 81%|████████  | Repairing epochs : 160/197 [00:02&lt;00:00,   74.00it/s]


 82%|████████▏ | Repairing epochs : 162/197 [00:02&lt;00:00,   75.44it/s]


 84%|████████▍ | Repairing epochs : 165/197 [00:02&lt;00:00,   78.36it/s]


 85%|████████▍ | Repairing epochs : 167/197 [00:02&lt;00:00,   78.28it/s]


 86%|████████▌ | Repairing epochs : 169/197 [00:02&lt;00:00,   78.45it/s]


 87%|████████▋ | Repairing epochs : 171/197 [00:02&lt;00:00,   78.62it/s]


 87%|████████▋ | Repairing epochs : 172/197 [00:02&lt;00:00,   77.85it/s]


 88%|████████▊ | Repairing epochs : 174/197 [00:02&lt;00:00,   77.99it/s]


 89%|████████▉ | Repairing epochs : 176/197 [00:02&lt;00:00,   78.14it/s]


 90%|█████████ | Repairing epochs : 178/197 [00:02&lt;00:00,   77.52it/s]


 91%|█████████ | Repairing epochs : 179/197 [00:02&lt;00:00,   75.42it/s]


 91%|█████████▏| Repairing epochs : 180/197 [00:02&lt;00:00,   73.51it/s]


 92%|█████████▏| Repairing epochs : 181/197 [00:02&lt;00:00,   71.49it/s]


 93%|█████████▎| Repairing epochs : 183/197 [00:02&lt;00:00,   70.41it/s]


 93%|█████████▎| Repairing epochs : 184/197 [00:02&lt;00:00,   68.89it/s]


 94%|█████████▍| Repairing epochs : 185/197 [00:02&lt;00:00,   67.29it/s]


 94%|█████████▍| Repairing epochs : 186/197 [00:02&lt;00:00,   66.03it/s]


 95%|█████████▍| Repairing epochs : 187/197 [00:02&lt;00:00,   65.37it/s]


 96%|█████████▌| Repairing epochs : 189/197 [00:02&lt;00:00,   67.11it/s]


 96%|█████████▋| Repairing epochs : 190/197 [00:02&lt;00:00,   66.90it/s]


 97%|█████████▋| Repairing epochs : 191/197 [00:02&lt;00:00,   65.43it/s]


 97%|█████████▋| Repairing epochs : 192/197 [00:02&lt;00:00,   64.83it/s]


 98%|█████████▊| Repairing epochs : 194/197 [00:02&lt;00:00,   65.47it/s]


 99%|█████████▉| Repairing epochs : 196/197 [00:02&lt;00:00,   66.26it/s]
100%|██████████| Repairing epochs : 197/197 [00:02&lt;00:00,   74.76it/s]




  0%|          | Fold : 0/10 [00:00&lt;?,       ?it/s]



 10%|█         | Fold : 1/10 [00:00&lt;00:02,    4.42it/s]



 20%|██        | Fold : 2/10 [00:00&lt;00:01,    4.50it/s]



 30%|███       | Fold : 3/10 [00:00&lt;00:01,    4.55it/s]



 40%|████      | Fold : 4/10 [00:00&lt;00:01,    4.52it/s]



 50%|█████     | Fold : 5/10 [00:01&lt;00:01,    4.56it/s]



 60%|██████    | Fold : 6/10 [00:01&lt;00:00,    4.55it/s]



 70%|███████   | Fold : 7/10 [00:01&lt;00:00,    4.57it/s]



 80%|████████  | Fold : 8/10 [00:01&lt;00:00,    4.58it/s]



 90%|█████████ | Fold : 9/10 [00:01&lt;00:00,    4.61it/s]



100%|██████████| Fold : 10/10 [00:02&lt;00:00,    4.63it/s]
100%|██████████| Fold : 10/10 [00:02&lt;00:00,    4.61it/s]


 67%|██████▋   | n_interp : 2/3 [00:11&lt;00:05,    5.74s/it]


  0%|          | Repairing epochs : 0/197 [00:00&lt;?,       ?it/s]


  2%|▏         | Repairing epochs : 3/197 [00:00&lt;00:01,  108.18it/s]


  2%|▏         | Repairing epochs : 4/197 [00:00&lt;00:02,   88.02it/s]


  3%|▎         | Repairing epochs : 5/197 [00:00&lt;00:02,   70.40it/s]


  4%|▎         | Repairing epochs : 7/197 [00:00&lt;00:02,   72.89it/s]


  5%|▍         | Repairing epochs : 9/197 [00:00&lt;00:02,   73.87it/s]


  6%|▌         | Repairing epochs : 11/197 [00:00&lt;00:02,   73.91it/s]


  7%|▋         | Repairing epochs : 13/197 [00:00&lt;00:02,   74.81it/s]


  8%|▊         | Repairing epochs : 15/197 [00:00&lt;00:02,   76.24it/s]


  9%|▊         | Repairing epochs : 17/197 [00:00&lt;00:02,   77.12it/s]


 10%|▉         | Repairing epochs : 19/197 [00:00&lt;00:02,   77.89it/s]


 11%|█         | Repairing epochs : 21/197 [00:00&lt;00:02,   78.16it/s]


 12%|█▏        | Repairing epochs : 23/197 [00:00&lt;00:02,   78.43it/s]


 13%|█▎        | Repairing epochs : 25/197 [00:00&lt;00:02,   78.77it/s]


 14%|█▎        | Repairing epochs : 27/197 [00:00&lt;00:02,   79.10it/s]


 15%|█▍        | Repairing epochs : 29/197 [00:00&lt;00:02,   79.31it/s]


 16%|█▌        | Repairing epochs : 31/197 [00:00&lt;00:02,   79.61it/s]


 17%|█▋        | Repairing epochs : 33/197 [00:00&lt;00:02,   79.99it/s]


 18%|█▊        | Repairing epochs : 35/197 [00:00&lt;00:02,   80.03it/s]


 19%|█▉        | Repairing epochs : 37/197 [00:00&lt;00:02,   79.73it/s]


 20%|█▉        | Repairing epochs : 39/197 [00:00&lt;00:01,   79.54it/s]


 21%|██        | Repairing epochs : 41/197 [00:00&lt;00:01,   79.78it/s]


 22%|██▏       | Repairing epochs : 43/197 [00:00&lt;00:01,   79.43it/s]


 23%|██▎       | Repairing epochs : 45/197 [00:00&lt;00:01,   79.39it/s]


 24%|██▍       | Repairing epochs : 47/197 [00:00&lt;00:01,   81.26it/s]


 25%|██▍       | Repairing epochs : 49/197 [00:00&lt;00:01,   81.17it/s]


 26%|██▌       | Repairing epochs : 51/197 [00:00&lt;00:01,   82.95it/s]


 27%|██▋       | Repairing epochs : 53/197 [00:00&lt;00:01,   82.87it/s]


 28%|██▊       | Repairing epochs : 55/197 [00:00&lt;00:01,   82.66it/s]


 29%|██▉       | Repairing epochs : 57/197 [00:00&lt;00:01,   82.88it/s]


 30%|██▉       | Repairing epochs : 59/197 [00:00&lt;00:01,   82.66it/s]


 31%|███       | Repairing epochs : 61/197 [00:00&lt;00:01,   83.76it/s]


 32%|███▏      | Repairing epochs : 63/197 [00:00&lt;00:01,   84.20it/s]


 32%|███▏      | Repairing epochs : 64/197 [00:00&lt;00:01,   81.56it/s]


 33%|███▎      | Repairing epochs : 65/197 [00:00&lt;00:01,   78.85it/s]


 34%|███▎      | Repairing epochs : 66/197 [00:00&lt;00:01,   76.34it/s]


 34%|███▍      | Repairing epochs : 67/197 [00:00&lt;00:01,   75.46it/s]


 35%|███▌      | Repairing epochs : 69/197 [00:00&lt;00:01,   76.05it/s]


 37%|███▋      | Repairing epochs : 72/197 [00:00&lt;00:01,   79.54it/s]


 38%|███▊      | Repairing epochs : 74/197 [00:00&lt;00:01,   79.67it/s]


 39%|███▊      | Repairing epochs : 76/197 [00:00&lt;00:01,   79.61it/s]


 40%|███▉      | Repairing epochs : 78/197 [00:00&lt;00:01,   79.39it/s]


 41%|████      | Repairing epochs : 80/197 [00:01&lt;00:01,   79.49it/s]


 42%|████▏     | Repairing epochs : 82/197 [00:01&lt;00:01,   79.13it/s]


 43%|████▎     | Repairing epochs : 84/197 [00:01&lt;00:01,   79.15it/s]


 43%|████▎     | Repairing epochs : 85/197 [00:01&lt;00:01,   77.40it/s]


 44%|████▎     | Repairing epochs : 86/197 [00:01&lt;00:01,   75.38it/s]


 44%|████▍     | Repairing epochs : 87/197 [00:01&lt;00:01,   73.20it/s]


 45%|████▌     | Repairing epochs : 89/197 [00:01&lt;00:01,   74.54it/s]


 46%|████▌     | Repairing epochs : 91/197 [00:01&lt;00:01,   76.25it/s]


 47%|████▋     | Repairing epochs : 93/197 [00:01&lt;00:01,   76.41it/s]


 48%|████▊     | Repairing epochs : 95/197 [00:01&lt;00:01,   76.78it/s]


 49%|████▉     | Repairing epochs : 97/197 [00:01&lt;00:01,   77.14it/s]


 50%|█████     | Repairing epochs : 99/197 [00:01&lt;00:01,   77.42it/s]


 51%|█████     | Repairing epochs : 100/197 [00:01&lt;00:01,   76.68it/s]


 51%|█████▏    | Repairing epochs : 101/197 [00:01&lt;00:01,   74.66it/s]


 52%|█████▏    | Repairing epochs : 102/197 [00:01&lt;00:01,   72.80it/s]


 53%|█████▎    | Repairing epochs : 104/197 [00:01&lt;00:01,   71.32it/s]


 54%|█████▍    | Repairing epochs : 106/197 [00:01&lt;00:01,   71.67it/s]


 55%|█████▍    | Repairing epochs : 108/197 [00:01&lt;00:01,   73.32it/s]


 56%|█████▌    | Repairing epochs : 110/197 [00:01&lt;00:01,   73.48it/s]


 57%|█████▋    | Repairing epochs : 112/197 [00:01&lt;00:01,   73.04it/s]


 57%|█████▋    | Repairing epochs : 113/197 [00:01&lt;00:01,   70.64it/s]


 58%|█████▊    | Repairing epochs : 114/197 [00:01&lt;00:01,   68.38it/s]


 59%|█████▉    | Repairing epochs : 116/197 [00:01&lt;00:01,   68.68it/s]


 60%|█████▉    | Repairing epochs : 118/197 [00:01&lt;00:01,   70.28it/s]


 61%|██████    | Repairing epochs : 120/197 [00:01&lt;00:01,   70.76it/s]


 61%|██████▏   | Repairing epochs : 121/197 [00:01&lt;00:01,   70.32it/s]


 62%|██████▏   | Repairing epochs : 122/197 [00:01&lt;00:01,   68.70it/s]


 62%|██████▏   | Repairing epochs : 123/197 [00:01&lt;00:01,   67.10it/s]


 63%|██████▎   | Repairing epochs : 125/197 [00:01&lt;00:01,   67.80it/s]


 65%|██████▍   | Repairing epochs : 128/197 [00:01&lt;00:00,   70.98it/s]


 66%|██████▌   | Repairing epochs : 130/197 [00:01&lt;00:00,   71.49it/s]


 67%|██████▋   | Repairing epochs : 132/197 [00:01&lt;00:00,   72.04it/s]


 68%|██████▊   | Repairing epochs : 134/197 [00:01&lt;00:00,   72.61it/s]


 69%|██████▉   | Repairing epochs : 136/197 [00:01&lt;00:00,   72.98it/s]


 70%|███████   | Repairing epochs : 138/197 [00:01&lt;00:00,   73.45it/s]


 71%|███████   | Repairing epochs : 140/197 [00:01&lt;00:00,   73.78it/s]


 72%|███████▏  | Repairing epochs : 142/197 [00:01&lt;00:00,   74.24it/s]


 73%|███████▎  | Repairing epochs : 144/197 [00:01&lt;00:00,   74.65it/s]


 74%|███████▍  | Repairing epochs : 146/197 [00:01&lt;00:00,   74.99it/s]


 75%|███████▌  | Repairing epochs : 148/197 [00:01&lt;00:00,   74.98it/s]


 76%|███████▌  | Repairing epochs : 149/197 [00:01&lt;00:00,   73.81it/s]


 76%|███████▌  | Repairing epochs : 150/197 [00:02&lt;00:00,   71.84it/s]


 77%|███████▋  | Repairing epochs : 152/197 [00:02&lt;00:00,   70.70it/s]


 78%|███████▊  | Repairing epochs : 154/197 [00:02&lt;00:00,   70.50it/s]


 79%|███████▉  | Repairing epochs : 156/197 [00:02&lt;00:00,   72.16it/s]


 80%|████████  | Repairing epochs : 158/197 [00:02&lt;00:00,   72.64it/s]


 81%|████████  | Repairing epochs : 160/197 [00:02&lt;00:00,   73.02it/s]


 82%|████████▏ | Repairing epochs : 162/197 [00:02&lt;00:00,   74.39it/s]


 84%|████████▍ | Repairing epochs : 165/197 [00:02&lt;00:00,   77.33it/s]


 85%|████████▍ | Repairing epochs : 167/197 [00:02&lt;00:00,   77.45it/s]


 86%|████████▌ | Repairing epochs : 169/197 [00:02&lt;00:00,   77.72it/s]


 87%|████████▋ | Repairing epochs : 171/197 [00:02&lt;00:00,   77.68it/s]


 88%|████████▊ | Repairing epochs : 173/197 [00:02&lt;00:00,   77.77it/s]


 89%|████████▉ | Repairing epochs : 175/197 [00:02&lt;00:00,   77.85it/s]


 90%|████████▉ | Repairing epochs : 177/197 [00:02&lt;00:00,   77.85it/s]


 91%|█████████ | Repairing epochs : 179/197 [00:02&lt;00:00,   77.76it/s]


 92%|█████████▏| Repairing epochs : 181/197 [00:02&lt;00:00,   78.04it/s]


 93%|█████████▎| Repairing epochs : 183/197 [00:02&lt;00:00,   76.51it/s]


 93%|█████████▎| Repairing epochs : 184/197 [00:02&lt;00:00,   74.69it/s]


 94%|█████████▍| Repairing epochs : 185/197 [00:02&lt;00:00,   73.10it/s]


 94%|█████████▍| Repairing epochs : 186/197 [00:02&lt;00:00,   71.61it/s]


 95%|█████████▍| Repairing epochs : 187/197 [00:02&lt;00:00,   70.76it/s]


 96%|█████████▌| Repairing epochs : 189/197 [00:02&lt;00:00,   72.13it/s]


 96%|█████████▋| Repairing epochs : 190/197 [00:02&lt;00:00,   71.71it/s]


 97%|█████████▋| Repairing epochs : 191/197 [00:02&lt;00:00,   70.19it/s]


 97%|█████████▋| Repairing epochs : 192/197 [00:02&lt;00:00,   68.62it/s]


 98%|█████████▊| Repairing epochs : 193/197 [00:02&lt;00:00,   67.65it/s]


 99%|█████████▉| Repairing epochs : 195/197 [00:02&lt;00:00,   68.14it/s]


100%|██████████| Repairing epochs : 197/197 [00:02&lt;00:00,   68.70it/s]
100%|██████████| Repairing epochs : 197/197 [00:02&lt;00:00,   74.00it/s]




  0%|          | Fold : 0/10 [00:00&lt;?,       ?it/s]



 10%|█         | Fold : 1/10 [00:00&lt;00:01,    6.80it/s]



 20%|██        | Fold : 2/10 [00:00&lt;00:01,    7.08it/s]



 30%|███       | Fold : 3/10 [00:00&lt;00:00,    7.03it/s]



 40%|████      | Fold : 4/10 [00:00&lt;00:00,    7.13it/s]



 50%|█████     | Fold : 5/10 [00:00&lt;00:00,    7.20it/s]



 60%|██████    | Fold : 6/10 [00:00&lt;00:00,    7.17it/s]



 70%|███████   | Fold : 7/10 [00:00&lt;00:00,    7.21it/s]



 80%|████████  | Fold : 8/10 [00:01&lt;00:00,    7.23it/s]



 90%|█████████ | Fold : 9/10 [00:01&lt;00:00,    7.27it/s]



100%|██████████| Fold : 10/10 [00:01&lt;00:00,    7.25it/s]
100%|██████████| Fold : 10/10 [00:01&lt;00:00,    7.24it/s]


100%|██████████| n_interp : 3/3 [00:15&lt;00:00,    5.16s/it]
100%|██████████| n_interp : 3/3 [00:15&lt;00:00,    5.20s/it]




Estimated consensus=1.00 and n_interpolate=32



  0%|          | Repairing epochs : 0/197 [00:00&lt;?,       ?it/s]


  1%|          | Repairing epochs : 2/197 [00:00&lt;00:01,  124.72it/s]


  2%|▏         | Repairing epochs : 4/197 [00:00&lt;00:01,   97.48it/s]


  3%|▎         | Repairing epochs : 6/197 [00:00&lt;00:02,   89.77it/s]


  4%|▍         | Repairing epochs : 8/197 [00:00&lt;00:02,   87.00it/s]


  5%|▌         | Repairing epochs : 10/197 [00:00&lt;00:02,   84.81it/s]


  6%|▌         | Repairing epochs : 12/197 [00:00&lt;00:02,   83.30it/s]


  7%|▋         | Repairing epochs : 14/197 [00:00&lt;00:02,   82.51it/s]


  8%|▊         | Repairing epochs : 16/197 [00:00&lt;00:02,   83.15it/s]


  9%|▉         | Repairing epochs : 18/197 [00:00&lt;00:02,   82.90it/s]


 10%|█         | Repairing epochs : 20/197 [00:00&lt;00:02,   82.34it/s]


 11%|█         | Repairing epochs : 22/197 [00:00&lt;00:02,   82.45it/s]


 12%|█▏        | Repairing epochs : 24/197 [00:00&lt;00:02,   81.90it/s]


 13%|█▎        | Repairing epochs : 26/197 [00:00&lt;00:02,   81.95it/s]


 14%|█▍        | Repairing epochs : 28/197 [00:00&lt;00:02,   81.99it/s]


 15%|█▌        | Repairing epochs : 30/197 [00:00&lt;00:02,   81.92it/s]


 16%|█▌        | Repairing epochs : 32/197 [00:00&lt;00:02,   81.78it/s]


 17%|█▋        | Repairing epochs : 34/197 [00:00&lt;00:01,   81.76it/s]


 18%|█▊        | Repairing epochs : 36/197 [00:00&lt;00:01,   81.42it/s]


 19%|█▉        | Repairing epochs : 38/197 [00:00&lt;00:01,   81.11it/s]


 20%|██        | Repairing epochs : 40/197 [00:00&lt;00:01,   81.15it/s]


 21%|██▏       | Repairing epochs : 42/197 [00:00&lt;00:01,   81.27it/s]


 22%|██▏       | Repairing epochs : 44/197 [00:00&lt;00:01,   80.78it/s]


 23%|██▎       | Repairing epochs : 46/197 [00:00&lt;00:01,   82.56it/s]


 24%|██▍       | Repairing epochs : 48/197 [00:00&lt;00:01,   82.55it/s]


 25%|██▌       | Repairing epochs : 50/197 [00:00&lt;00:01,   82.29it/s]


 26%|██▋       | Repairing epochs : 52/197 [00:00&lt;00:01,   83.84it/s]


 27%|██▋       | Repairing epochs : 54/197 [00:00&lt;00:01,   83.24it/s]


 28%|██▊       | Repairing epochs : 56/197 [00:00&lt;00:01,   83.03it/s]


 29%|██▉       | Repairing epochs : 58/197 [00:00&lt;00:01,   83.09it/s]


 30%|███       | Repairing epochs : 60/197 [00:00&lt;00:01,   84.37it/s]


 31%|███▏      | Repairing epochs : 62/197 [00:00&lt;00:01,   85.61it/s]


 32%|███▏      | Repairing epochs : 64/197 [00:00&lt;00:01,   85.20it/s]


 34%|███▎      | Repairing epochs : 66/197 [00:00&lt;00:01,   84.87it/s]


 35%|███▍      | Repairing epochs : 68/197 [00:00&lt;00:01,   84.70it/s]


 36%|███▌      | Repairing epochs : 70/197 [00:00&lt;00:01,   86.25it/s]


 37%|███▋      | Repairing epochs : 72/197 [00:00&lt;00:01,   87.50it/s]


 38%|███▊      | Repairing epochs : 74/197 [00:00&lt;00:01,   86.95it/s]


 39%|███▊      | Repairing epochs : 76/197 [00:00&lt;00:01,   86.19it/s]


 40%|███▉      | Repairing epochs : 78/197 [00:00&lt;00:01,   84.76it/s]


 41%|████      | Repairing epochs : 80/197 [00:00&lt;00:01,   84.35it/s]


 42%|████▏     | Repairing epochs : 82/197 [00:00&lt;00:01,   83.85it/s]


 42%|████▏     | Repairing epochs : 83/197 [00:01&lt;00:01,   81.33it/s]


 43%|████▎     | Repairing epochs : 84/197 [00:01&lt;00:01,   79.06it/s]


 43%|████▎     | Repairing epochs : 85/197 [00:01&lt;00:01,   76.88it/s]


 44%|████▎     | Repairing epochs : 86/197 [00:01&lt;00:01,   74.84it/s]


 44%|████▍     | Repairing epochs : 87/197 [00:01&lt;00:01,   73.94it/s]


 45%|████▌     | Repairing epochs : 89/197 [00:01&lt;00:01,   75.73it/s]


 46%|████▌     | Repairing epochs : 91/197 [00:01&lt;00:01,   77.43it/s]


 47%|████▋     | Repairing epochs : 93/197 [00:01&lt;00:01,   77.43it/s]


 48%|████▊     | Repairing epochs : 95/197 [00:01&lt;00:01,   77.67it/s]


 49%|████▉     | Repairing epochs : 97/197 [00:01&lt;00:01,   77.99it/s]


 50%|█████     | Repairing epochs : 99/197 [00:01&lt;00:01,   78.27it/s]


 51%|█████     | Repairing epochs : 100/197 [00:01&lt;00:01,   77.42it/s]


 51%|█████▏    | Repairing epochs : 101/197 [00:01&lt;00:01,   75.48it/s]


 52%|█████▏    | Repairing epochs : 102/197 [00:01&lt;00:01,   73.30it/s]


 53%|█████▎    | Repairing epochs : 104/197 [00:01&lt;00:01,   72.80it/s]


 54%|█████▍    | Repairing epochs : 106/197 [00:01&lt;00:01,   72.99it/s]


 55%|█████▍    | Repairing epochs : 108/197 [00:01&lt;00:01,   74.60it/s]


 56%|█████▌    | Repairing epochs : 110/197 [00:01&lt;00:01,   74.74it/s]


 57%|█████▋    | Repairing epochs : 112/197 [00:01&lt;00:01,   74.92it/s]


 58%|█████▊    | Repairing epochs : 114/197 [00:01&lt;00:01,   74.72it/s]


 59%|█████▉    | Repairing epochs : 116/197 [00:01&lt;00:01,   74.78it/s]


 60%|█████▉    | Repairing epochs : 118/197 [00:01&lt;00:01,   76.22it/s]


 61%|██████    | Repairing epochs : 120/197 [00:01&lt;00:01,   75.34it/s]


 61%|██████▏   | Repairing epochs : 121/197 [00:01&lt;00:01,   73.72it/s]


 62%|██████▏   | Repairing epochs : 122/197 [00:01&lt;00:01,   72.07it/s]


 62%|██████▏   | Repairing epochs : 123/197 [00:01&lt;00:01,   71.16it/s]


 63%|██████▎   | Repairing epochs : 125/197 [00:01&lt;00:01,   71.70it/s]


 65%|██████▍   | Repairing epochs : 128/197 [00:01&lt;00:00,   74.77it/s]


 66%|██████▌   | Repairing epochs : 130/197 [00:01&lt;00:00,   75.06it/s]


 67%|██████▋   | Repairing epochs : 132/197 [00:01&lt;00:00,   75.31it/s]


 68%|██████▊   | Repairing epochs : 134/197 [00:01&lt;00:00,   75.67it/s]


 69%|██████▉   | Repairing epochs : 136/197 [00:01&lt;00:00,   75.76it/s]


 70%|██████▉   | Repairing epochs : 137/197 [00:01&lt;00:00,   73.98it/s]


 70%|███████   | Repairing epochs : 138/197 [00:01&lt;00:00,   72.89it/s]


 71%|███████   | Repairing epochs : 140/197 [00:01&lt;00:00,   73.24it/s]


 72%|███████▏  | Repairing epochs : 141/197 [00:01&lt;00:00,   72.78it/s]


 72%|███████▏  | Repairing epochs : 142/197 [00:01&lt;00:00,   70.92it/s]


 73%|███████▎  | Repairing epochs : 143/197 [00:01&lt;00:00,   68.75it/s]


 74%|███████▎  | Repairing epochs : 145/197 [00:01&lt;00:00,   69.41it/s]


 75%|███████▍  | Repairing epochs : 147/197 [00:01&lt;00:00,   71.15it/s]


 76%|███████▌  | Repairing epochs : 149/197 [00:01&lt;00:00,   71.52it/s]


 77%|███████▋  | Repairing epochs : 151/197 [00:01&lt;00:00,   73.17it/s]


 78%|███████▊  | Repairing epochs : 153/197 [00:01&lt;00:00,   74.89it/s]


 79%|███████▊  | Repairing epochs : 155/197 [00:02&lt;00:00,   75.08it/s]


 80%|███████▉  | Repairing epochs : 157/197 [00:02&lt;00:00,   76.72it/s]


 81%|████████  | Repairing epochs : 159/197 [00:02&lt;00:00,   76.88it/s]


 82%|████████▏ | Repairing epochs : 161/197 [00:02&lt;00:00,   76.32it/s]


 84%|████████▍ | Repairing epochs : 165/197 [00:02&lt;00:00,   80.65it/s]


 85%|████████▍ | Repairing epochs : 167/197 [00:02&lt;00:00,   80.55it/s]


 86%|████████▌ | Repairing epochs : 169/197 [00:02&lt;00:00,   80.66it/s]


 87%|████████▋ | Repairing epochs : 171/197 [00:02&lt;00:00,   80.38it/s]


 88%|████████▊ | Repairing epochs : 173/197 [00:02&lt;00:00,   80.33it/s]


 89%|████████▉ | Repairing epochs : 175/197 [00:02&lt;00:00,   80.22it/s]


 90%|████████▉ | Repairing epochs : 177/197 [00:02&lt;00:00,   79.99it/s]


 91%|█████████ | Repairing epochs : 179/197 [00:02&lt;00:00,   79.79it/s]


 92%|█████████▏| Repairing epochs : 181/197 [00:02&lt;00:00,   78.59it/s]


 93%|█████████▎| Repairing epochs : 183/197 [00:02&lt;00:00,   77.31it/s]


 93%|█████████▎| Repairing epochs : 184/197 [00:02&lt;00:00,   75.26it/s]


 94%|█████████▍| Repairing epochs : 185/197 [00:02&lt;00:00,   73.50it/s]


 94%|█████████▍| Repairing epochs : 186/197 [00:02&lt;00:00,   71.57it/s]


 95%|█████████▍| Repairing epochs : 187/197 [00:02&lt;00:00,   71.07it/s]


 96%|█████████▌| Repairing epochs : 189/197 [00:02&lt;00:00,   72.20it/s]


 96%|█████████▋| Repairing epochs : 190/197 [00:02&lt;00:00,   71.82it/s]


 97%|█████████▋| Repairing epochs : 191/197 [00:02&lt;00:00,   71.29it/s]


 97%|█████████▋| Repairing epochs : 192/197 [00:02&lt;00:00,   68.96it/s]


 98%|█████████▊| Repairing epochs : 193/197 [00:02&lt;00:00,   67.42it/s]


 98%|█████████▊| Repairing epochs : 194/197 [00:02&lt;00:00,   66.83it/s]


 99%|█████████▉| Repairing epochs : 196/197 [00:02&lt;00:00,   67.43it/s]
100%|██████████| Repairing epochs : 197/197 [00:02&lt;00:00,   75.50it/s]
No bad epochs were found for your data. Returning a copy of the data you wanted to clean. Interpolation may have been done.
</pre></div>
</div>
<p>We can visualize the cross validation curve over two variables</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  <span class="c1"># noqa</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>  <span class="c1"># noqa</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">patches</span>  <span class="c1"># noqa</span>
<span class="kn">from</span> <span class="nn">autoreject</span> <span class="kn">import</span> <span class="n">set_matplotlib_defaults</span>  <span class="c1"># noqa</span>

<span class="n">set_matplotlib_defaults</span><span class="p">(</span><a href="https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot" title="matplotlib.pyplot" class="sphx-glr-backref-module-matplotlib sphx-glr-backref-type-py-module"><span class="n">plt</span></a><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">loss</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ar</span><span class="o">.</span><span class="n">loss_</span></a><span class="p">[</span><span class="s1">&#39;eeg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># losses are stored by channel type.</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.matshow.html#matplotlib.pyplot.matshow" title="matplotlib.pyplot.matshow" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">matshow</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">loss</span><span class="o">.</span><span class="n">T</span></a> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.get_cmap.html#matplotlib.pyplot.get_cmap" title="matplotlib.pyplot.get_cmap" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span></a><span class="p">(</span><span class="s1">&#39;viridis&#39;</span><span class="p">))</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xticks.html#matplotlib.pyplot.xticks" title="matplotlib.pyplot.xticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xticks</span></a><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ar</span><span class="o">.</span><span class="n">consensus</span></a><span class="p">)),</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ar</span><span class="o">.</span><span class="n">consensus</span></a><span class="p">])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.yticks.html#matplotlib.pyplot.yticks" title="matplotlib.pyplot.yticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ar</span><span class="o">.</span><span class="n">n_interpolate</span></a><span class="p">)),</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ar</span><span class="o">.</span><span class="n">n_interpolate</span></a><span class="p">)</span>

<span class="c1"># Draw rectangle at location of best parameters</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.gca.html#matplotlib.pyplot.gca" title="matplotlib.pyplot.gca" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">gca</span></a><span class="p">()</span>
<a href="https://numpy.org/devdocs/reference/arrays.scalars.html#numpy.int64" title="numpy.int64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">idx</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/arrays.scalars.html#numpy.int64" title="numpy.int64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">jdx</span></a> <span class="o">=</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.unravel_index.html#numpy.unravel_index" title="numpy.unravel_index" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">loss</span></a><span class="o">.</span><span class="n">argmin</span><span class="p">(),</span> <a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">loss</span><span class="o">.</span><span class="n">shape</span></a><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.patches.Rectangle.html#matplotlib.patches.Rectangle" title="matplotlib.patches.Rectangle" class="sphx-glr-backref-module-matplotlib-patches sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rect</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.patches.Rectangle.html#matplotlib.patches.Rectangle" title="matplotlib.patches.Rectangle" class="sphx-glr-backref-module-matplotlib-patches sphx-glr-backref-type-py-class"><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span></a><span class="p">((</span><a href="https://numpy.org/devdocs/reference/arrays.scalars.html#numpy.int64" title="numpy.int64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">idx</span></a> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/arrays.scalars.html#numpy.int64" title="numpy.int64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">jdx</span></a> <span class="o">-</span> <span class="mf">0.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                         <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.add_patch.html#matplotlib.axes.Axes.add_patch" title="matplotlib.axes.Axes.add_patch" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span></a><span class="p">(</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.patches.Rectangle.html#matplotlib.patches.Rectangle" title="matplotlib.patches.Rectangle" class="sphx-glr-backref-module-matplotlib-patches sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rect</span></a><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axis.XAxis.set_ticks_position.html#matplotlib.axis.XAxis.set_ticks_position" title="matplotlib.axis.XAxis.set_ticks_position" class="sphx-glr-backref-module-matplotlib-axis sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span></a><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Consensus percentage $\kappa$&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.ylabel.html#matplotlib.pyplot.ylabel" title="matplotlib.pyplot.ylabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Max sensors interpolated $\rho$&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;Mean cross validation error (x 1e6)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar" title="matplotlib.pyplot.colorbar" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_visualize_bad_epochs_001.png" srcset="../_images/sphx_glr_plot_visualize_bad_epochs_001.png" alt="Mean cross validation error (x 1e6)" class = "sphx-glr-single-img"/><p>… and visualize the bad epochs and sensors. Bad sensors which have been
interpolated are in blue. Bad sensors which are not interpolated are in red.
Bad trials are also in red.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scalings</span></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="mf">40e-6</span><span class="p">)</span>
<a href="../generated/autoreject.RejectLog.html#autoreject.RejectLog.plot_epochs" title="autoreject.RejectLog.plot_epochs" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-method"><span class="n">reject_log</span><span class="o">.</span><span class="n">plot_epochs</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray" title="mne.EpochsArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">this_epoch</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scalings</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scalings</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_visualize_bad_epochs_002.png" srcset="../_images/sphx_glr_plot_visualize_bad_epochs_002.png" alt="plot visualize bad epochs" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;MNEBrowseFigure size 800x800 with 4 Axes&gt;
</pre></div>
</div>
<p>… and the epochs after cleaning with autoreject</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray.plot" title="mne.EpochsArray.plot" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">epochs_ar</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scalings</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scalings</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_visualize_bad_epochs_003.png" srcset="../_images/sphx_glr_plot_visualize_bad_epochs_003.png" alt="plot visualize bad epochs" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/circleci/project/examples/plot_visualize_bad_epochs.py:144: FutureWarning: The current default events=None is deprecated and will change to events=True in MNE 1.6. Set events=False to suppress this warning.
  epochs_ar.plot(scalings=scalings)

&lt;MNEBrowseFigure size 800x800 with 4 Axes&gt;
</pre></div>
</div>
<p>The epochs dropped by autoreject are also stored in epochs.drop_log</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray.plot_drop_log" title="mne.EpochsArray.plot_drop_log" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">epochs_ar</span><span class="o">.</span><span class="n">plot_drop_log</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_visualize_bad_epochs_004.png" srcset="../_images/sphx_glr_plot_visualize_bad_epochs_004.png" alt="0 of 197 epochs removed (0.0%)" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 640x480 with 1 Axes&gt;
</pre></div>
</div>
<p>Finally, the evoked before and after autoreject, for sanity check. We use
the <code class="docutils literal notranslate"><span class="pre">spatial_colors</span></code> argument from MNE as it allows us to see that
the eyeblinks have not yet been cleaned but the bad channels have been
repaired.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ylim</span></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray.average" title="mne.EpochsArray.average" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">epochs</span><span class="o">.</span><span class="n">average</span></a><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ylim</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ylim</span></a><span class="p">,</span> <span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="https://mne.tools/dev/generated/mne.EpochsArray.html#mne.EpochsArray.average" title="mne.EpochsArray.average" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">epochs_ar</span><span class="o">.</span><span class="n">average</span></a><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ylim</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ylim</span></a><span class="p">,</span> <span class="n">spatial_colors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../_images/sphx_glr_plot_visualize_bad_epochs_005.png" srcset="../_images/sphx_glr_plot_visualize_bad_epochs_005.png" alt="EEG (70 channels)" class = "sphx-glr-multi-img"/></li>
<li><img src="../_images/sphx_glr_plot_visualize_bad_epochs_006.png" srcset="../_images/sphx_glr_plot_visualize_bad_epochs_006.png" alt="EEG (70 channels)" class = "sphx-glr-multi-img"/></li>
</ul>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).

&lt;Figure size 640x300 with 2 Axes&gt;
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (1 minutes 43.303 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-visualize-bad-epochs-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/343ec55e666b7130c35f6a4de928c39a/plot_visualize_bad_epochs.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_visualize_bad_epochs.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/9d3e69826a86abb695c16aa2b83fb4a2/plot_visualize_bad_epochs.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_visualize_bad_epochs.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="plot_autoreject_workflow.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Preprocessing workflow with <code class="docutils literal notranslate"><span class="pre">autoreject</span></code> and ICA</p>
      </div>
    </a>
    <a class="right-next"
       href="../explanation.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Explanation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2016-2023, autoreject developers. Last updated on 2023-11-02.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>