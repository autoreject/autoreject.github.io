
<!DOCTYPE html>


<html lang="en" data-theme="auto">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Preprocessing workflow with autoreject and ICA &#8212; autoreject 0.5.dev2 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "auto";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'auto_examples/plot_autoreject_workflow';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://raw.githubusercontent.com/autoreject/autoreject/master/doc/_static/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'dev';
        </script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Visualize bad sensors per trial" href="plot_visualize_bad_epochs.html" />
    <link rel="prev" title="Detect bad sensors using RANSAC" href="plot_ransac.html" />
    <link rel="canonical" href="https://autoreject.github.io/stable/index.html" />
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <script type="text/javascript" src="../_static/scrollfix.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="auto">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    <p class="title logo__title">autoreject 0.5.dev2 documentation</p>
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../explanation.html">
                        Explanation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../faq.html">
                        FAQ
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../whats_new.html">
                        What's new
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button type="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-bs-toggle="dropdown">
      dev  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div class="version-switcher__menu dropdown-menu list-group-flush py-0">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Quick Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/autoreject/autoreject" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../explanation.html">
                        Explanation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../faq.html">
                        FAQ
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../whats_new.html">
                        What's new
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button type="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-bs-toggle="dropdown">
      dev  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div class="version-switcher__menu dropdown-menu list-group-flush py-0">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Quick Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/autoreject/autoreject" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="plot_estimate_global_reject.html">Find global rejection threshold</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_channel_thresholds.html">Plot channel-level thresholds</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_auto_repair.html">Automatically repair epochs</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_global_reject.html">Plotting the cross-validation curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_ransac.html">Detect bad sensors using RANSAC</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Preprocessing workflow with <code class="docutils literal notranslate"><span class="pre">autoreject</span></code> and ICA</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_visualize_bad_epochs.html">Visualize bad sensors per trial</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Examples Gallery</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Preprocessing workflow with <code class="docutils literal notranslate"><span class="pre">autoreject</span></code> and ICA</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-plot-autoreject-workflow-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="preprocessing-workflow-with-autoreject-and-ica">
<span id="plot-autoreject-workflow"></span><span id="sphx-glr-auto-examples-plot-autoreject-workflow-py"></span><h1>Preprocessing workflow with <code class="docutils literal notranslate"><span class="pre">autoreject</span></code> and ICA<a class="headerlink" href="#preprocessing-workflow-with-autoreject-and-ica" title="Permalink to this heading">#</a></h1>
<p>This example demonstrates how to visualize data when preprocessing
with <a class="reference internal" href="../api.html#module-autoreject" title="autoreject"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autoreject</span></code></a> and discusses decisions about when and which
other preprocessing steps to use in combination.</p>
<p><strong>tldr</strong>: We recommend that you first highpass filter the data,
then run autoreject (local) and supply the bad epochs detected by it
to the ICA algorithm for a robust fit, and finally run
autoreject (local) again.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Author: Alex Rockhill &lt;aprockhill@mailbox.org&gt;</span>
<span class="c1">#         Mainak Jas &lt;mjas@mgh.harvard.edu&gt;</span>
<span class="c1">#         Apoorva Karekal &lt;apoorvak@uoregon.edu&gt;</span>
<span class="c1">#</span>
<span class="c1"># License: BSD-3-Clause</span>

<span class="c1"># sphinx_gallery_thumbnail_number = 9</span>
</pre></div>
</div>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#autoreject-without-any-other-preprocessing" id="id1">Autoreject without any other preprocessing</a></p></li>
<li><p><a class="reference internal" href="#autoreject-with-high-pass-filter" id="id2">Autoreject with high-pass filter</a></p></li>
<li><p><a class="reference internal" href="#ica" id="id3">ICA</a></p></li>
<li><p><a class="reference internal" href="#autoreject-with-highpass-filter-and-ica" id="id4">Autoreject with highpass filter and ICA</a></p></li>
</ul>
</nav>
<p>First, we download resting-state EEG data from a Parkinson’s patient
from OpenNeuro. We will do this using <code class="docutils literal notranslate"><span class="pre">openneuro-py</span></code> which can be
installed with the command <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">openneuro-py</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">openneuro</span>

<span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">import</span> <span class="nn">autoreject</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a> <span class="o">=</span> <span class="s1">&#39;ds002778&#39;</span>  <span class="c1"># The id code on OpenNeuro for this example dataset</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject_id</span></a> <span class="o">=</span> <span class="s1">&#39;pd14&#39;</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_dir</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3/library/os.path.html#os.path.dirname" title="os.path.dirname" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span></a><span class="p">(</span><span class="n">autoreject</span><span class="o">.</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;examples&#39;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">)</span>
<a href="https://docs.python.org/3/library/os.html#os.makedirs" title="os.makedirs" class="sphx-glr-backref-module-os sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_dir</span></a><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">openneuro</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataset</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_dir</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_dir</span></a><span class="p">,</span>
                   <span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;sub-</span><span class="si">{</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject_id</span></a><span class="si">}</span><span class="s1">/ses-off&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Hello! This is openneuro-py 2022.4.0. Great to see you!

      Please report problems and bugs at
      https://github.com/hoechenberger/openneuro-py/issues

Preparing to download ds002778 ...

Traversing directories for ds002778: 0 entities [00:00, ? entities/s]
Traversing directories for ds002778: 7 entities [00:00, 34.64 entities/s]
Traversing directories for ds002778: 11 entities [00:00,  9.48 entities/s]
Traversing directories for ds002778: 13 entities [00:01,  7.89 entities/s]
Traversing directories for ds002778: 15 entities [00:01,  6.89 entities/s]
Traversing directories for ds002778: 16 entities [00:01,  6.53 entities/s]
Traversing directories for ds002778: 17 entities [00:02,  6.28 entities/s]
Traversing directories for ds002778: 18 entities [00:02,  6.00 entities/s]
Traversing directories for ds002778: 19 entities [00:02,  5.77 entities/s]
Traversing directories for ds002778: 20 entities [00:02,  5.58 entities/s]
Traversing directories for ds002778: 21 entities [00:03,  2.93 entities/s]
Traversing directories for ds002778: 22 entities [00:03,  3.33 entities/s]
Traversing directories for ds002778: 23 entities [00:03,  3.70 entities/s]
Traversing directories for ds002778: 24 entities [00:04,  4.42 entities/s]
Traversing directories for ds002778: 25 entities [00:04,  4.54 entities/s]
Traversing directories for ds002778: 27 entities [00:04,  5.35 entities/s]
Traversing directories for ds002778: 28 entities [00:04,  6.03 entities/s]
Traversing directories for ds002778: 29 entities [00:04,  5.77 entities/s]
Traversing directories for ds002778: 30 entities [00:05,  5.09 entities/s]
Traversing directories for ds002778: 36 entities [00:05, 12.01 entities/s]
Traversing directories for ds002778: 38 entities [00:05, 10.51 entities/s]
Traversing directories for ds002778: 43 entities [00:05, 12.87 entities/s]
Traversing directories for ds002778: 45 entities [00:06, 10.77 entities/s]
Traversing directories for ds002778: 47 entities [00:06,  9.65 entities/s]
Traversing directories for ds002778: 49 entities [00:06,  8.28 entities/s]
Traversing directories for ds002778: 51 entities [00:07,  7.72 entities/s]
Traversing directories for ds002778: 52 entities [00:07,  7.97 entities/s]
Traversing directories for ds002778: 53 entities [00:07,  7.13 entities/s]
Traversing directories for ds002778: 55 entities [00:07,  7.07 entities/s]
Traversing directories for ds002778: 57 entities [00:07,  7.05 entities/s]
Traversing directories for ds002778: 59 entities [00:08,  7.02 entities/s]
Traversing directories for ds002778: 61 entities [00:08,  6.85 entities/s]
Traversing directories for ds002778: 63 entities [00:08,  6.92 entities/s]
Traversing directories for ds002778: 64 entities [00:08,  7.15 entities/s]
Retrieving up to 12 files (5 concurrent downloads).

Skipping participants.json: already downloaded.: 100%|##########| 1.24k/1.24k [00:00&lt;?, ?B/s]


Skipping participants.tsv: already downloaded.: 100%|##########| 1.62k/1.62k [00:00&lt;?, ?B/s]


Skipping sub-pd14_ses-off_scans.tsv: already downloaded.: 100%|##########| 76.0/76.0 [00:00&lt;?, ?B/s]


Skipping sub-pd14_ses-off_task-rest_beh.tsv: already downloaded.: 100%|##########| 10.0/10.0 [00:00&lt;?, ?B/s]


Re-downloading CHANGES: file size mismatch.: 0.00B [00:00, ?B/s]


Re-downloading README: file size mismatch.: 0.00B [00:00, ?B/s]


Re-downloading dataset_description.json: file size mismatch.: 0.00B [00:00, ?B/s]

Re-downloading sub-pd14_ses-off_task-rest_beh.json: file size mismatch.: 0.00B [00:00, ?B/s]


Skipping sub-pd14_ses-off_task-rest_channels.tsv: already downloaded.: 100%|##########| 2.22k/2.22k [00:00&lt;?, ?B/s]






Skipping sub-pd14_ses-off_task-rest_eeg.json: already downloaded.: 100%|##########| 471/471 [00:00&lt;?, ?B/s]


Skipping sub-pd14_ses-off_task-rest_events.tsv: already downloaded.: 100%|##########| 65.0/65.0 [00:00&lt;?, ?B/s]


Skipping sub-pd14_ses-off_task-rest_eeg.bdf: already downloaded.: 100%|##########| 17.5M/17.5M [00:00&lt;?, ?B/s]

Finished downloading ds002778.

Please enjoy your brains.
</pre></div>
</div>
<p>We will now load in the raw data from the bdf file downloaded from OpenNeuro
and, since this is resting-state data without any events, make regularly
spaced events with which to epoch the raw data. In the averaged plot,
we can see that there may be some eyeblink
artifact contamination but, overall, the data is typical of
resting-state EEG.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw_fname</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_dir</span></a><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;sub-</span><span class="si">{</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subject_id</span></a><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;ses-off&#39;</span><span class="p">,</span> <span class="s1">&#39;eeg&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;sub-pd14_ses-off_task-rest_eeg.bdf&#39;</span><span class="p">)</span>
<span class="n">raw</span> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.io.read_raw_bdf.html#mne.io.read_raw_bdf" title="mne.io.read_raw_bdf" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_bdf</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw_fname</span></a><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="https://mne.tools/dev/generated/mne.channels.DigMontage.html#mne.channels.DigMontage" title="mne.channels.DigMontage" class="sphx-glr-backref-module-mne-channels sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dig_montage</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.channels.make_standard_montage.html#mne.channels.make_standard_montage" title="mne.channels.make_standard_montage" class="sphx-glr-backref-module-mne-channels sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">make_standard_montage</span></a><span class="p">(</span><span class="s1">&#39;biosemi32&#39;</span><span class="p">)</span>
<span class="n">raw</span><span class="o">.</span><span class="n">drop_channels</span><span class="p">([</span><span class="n">ch</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">raw</span><span class="o">.</span><span class="n">ch_names</span>
                   <span class="k">if</span> <span class="n">ch</span> <span class="ow">not</span> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dig_montage</span><span class="o">.</span><span class="n">ch_names</span></a><span class="p">])</span>
<span class="n">raw</span><span class="o">.</span><span class="n">set_montage</span><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.channels.DigMontage.html#mne.channels.DigMontage" title="mne.channels.DigMontage" class="sphx-glr-backref-module-mne-channels sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dig_montage</span></a><span class="p">)</span>  <span class="c1"># use the standard montage</span>
<a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.make_fixed_length_epochs.html#mne.make_fixed_length_epochs" title="mne.make_fixed_length_epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">make_fixed_length_epochs</span></a><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># plot the data</span>
<a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs.average" title="mne.Epochs.average" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">epochs</span><span class="o">.</span><span class="n">average</span></a><span class="p">()</span><span class="o">.</span><span class="n">detrend</span><span class="p">()</span><span class="o">.</span><span class="n">plot_joint</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_autoreject_workflow_001.png" srcset="../_images/sphx_glr_plot_autoreject_workflow_001.png" alt="0.006 s, 0.979 s, 2.699 s" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Extracting EDF parameters from /home/circleci/project/examples/ds002778/sub-pd14/ses-off/eeg/sub-pd14_ses-off_task-rest_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading 0 ... 149503  =      0.000 ...   291.998 secs...
Not setting metadata
97 matching events found
No baseline correction applied
0 projection items activated
Using data from preloaded Raw for 97 events and 1536 original time points ...
0 bad epochs dropped
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
No projector specified for this dataset. Please consider the method self.add_proj.
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).

&lt;Figure size 800x420 with 7 Axes&gt;
</pre></div>
</div>
<section id="autoreject-without-any-other-preprocessing">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Autoreject without any other preprocessing</a><a class="headerlink" href="#autoreject-without-any-other-preprocessing" title="Permalink to this heading">#</a></h2>
<p>Now, we’ll naively apply autoreject as our first preprocessing step.</p>
<p>As we can see in the plot of the rejected epochs, there are many eyeblinks
that caused the epoch to be dropped. This resulted in a lot of the data
being lost.</p>
<p>The data looks fairly clean already and we don’t want to interpolate
more than a few sensors since we only have 32 to start, so the
number of channels to interpolate was set to check some low numbers</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject" title="autoreject.AutoReject" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ar</span></a> <span class="o">=</span> <a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject" title="autoreject.AutoReject" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class"><span class="n">autoreject</span><span class="o">.</span><span class="n">AutoReject</span></a><span class="p">(</span><span class="n">n_interpolate</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
                           <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject.fit" title="autoreject.AutoReject.fit" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-method"><span class="n">ar</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>  <span class="c1"># fit on a few epochs to save time</span>
<a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_ar</span></a><span class="p">,</span> <a href="../generated/autoreject.RejectLog.html#autoreject.RejectLog" title="autoreject.RejectLog" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reject_log</span></a> <span class="o">=</span> <a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject.transform" title="autoreject.AutoReject.transform" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-method"><span class="n">ar</span><span class="o">.</span><span class="n">transform</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">,</span> <span class="n">return_log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Running autoreject on ch_type=eeg

  0%|          | Creating augmented epochs : 0/32 [00:00&lt;?,       ?it/s]
  6%|6         | Creating augmented epochs : 2/32 [00:00&lt;00:00,   77.71it/s]
 12%|#2        | Creating augmented epochs : 4/32 [00:00&lt;00:00,   71.39it/s]
 16%|#5        | Creating augmented epochs : 5/32 [00:00&lt;00:00,   68.77it/s]
 22%|##1       | Creating augmented epochs : 7/32 [00:00&lt;00:00,   68.81it/s]
 28%|##8       | Creating augmented epochs : 9/32 [00:00&lt;00:00,   67.56it/s]
 34%|###4      | Creating augmented epochs : 11/32 [00:00&lt;00:00,   67.45it/s]
 41%|####      | Creating augmented epochs : 13/32 [00:00&lt;00:00,   67.26it/s]
 44%|####3     | Creating augmented epochs : 14/32 [00:00&lt;00:00,   66.80it/s]
 50%|#####     | Creating augmented epochs : 16/32 [00:00&lt;00:00,   66.50it/s]
 56%|#####6    | Creating augmented epochs : 18/32 [00:00&lt;00:00,   66.50it/s]
 59%|#####9    | Creating augmented epochs : 19/32 [00:00&lt;00:00,   66.10it/s]
 66%|######5   | Creating augmented epochs : 21/32 [00:00&lt;00:00,   66.11it/s]
 69%|######8   | Creating augmented epochs : 22/32 [00:00&lt;00:00,   65.77it/s]
 75%|#######5  | Creating augmented epochs : 24/32 [00:00&lt;00:00,   66.01it/s]
 81%|########1 | Creating augmented epochs : 26/32 [00:00&lt;00:00,   65.97it/s]
 88%|########7 | Creating augmented epochs : 28/32 [00:00&lt;00:00,   65.83it/s]
 94%|#########3| Creating augmented epochs : 30/32 [00:00&lt;00:00,   65.77it/s]
100%|##########| Creating augmented epochs : 32/32 [00:00&lt;00:00,   65.56it/s]
100%|##########| Creating augmented epochs : 32/32 [00:00&lt;00:00,   65.81it/s]

  0%|          | Computing thresholds ... : 0/32 [00:00&lt;?,       ?it/s]
  3%|3         | Computing thresholds ... : 1/32 [00:00&lt;00:14,    2.21it/s]
  6%|6         | Computing thresholds ... : 2/32 [00:00&lt;00:13,    2.20it/s]
  9%|9         | Computing thresholds ... : 3/32 [00:01&lt;00:13,    2.20it/s]
 12%|#2        | Computing thresholds ... : 4/32 [00:01&lt;00:12,    2.20it/s]
 16%|#5        | Computing thresholds ... : 5/32 [00:02&lt;00:12,    2.21it/s]
 19%|#8        | Computing thresholds ... : 6/32 [00:02&lt;00:11,    2.21it/s]
 22%|##1       | Computing thresholds ... : 7/32 [00:03&lt;00:11,    2.20it/s]
 25%|##5       | Computing thresholds ... : 8/32 [00:03&lt;00:10,    2.20it/s]
 28%|##8       | Computing thresholds ... : 9/32 [00:04&lt;00:10,    2.20it/s]
 31%|###1      | Computing thresholds ... : 10/32 [00:04&lt;00:09,    2.20it/s]
 34%|###4      | Computing thresholds ... : 11/32 [00:05&lt;00:09,    2.20it/s]
 38%|###7      | Computing thresholds ... : 12/32 [00:05&lt;00:09,    2.20it/s]
 41%|####      | Computing thresholds ... : 13/32 [00:05&lt;00:08,    2.20it/s]
 44%|####3     | Computing thresholds ... : 14/32 [00:06&lt;00:08,    2.20it/s]
 47%|####6     | Computing thresholds ... : 15/32 [00:06&lt;00:07,    2.20it/s]
 50%|#####     | Computing thresholds ... : 16/32 [00:07&lt;00:07,    2.20it/s]
 53%|#####3    | Computing thresholds ... : 17/32 [00:07&lt;00:06,    2.20it/s]
 56%|#####6    | Computing thresholds ... : 18/32 [00:08&lt;00:06,    2.21it/s]
 59%|#####9    | Computing thresholds ... : 19/32 [00:08&lt;00:05,    2.21it/s]
 62%|######2   | Computing thresholds ... : 20/32 [00:09&lt;00:05,    2.21it/s]
 66%|######5   | Computing thresholds ... : 21/32 [00:09&lt;00:04,    2.21it/s]
 69%|######8   | Computing thresholds ... : 22/32 [00:09&lt;00:04,    2.21it/s]
 72%|#######1  | Computing thresholds ... : 23/32 [00:10&lt;00:04,    2.21it/s]
 75%|#######5  | Computing thresholds ... : 24/32 [00:10&lt;00:03,    2.21it/s]
 78%|#######8  | Computing thresholds ... : 25/32 [00:11&lt;00:03,    2.21it/s]
 81%|########1 | Computing thresholds ... : 26/32 [00:11&lt;00:02,    2.21it/s]
 84%|########4 | Computing thresholds ... : 27/32 [00:12&lt;00:02,    2.21it/s]
 88%|########7 | Computing thresholds ... : 28/32 [00:12&lt;00:01,    2.21it/s]
 91%|######### | Computing thresholds ... : 29/32 [00:13&lt;00:01,    2.21it/s]
 94%|#########3| Computing thresholds ... : 30/32 [00:13&lt;00:00,    2.21it/s]
 97%|#########6| Computing thresholds ... : 31/32 [00:14&lt;00:00,    2.21it/s]
100%|##########| Computing thresholds ... : 32/32 [00:14&lt;00:00,    2.21it/s]
100%|##########| Computing thresholds ... : 32/32 [00:14&lt;00:00,    2.21it/s]



  0%|          | Repairing epochs : 0/20 [00:00&lt;?,       ?it/s]


 20%|##        | Repairing epochs : 4/20 [00:00&lt;00:00,  241.55it/s]


 40%|####      | Repairing epochs : 8/20 [00:00&lt;00:00,  236.79it/s]


 60%|######    | Repairing epochs : 12/20 [00:00&lt;00:00,  235.83it/s]


 80%|########  | Repairing epochs : 16/20 [00:00&lt;00:00,  236.43it/s]


100%|##########| Repairing epochs : 20/20 [00:00&lt;00:00,  238.19it/s]
100%|##########| Repairing epochs : 20/20 [00:00&lt;00:00,  237.18it/s]


  0%|          | n_interp : 0/4 [00:00&lt;?,       ?it/s]


  0%|          | Repairing epochs : 0/20 [00:00&lt;?,       ?it/s]


 20%|##        | Repairing epochs : 4/20 [00:00&lt;00:00,  228.09it/s]


 35%|###5      | Repairing epochs : 7/20 [00:00&lt;00:00,  171.13it/s]


 50%|#####     | Repairing epochs : 10/20 [00:00&lt;00:00,  155.35it/s]


 70%|#######   | Repairing epochs : 14/20 [00:00&lt;00:00,  173.69it/s]


 80%|########  | Repairing epochs : 16/20 [00:00&lt;00:00,  140.71it/s]


 90%|######### | Repairing epochs : 18/20 [00:00&lt;00:00,  134.71it/s]
100%|##########| Repairing epochs : 20/20 [00:00&lt;00:00,  143.38it/s]




  0%|          | Fold : 0/10 [00:00&lt;?,       ?it/s]



 10%|#         | Fold : 1/10 [00:00&lt;00:01,    8.98it/s]



 20%|##        | Fold : 2/10 [00:00&lt;00:00,   11.34it/s]



 30%|###       | Fold : 3/10 [00:00&lt;00:00,   12.42it/s]



 40%|####      | Fold : 4/10 [00:00&lt;00:00,   13.05it/s]



 50%|#####     | Fold : 5/10 [00:00&lt;00:00,   13.44it/s]



 60%|######    | Fold : 6/10 [00:00&lt;00:00,   13.71it/s]



 70%|#######   | Fold : 7/10 [00:00&lt;00:00,   13.92it/s]



 80%|########  | Fold : 8/10 [00:00&lt;00:00,   14.05it/s]



 90%|######### | Fold : 9/10 [00:00&lt;00:00,   14.13it/s]



100%|##########| Fold : 10/10 [00:00&lt;00:00,   14.13it/s]
100%|##########| Fold : 10/10 [00:00&lt;00:00,   13.96it/s]


 25%|##5       | n_interp : 1/4 [00:00&lt;00:02,    1.16it/s]


  0%|          | Repairing epochs : 0/20 [00:00&lt;?,       ?it/s]


 20%|##        | Repairing epochs : 4/20 [00:00&lt;00:00,  220.62it/s]


 35%|###5      | Repairing epochs : 7/20 [00:00&lt;00:00,  167.67it/s]


 50%|#####     | Repairing epochs : 10/20 [00:00&lt;00:00,  152.31it/s]


 70%|#######   | Repairing epochs : 14/20 [00:00&lt;00:00,  171.06it/s]


 80%|########  | Repairing epochs : 16/20 [00:00&lt;00:00,  140.24it/s]


 90%|######### | Repairing epochs : 18/20 [00:00&lt;00:00,  132.20it/s]
100%|##########| Repairing epochs : 20/20 [00:00&lt;00:00,  140.75it/s]




  0%|          | Fold : 0/10 [00:00&lt;?,       ?it/s]



 10%|#         | Fold : 1/10 [00:00&lt;00:00,    9.75it/s]



 20%|##        | Fold : 2/10 [00:00&lt;00:00,   11.92it/s]



 30%|###       | Fold : 3/10 [00:00&lt;00:00,   12.94it/s]



 40%|####      | Fold : 4/10 [00:00&lt;00:00,   13.54it/s]



 50%|#####     | Fold : 5/10 [00:00&lt;00:00,   13.93it/s]



 60%|######    | Fold : 6/10 [00:00&lt;00:00,   14.19it/s]



 70%|#######   | Fold : 7/10 [00:00&lt;00:00,   14.39it/s]



 80%|########  | Fold : 8/10 [00:00&lt;00:00,   14.54it/s]



 90%|######### | Fold : 9/10 [00:00&lt;00:00,   14.65it/s]



100%|##########| Fold : 10/10 [00:00&lt;00:00,   14.74it/s]
100%|##########| Fold : 10/10 [00:00&lt;00:00,   14.55it/s]


 50%|#####     | n_interp : 2/4 [00:01&lt;00:01,    1.17it/s]


  0%|          | Repairing epochs : 0/20 [00:00&lt;?,       ?it/s]


 20%|##        | Repairing epochs : 4/20 [00:00&lt;00:00,  222.24it/s]


 35%|###5      | Repairing epochs : 7/20 [00:00&lt;00:00,  167.46it/s]


 50%|#####     | Repairing epochs : 10/20 [00:00&lt;00:00,  152.43it/s]


 70%|#######   | Repairing epochs : 14/20 [00:00&lt;00:00,  171.17it/s]


 80%|########  | Repairing epochs : 16/20 [00:00&lt;00:00,  138.94it/s]


 90%|######### | Repairing epochs : 18/20 [00:00&lt;00:00,  131.20it/s]
100%|##########| Repairing epochs : 20/20 [00:00&lt;00:00,  139.44it/s]




  0%|          | Fold : 0/10 [00:00&lt;?,       ?it/s]



 10%|#         | Fold : 1/10 [00:00&lt;00:00,    9.98it/s]



 20%|##        | Fold : 2/10 [00:00&lt;00:00,   12.16it/s]



 30%|###       | Fold : 3/10 [00:00&lt;00:00,   13.13it/s]



 40%|####      | Fold : 4/10 [00:00&lt;00:00,   13.68it/s]



 50%|#####     | Fold : 5/10 [00:00&lt;00:00,   14.02it/s]



 60%|######    | Fold : 6/10 [00:00&lt;00:00,   14.17it/s]



 70%|#######   | Fold : 7/10 [00:00&lt;00:00,   14.38it/s]



 80%|########  | Fold : 8/10 [00:00&lt;00:00,   14.53it/s]



 90%|######### | Fold : 9/10 [00:00&lt;00:00,   14.65it/s]



100%|##########| Fold : 10/10 [00:00&lt;00:00,   14.73it/s]
100%|##########| Fold : 10/10 [00:00&lt;00:00,   14.55it/s]


 75%|#######5  | n_interp : 3/4 [00:02&lt;00:00,    1.18it/s]


  0%|          | Repairing epochs : 0/20 [00:00&lt;?,       ?it/s]


 20%|##        | Repairing epochs : 4/20 [00:00&lt;00:00,  222.61it/s]


 35%|###5      | Repairing epochs : 7/20 [00:00&lt;00:00,  167.09it/s]


 50%|#####     | Repairing epochs : 10/20 [00:00&lt;00:00,  152.80it/s]


 70%|#######   | Repairing epochs : 14/20 [00:00&lt;00:00,  171.89it/s]


 80%|########  | Repairing epochs : 16/20 [00:00&lt;00:00,  140.87it/s]


 90%|######### | Repairing epochs : 18/20 [00:00&lt;00:00,  133.01it/s]
100%|##########| Repairing epochs : 20/20 [00:00&lt;00:00,  141.77it/s]




  0%|          | Fold : 0/10 [00:00&lt;?,       ?it/s]



 10%|#         | Fold : 1/10 [00:00&lt;00:00,   10.52it/s]



 20%|##        | Fold : 2/10 [00:00&lt;00:00,   13.07it/s]



 30%|###       | Fold : 3/10 [00:00&lt;00:00,   14.12it/s]



 40%|####      | Fold : 4/10 [00:00&lt;00:00,   14.70it/s]



 50%|#####     | Fold : 5/10 [00:00&lt;00:00,   15.06it/s]



 60%|######    | Fold : 6/10 [00:00&lt;00:00,   15.25it/s]



 70%|#######   | Fold : 7/10 [00:00&lt;00:00,   15.40it/s]



 80%|########  | Fold : 8/10 [00:00&lt;00:00,   15.57it/s]



 90%|######### | Fold : 9/10 [00:00&lt;00:00,   15.70it/s]



100%|##########| Fold : 10/10 [00:00&lt;00:00,   15.82it/s]
100%|##########| Fold : 10/10 [00:00&lt;00:00,   15.63it/s]


100%|##########| n_interp : 4/4 [00:03&lt;00:00,    1.20it/s]
100%|##########| n_interp : 4/4 [00:03&lt;00:00,    1.20it/s]




Estimated consensus=0.10 and n_interpolate=1



  0%|          | Repairing epochs : 0/97 [00:00&lt;?,       ?it/s]


  4%|4         | Repairing epochs : 4/97 [00:00&lt;00:00,  221.68it/s]


  7%|7         | Repairing epochs : 7/97 [00:00&lt;00:00,  166.61it/s]


 10%|#         | Repairing epochs : 10/97 [00:00&lt;00:00,  151.37it/s]


 14%|#4        | Repairing epochs : 14/97 [00:00&lt;00:00,  169.95it/s]


 16%|#6        | Repairing epochs : 16/97 [00:00&lt;00:00,  139.18it/s]


 19%|#8        | Repairing epochs : 18/97 [00:00&lt;00:00,  133.00it/s]


 23%|##2       | Repairing epochs : 22/97 [00:00&lt;00:00,  146.59it/s]


 25%|##4       | Repairing epochs : 24/97 [00:00&lt;00:00,  140.16it/s]


 28%|##7       | Repairing epochs : 27/97 [00:00&lt;00:00,  138.45it/s]


 30%|##9       | Repairing epochs : 29/97 [00:00&lt;00:00,  134.45it/s]


 32%|###1      | Repairing epochs : 31/97 [00:00&lt;00:00,  131.33it/s]


 36%|###6      | Repairing epochs : 35/97 [00:00&lt;00:00,  133.34it/s]


 38%|###8      | Repairing epochs : 37/97 [00:00&lt;00:00,  130.37it/s]


 40%|####      | Repairing epochs : 39/97 [00:00&lt;00:00,  128.08it/s]


 44%|####4     | Repairing epochs : 43/97 [00:00&lt;00:00,  129.96it/s]


 48%|####8     | Repairing epochs : 47/97 [00:00&lt;00:00,  131.60it/s]


 53%|#####2    | Repairing epochs : 51/97 [00:00&lt;00:00,  132.53it/s]


 56%|#####5    | Repairing epochs : 54/97 [00:00&lt;00:00,  132.00it/s]


 58%|#####7    | Repairing epochs : 56/97 [00:00&lt;00:00,  130.04it/s]


 60%|#####9    | Repairing epochs : 58/97 [00:00&lt;00:00,  128.23it/s]


 62%|######1   | Repairing epochs : 60/97 [00:00&lt;00:00,  126.14it/s]


 65%|######4   | Repairing epochs : 63/97 [00:00&lt;00:00,  126.14it/s]


 67%|######7   | Repairing epochs : 65/97 [00:00&lt;00:00,  120.35it/s]


 69%|######9   | Repairing epochs : 67/97 [00:00&lt;00:00,  114.95it/s]


 71%|#######1  | Repairing epochs : 69/97 [00:00&lt;00:00,  110.74it/s]


 72%|#######2  | Repairing epochs : 70/97 [00:00&lt;00:00,  108.48it/s]


 74%|#######4  | Repairing epochs : 72/97 [00:00&lt;00:00,  104.70it/s]


 76%|#######6  | Repairing epochs : 74/97 [00:00&lt;00:00,  101.23it/s]


 77%|#######7  | Repairing epochs : 75/97 [00:00&lt;00:00,   99.51it/s]


 79%|#######9  | Repairing epochs : 77/97 [00:00&lt;00:00,   96.84it/s]


 81%|########1 | Repairing epochs : 79/97 [00:00&lt;00:00,   94.13it/s]


 84%|########3 | Repairing epochs : 81/97 [00:00&lt;00:00,   91.98it/s]


 86%|########5 | Repairing epochs : 83/97 [00:00&lt;00:00,   90.48it/s]


 88%|########7 | Repairing epochs : 85/97 [00:00&lt;00:00,   88.90it/s]


 90%|########9 | Repairing epochs : 87/97 [00:00&lt;00:00,   87.34it/s]


 92%|#########1| Repairing epochs : 89/97 [00:00&lt;00:00,   85.87it/s]


 94%|#########3| Repairing epochs : 91/97 [00:00&lt;00:00,   84.75it/s]


 96%|#########5| Repairing epochs : 93/97 [00:00&lt;00:00,   83.80it/s]


 98%|#########7| Repairing epochs : 95/97 [00:00&lt;00:00,   82.82it/s]


100%|##########| Repairing epochs : 97/97 [00:01&lt;00:00,   81.73it/s]
100%|##########| Repairing epochs : 97/97 [00:01&lt;00:00,   96.65it/s]
Dropped 27 epochs: 54, 58, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 86, 89, 91, 92, 95, 96
</pre></div>
</div>
<p>visualize the dropped epochs</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reject_log</span><span class="o">.</span><span class="n">bad_epochs</span></a><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scalings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="mf">100e-6</span><span class="p">))</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_autoreject_workflow_002.png" srcset="../_images/sphx_glr_plot_autoreject_workflow_002.png" alt="plot autoreject workflow" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Using matplotlib as 2D backend.

&lt;MNEBrowseFigure size 800x800 with 4 Axes&gt;
</pre></div>
</div>
<p>and the reject log</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../generated/autoreject.RejectLog.html#autoreject.RejectLog.plot" title="autoreject.RejectLog.plot" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-method"><span class="n">reject_log</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_autoreject_workflow_003.png" srcset="../_images/sphx_glr_plot_autoreject_workflow_003.png" alt="plot autoreject workflow" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1200x600 with 1 Axes&gt;
</pre></div>
</div>
</section>
<section id="autoreject-with-high-pass-filter">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Autoreject with high-pass filter</a><a class="headerlink" href="#autoreject-with-high-pass-filter" title="Permalink to this heading">#</a></h2>
<p>The data may be very valuable and the time for the experiment
limited and so we may want to take steps to reduce the number of
epochs dropped by first using other steps to preprocess the data.
We will use a high-pass filter first to remove slow drift that could
cause epochs to be dropped.</p>
<p>When making this decision to filter the data, we do want to be careful
because filtering can spread sharp, high-frequency transients and
distort the phase of the signal. Most evoked response potential
analyses use filtering since the interest is in the time series, but
if you are doing a frequency based analysis, filtering before the
Fourier transform could potentially be avoided by detrending instead.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">raw</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">l_freq</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">h_freq</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.make_fixed_length_epochs.html#mne.make_fixed_length_epochs" title="mne.make_fixed_length_epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">make_fixed_length_epochs</span></a><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject" title="autoreject.AutoReject" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ar</span></a> <span class="o">=</span> <a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject" title="autoreject.AutoReject" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class"><span class="n">autoreject</span><span class="o">.</span><span class="n">AutoReject</span></a><span class="p">(</span><span class="n">n_interpolate</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
                           <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject.fit" title="autoreject.AutoReject.fit" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-method"><span class="n">ar</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>  <span class="c1"># fit on a few epochs to save time</span>
<a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_ar</span></a><span class="p">,</span> <a href="../generated/autoreject.RejectLog.html#autoreject.RejectLog" title="autoreject.RejectLog" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reject_log</span></a> <span class="o">=</span> <a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject.transform" title="autoreject.AutoReject.transform" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-method"><span class="n">ar</span><span class="o">.</span><span class="n">transform</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">,</span> <span class="n">return_log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 1691 samples (3.303 s)

[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=1)]: Done   2 out of   2 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=1)]: Done   3 out of   3 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=1)]: Done   4 out of   4 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=1)]: Done  32 out of  32 | elapsed:    0.2s finished
Not setting metadata
97 matching events found
No baseline correction applied
0 projection items activated
Using data from preloaded Raw for 97 events and 1536 original time points ...
0 bad epochs dropped
Running autoreject on ch_type=eeg

  0%|          | Creating augmented epochs : 0/32 [00:00&lt;?,       ?it/s]
  6%|6         | Creating augmented epochs : 2/32 [00:00&lt;00:00,   73.41it/s]
  9%|9         | Creating augmented epochs : 3/32 [00:00&lt;00:00,   67.62it/s]
 12%|#2        | Creating augmented epochs : 4/32 [00:00&lt;00:00,   64.98it/s]
 16%|#5        | Creating augmented epochs : 5/32 [00:00&lt;00:00,   63.11it/s]
 22%|##1       | Creating augmented epochs : 7/32 [00:00&lt;00:00,   62.97it/s]
 25%|##5       | Creating augmented epochs : 8/32 [00:00&lt;00:00,   62.10it/s]
 28%|##8       | Creating augmented epochs : 9/32 [00:00&lt;00:00,   61.13it/s]
 31%|###1      | Creating augmented epochs : 10/32 [00:00&lt;00:00,   60.76it/s]
 34%|###4      | Creating augmented epochs : 11/32 [00:00&lt;00:00,   60.79it/s]
 38%|###7      | Creating augmented epochs : 12/32 [00:00&lt;00:00,   60.64it/s]
 41%|####      | Creating augmented epochs : 13/32 [00:00&lt;00:00,   60.81it/s]
 44%|####3     | Creating augmented epochs : 14/32 [00:00&lt;00:00,   60.65it/s]
 47%|####6     | Creating augmented epochs : 15/32 [00:00&lt;00:00,   60.78it/s]
 50%|#####     | Creating augmented epochs : 16/32 [00:00&lt;00:00,   60.79it/s]
 56%|#####6    | Creating augmented epochs : 18/32 [00:00&lt;00:00,   61.08it/s]
 59%|#####9    | Creating augmented epochs : 19/32 [00:00&lt;00:00,   60.69it/s]
 62%|######2   | Creating augmented epochs : 20/32 [00:00&lt;00:00,   60.73it/s]
 66%|######5   | Creating augmented epochs : 21/32 [00:00&lt;00:00,   60.48it/s]
 69%|######8   | Creating augmented epochs : 22/32 [00:00&lt;00:00,   60.11it/s]
 72%|#######1  | Creating augmented epochs : 23/32 [00:00&lt;00:00,   60.22it/s]
 75%|#######5  | Creating augmented epochs : 24/32 [00:00&lt;00:00,   60.14it/s]
 78%|#######8  | Creating augmented epochs : 25/32 [00:00&lt;00:00,   60.02it/s]
 81%|########1 | Creating augmented epochs : 26/32 [00:00&lt;00:00,   60.07it/s]
 84%|########4 | Creating augmented epochs : 27/32 [00:00&lt;00:00,   60.07it/s]
 88%|########7 | Creating augmented epochs : 28/32 [00:00&lt;00:00,   59.81it/s]
 91%|######### | Creating augmented epochs : 29/32 [00:00&lt;00:00,   59.89it/s]
 94%|#########3| Creating augmented epochs : 30/32 [00:00&lt;00:00,   59.82it/s]
 97%|#########6| Creating augmented epochs : 31/32 [00:00&lt;00:00,   59.57it/s]
100%|##########| Creating augmented epochs : 32/32 [00:00&lt;00:00,   59.39it/s]
100%|##########| Creating augmented epochs : 32/32 [00:00&lt;00:00,   59.91it/s]

  0%|          | Computing thresholds ... : 0/32 [00:00&lt;?,       ?it/s]
  3%|3         | Computing thresholds ... : 1/32 [00:00&lt;00:15,    1.99it/s]
  6%|6         | Computing thresholds ... : 2/32 [00:01&lt;00:15,    1.99it/s]
  9%|9         | Computing thresholds ... : 3/32 [00:01&lt;00:14,    1.99it/s]
 12%|#2        | Computing thresholds ... : 4/32 [00:02&lt;00:14,    1.99it/s]
 16%|#5        | Computing thresholds ... : 5/32 [00:02&lt;00:13,    1.99it/s]
 19%|#8        | Computing thresholds ... : 6/32 [00:03&lt;00:13,    1.99it/s]
 22%|##1       | Computing thresholds ... : 7/32 [00:03&lt;00:12,    1.99it/s]
 25%|##5       | Computing thresholds ... : 8/32 [00:04&lt;00:12,    1.99it/s]
 28%|##8       | Computing thresholds ... : 9/32 [00:04&lt;00:11,    1.99it/s]
 31%|###1      | Computing thresholds ... : 10/32 [00:05&lt;00:11,    1.99it/s]
 34%|###4      | Computing thresholds ... : 11/32 [00:05&lt;00:10,    1.99it/s]
 38%|###7      | Computing thresholds ... : 12/32 [00:06&lt;00:10,    1.99it/s]
 41%|####      | Computing thresholds ... : 13/32 [00:06&lt;00:09,    1.99it/s]
 44%|####3     | Computing thresholds ... : 14/32 [00:07&lt;00:09,    1.99it/s]
 47%|####6     | Computing thresholds ... : 15/32 [00:07&lt;00:08,    2.00it/s]
 50%|#####     | Computing thresholds ... : 16/32 [00:08&lt;00:08,    2.00it/s]
 53%|#####3    | Computing thresholds ... : 17/32 [00:08&lt;00:07,    2.00it/s]
 56%|#####6    | Computing thresholds ... : 18/32 [00:09&lt;00:06,    2.00it/s]
 59%|#####9    | Computing thresholds ... : 19/32 [00:09&lt;00:06,    2.00it/s]
 62%|######2   | Computing thresholds ... : 20/32 [00:10&lt;00:05,    2.00it/s]
 66%|######5   | Computing thresholds ... : 21/32 [00:10&lt;00:05,    2.00it/s]
 69%|######8   | Computing thresholds ... : 22/32 [00:11&lt;00:05,    2.00it/s]
 72%|#######1  | Computing thresholds ... : 23/32 [00:11&lt;00:04,    2.00it/s]
 75%|#######5  | Computing thresholds ... : 24/32 [00:12&lt;00:04,    2.00it/s]
 78%|#######8  | Computing thresholds ... : 25/32 [00:12&lt;00:03,    2.00it/s]
 81%|########1 | Computing thresholds ... : 26/32 [00:13&lt;00:03,    2.00it/s]
 84%|########4 | Computing thresholds ... : 27/32 [00:13&lt;00:02,    2.00it/s]
 88%|########7 | Computing thresholds ... : 28/32 [00:14&lt;00:02,    2.00it/s]
 91%|######### | Computing thresholds ... : 29/32 [00:14&lt;00:01,    1.99it/s]
 94%|#########3| Computing thresholds ... : 30/32 [00:15&lt;00:01,    1.99it/s]
 97%|#########6| Computing thresholds ... : 31/32 [00:15&lt;00:00,    1.99it/s]
100%|##########| Computing thresholds ... : 32/32 [00:16&lt;00:00,    1.99it/s]
100%|##########| Computing thresholds ... : 32/32 [00:16&lt;00:00,    1.99it/s]



  0%|          | Repairing epochs : 0/20 [00:00&lt;?,       ?it/s]


 20%|##        | Repairing epochs : 4/20 [00:00&lt;00:00,  242.63it/s]


 40%|####      | Repairing epochs : 8/20 [00:00&lt;00:00,  240.88it/s]


 60%|######    | Repairing epochs : 12/20 [00:00&lt;00:00,  239.41it/s]


 80%|########  | Repairing epochs : 16/20 [00:00&lt;00:00,  239.01it/s]
100%|##########| Repairing epochs : 20/20 [00:00&lt;00:00,  266.11it/s]


  0%|          | n_interp : 0/4 [00:00&lt;?,       ?it/s]


  0%|          | Repairing epochs : 0/20 [00:00&lt;?,       ?it/s]


 10%|#         | Repairing epochs : 2/20 [00:00&lt;00:00,   90.80it/s]


 20%|##        | Repairing epochs : 4/20 [00:00&lt;00:00,   97.22it/s]


 30%|###       | Repairing epochs : 6/20 [00:00&lt;00:00,   86.61it/s]


 40%|####      | Repairing epochs : 8/20 [00:00&lt;00:00,   89.79it/s]


 50%|#####     | Repairing epochs : 10/20 [00:00&lt;00:00,   93.25it/s]


 60%|######    | Repairing epochs : 12/20 [00:00&lt;00:00,   94.50it/s]


 70%|#######   | Repairing epochs : 14/20 [00:00&lt;00:00,   95.62it/s]


 80%|########  | Repairing epochs : 16/20 [00:00&lt;00:00,   90.33it/s]


 90%|######### | Repairing epochs : 18/20 [00:00&lt;00:00,   86.47it/s]


100%|##########| Repairing epochs : 20/20 [00:00&lt;00:00,   83.15it/s]
100%|##########| Repairing epochs : 20/20 [00:00&lt;00:00,   84.40it/s]




  0%|          | Fold : 0/10 [00:00&lt;?,       ?it/s]



 10%|#         | Fold : 1/10 [00:00&lt;00:01,    8.60it/s]



 20%|##        | Fold : 2/10 [00:00&lt;00:00,   11.02it/s]



 30%|###       | Fold : 3/10 [00:00&lt;00:00,   12.17it/s]



 40%|####      | Fold : 4/10 [00:00&lt;00:00,   12.91it/s]



 50%|#####     | Fold : 5/10 [00:00&lt;00:00,   13.37it/s]



 60%|######    | Fold : 6/10 [00:00&lt;00:00,   13.73it/s]



 70%|#######   | Fold : 7/10 [00:00&lt;00:00,   13.96it/s]



 80%|########  | Fold : 8/10 [00:00&lt;00:00,   14.11it/s]



 90%|######### | Fold : 9/10 [00:00&lt;00:00,   14.23it/s]



100%|##########| Fold : 10/10 [00:00&lt;00:00,   14.34it/s]
100%|##########| Fold : 10/10 [00:00&lt;00:00,   14.11it/s]


 25%|##5       | n_interp : 1/4 [00:00&lt;00:02,    1.03it/s]


  0%|          | Repairing epochs : 0/20 [00:00&lt;?,       ?it/s]


 10%|#         | Repairing epochs : 2/20 [00:00&lt;00:00,  124.61it/s]


 25%|##5       | Repairing epochs : 5/20 [00:00&lt;00:00,  148.91it/s]


 35%|###5      | Repairing epochs : 7/20 [00:00&lt;00:00,  122.26it/s]


 50%|#####     | Repairing epochs : 10/20 [00:00&lt;00:00,  125.37it/s]


 60%|######    | Repairing epochs : 12/20 [00:00&lt;00:00,  117.68it/s]


 70%|#######   | Repairing epochs : 14/20 [00:00&lt;00:00,  113.72it/s]


 80%|########  | Repairing epochs : 16/20 [00:00&lt;00:00,  104.05it/s]


 95%|#########5| Repairing epochs : 19/20 [00:00&lt;00:00,  109.45it/s]
100%|##########| Repairing epochs : 20/20 [00:00&lt;00:00,  111.17it/s]




  0%|          | Fold : 0/10 [00:00&lt;?,       ?it/s]



 10%|#         | Fold : 1/10 [00:00&lt;00:00,   15.18it/s]



 20%|##        | Fold : 2/10 [00:00&lt;00:00,   15.31it/s]



 30%|###       | Fold : 3/10 [00:00&lt;00:00,   15.37it/s]



 40%|####      | Fold : 4/10 [00:00&lt;00:00,   15.43it/s]



 50%|#####     | Fold : 5/10 [00:00&lt;00:00,   15.47it/s]



 60%|######    | Fold : 6/10 [00:00&lt;00:00,   15.47it/s]



 70%|#######   | Fold : 7/10 [00:00&lt;00:00,   15.46it/s]



 80%|########  | Fold : 8/10 [00:00&lt;00:00,   15.48it/s]



 90%|######### | Fold : 9/10 [00:00&lt;00:00,   15.50it/s]



100%|##########| Fold : 10/10 [00:00&lt;00:00,   15.52it/s]
100%|##########| Fold : 10/10 [00:00&lt;00:00,   15.49it/s]


 50%|#####     | n_interp : 2/4 [00:01&lt;00:01,    1.11it/s]


  0%|          | Repairing epochs : 0/20 [00:00&lt;?,       ?it/s]


 15%|#5        | Repairing epochs : 3/20 [00:00&lt;00:00,  133.90it/s]


 30%|###       | Repairing epochs : 6/20 [00:00&lt;00:00,  153.34it/s]


 35%|###5      | Repairing epochs : 7/20 [00:00&lt;00:00,  124.17it/s]


 50%|#####     | Repairing epochs : 10/20 [00:00&lt;00:00,  125.21it/s]


 60%|######    | Repairing epochs : 12/20 [00:00&lt;00:00,  117.89it/s]


 70%|#######   | Repairing epochs : 14/20 [00:00&lt;00:00,  114.75it/s]


 80%|########  | Repairing epochs : 16/20 [00:00&lt;00:00,  105.19it/s]


 95%|#########5| Repairing epochs : 19/20 [00:00&lt;00:00,  109.98it/s]
100%|##########| Repairing epochs : 20/20 [00:00&lt;00:00,  112.19it/s]




  0%|          | Fold : 0/10 [00:00&lt;?,       ?it/s]



 10%|#         | Fold : 1/10 [00:00&lt;00:00,   15.18it/s]



 20%|##        | Fold : 2/10 [00:00&lt;00:00,   15.35it/s]



 30%|###       | Fold : 3/10 [00:00&lt;00:00,   15.39it/s]



 40%|####      | Fold : 4/10 [00:00&lt;00:00,   15.40it/s]



 50%|#####     | Fold : 5/10 [00:00&lt;00:00,   15.36it/s]



 60%|######    | Fold : 6/10 [00:00&lt;00:00,   15.40it/s]



 70%|#######   | Fold : 7/10 [00:00&lt;00:00,   15.40it/s]



 80%|########  | Fold : 8/10 [00:00&lt;00:00,   15.36it/s]



 90%|######### | Fold : 9/10 [00:00&lt;00:00,   15.36it/s]



100%|##########| Fold : 10/10 [00:00&lt;00:00,   15.30it/s]
100%|##########| Fold : 10/10 [00:00&lt;00:00,   15.30it/s]


 75%|#######5  | n_interp : 3/4 [00:02&lt;00:00,    1.13it/s]


  0%|          | Repairing epochs : 0/20 [00:00&lt;?,       ?it/s]


 15%|#5        | Repairing epochs : 3/20 [00:00&lt;00:00,  138.45it/s]


 30%|###       | Repairing epochs : 6/20 [00:00&lt;00:00,  156.66it/s]


 35%|###5      | Repairing epochs : 7/20 [00:00&lt;00:00,  126.24it/s]


 50%|#####     | Repairing epochs : 10/20 [00:00&lt;00:00,  125.84it/s]


 60%|######    | Repairing epochs : 12/20 [00:00&lt;00:00,  118.26it/s]


 70%|#######   | Repairing epochs : 14/20 [00:00&lt;00:00,  115.27it/s]


 75%|#######5  | Repairing epochs : 15/20 [00:00&lt;00:00,  107.67it/s]


 85%|########5 | Repairing epochs : 17/20 [00:00&lt;00:00,  107.24it/s]


100%|##########| Repairing epochs : 20/20 [00:00&lt;00:00,  111.17it/s]
100%|##########| Repairing epochs : 20/20 [00:00&lt;00:00,  112.14it/s]




  0%|          | Fold : 0/10 [00:00&lt;?,       ?it/s]



 10%|#         | Fold : 1/10 [00:00&lt;00:00,   16.67it/s]



 20%|##        | Fold : 2/10 [00:00&lt;00:00,   16.96it/s]



 30%|###       | Fold : 3/10 [00:00&lt;00:00,   17.04it/s]



 40%|####      | Fold : 4/10 [00:00&lt;00:00,   17.01it/s]



 50%|#####     | Fold : 5/10 [00:00&lt;00:00,   17.00it/s]



 60%|######    | Fold : 6/10 [00:00&lt;00:00,   16.96it/s]



 70%|#######   | Fold : 7/10 [00:00&lt;00:00,   16.93it/s]



 80%|########  | Fold : 8/10 [00:00&lt;00:00,   16.87it/s]



 90%|######### | Fold : 9/10 [00:00&lt;00:00,   16.84it/s]



100%|##########| Fold : 10/10 [00:00&lt;00:00,   16.82it/s]
100%|##########| Fold : 10/10 [00:00&lt;00:00,   16.83it/s]


100%|##########| n_interp : 4/4 [00:03&lt;00:00,    1.16it/s]
100%|##########| n_interp : 4/4 [00:03&lt;00:00,    1.16it/s]




Estimated consensus=0.40 and n_interpolate=4



  0%|          | Repairing epochs : 0/97 [00:00&lt;?,       ?it/s]


  3%|3         | Repairing epochs : 3/97 [00:00&lt;00:00,  144.08it/s]


  6%|6         | Repairing epochs : 6/97 [00:00&lt;00:00,  159.25it/s]


  7%|7         | Repairing epochs : 7/97 [00:00&lt;00:00,  128.41it/s]


 10%|#         | Repairing epochs : 10/97 [00:00&lt;00:00,  127.45it/s]


 12%|#2        | Repairing epochs : 12/97 [00:00&lt;00:00,  119.00it/s]


 14%|#4        | Repairing epochs : 14/97 [00:00&lt;00:00,  116.99it/s]


 16%|#6        | Repairing epochs : 16/97 [00:00&lt;00:00,  106.13it/s]


 20%|#9        | Repairing epochs : 19/97 [00:00&lt;00:00,  110.46it/s]


 23%|##2       | Repairing epochs : 22/97 [00:00&lt;00:00,  114.66it/s]


 26%|##5       | Repairing epochs : 25/97 [00:00&lt;00:00,  117.80it/s]


 29%|##8       | Repairing epochs : 28/97 [00:00&lt;00:00,  120.58it/s]


 32%|###1      | Repairing epochs : 31/97 [00:00&lt;00:00,  121.82it/s]


 35%|###5      | Repairing epochs : 34/97 [00:00&lt;00:00,  123.74it/s]


 37%|###7      | Repairing epochs : 36/97 [00:00&lt;00:00,  116.74it/s]


 39%|###9      | Repairing epochs : 38/97 [00:00&lt;00:00,  111.49it/s]


 40%|####      | Repairing epochs : 39/97 [00:00&lt;00:00,  108.29it/s]


 42%|####2     | Repairing epochs : 41/97 [00:00&lt;00:00,  103.94it/s]


 44%|####4     | Repairing epochs : 43/97 [00:00&lt;00:00,  100.76it/s]


 46%|####6     | Repairing epochs : 45/97 [00:00&lt;00:00,   98.37it/s]


 47%|####7     | Repairing epochs : 46/97 [00:00&lt;00:00,   96.39it/s]


 49%|####9     | Repairing epochs : 48/97 [00:00&lt;00:00,   94.36it/s]


 52%|#####1    | Repairing epochs : 50/97 [00:00&lt;00:00,   94.83it/s]


 55%|#####4    | Repairing epochs : 53/97 [00:00&lt;00:00,   98.09it/s]


 58%|#####7    | Repairing epochs : 56/97 [00:00&lt;00:00,  100.85it/s]


 60%|#####9    | Repairing epochs : 58/97 [00:00&lt;00:00,  100.31it/s]


 62%|######1   | Repairing epochs : 60/97 [00:00&lt;00:00,   97.92it/s]


 64%|######3   | Repairing epochs : 62/97 [00:00&lt;00:00,   95.82it/s]


 66%|######5   | Repairing epochs : 64/97 [00:00&lt;00:00,   93.59it/s]


 67%|######7   | Repairing epochs : 65/97 [00:00&lt;00:00,   92.14it/s]


 69%|######9   | Repairing epochs : 67/97 [00:00&lt;00:00,   90.62it/s]


 71%|#######1  | Repairing epochs : 69/97 [00:00&lt;00:00,   90.04it/s]


 74%|#######4  | Repairing epochs : 72/97 [00:00&lt;00:00,   92.54it/s]


 77%|#######7  | Repairing epochs : 75/97 [00:00&lt;00:00,   95.11it/s]


 80%|########  | Repairing epochs : 78/97 [00:00&lt;00:00,   97.51it/s]


 84%|########3 | Repairing epochs : 81/97 [00:00&lt;00:00,   99.78it/s]


 87%|########6 | Repairing epochs : 84/97 [00:00&lt;00:00,  101.80it/s]


 90%|########9 | Repairing epochs : 87/97 [00:00&lt;00:00,  104.07it/s]


 93%|#########2| Repairing epochs : 90/97 [00:00&lt;00:00,  105.93it/s]


 96%|#########5| Repairing epochs : 93/97 [00:00&lt;00:00,  107.74it/s]


 99%|#########8| Repairing epochs : 96/97 [00:00&lt;00:00,  109.36it/s]
100%|##########| Repairing epochs : 97/97 [00:00&lt;00:00,  105.62it/s]
Dropped 23 epochs: 62, 63, 64, 65, 67, 68, 69, 70, 71, 72, 73, 75, 76, 77, 78, 79, 80, 86, 89, 91, 92, 95, 96
</pre></div>
</div>
<p>visualize the dropped epochs</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reject_log</span><span class="o">.</span><span class="n">bad_epochs</span></a><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scalings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="mf">100e-6</span><span class="p">))</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_autoreject_workflow_004.png" srcset="../_images/sphx_glr_plot_autoreject_workflow_004.png" alt="plot autoreject workflow" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;MNEBrowseFigure size 800x800 with 4 Axes&gt;
</pre></div>
</div>
<p>and the reject log. As we can see in the plot, high-pass filtering reduced
the number of epochs marked as bad by autoreject substantially.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../generated/autoreject.RejectLog.html#autoreject.RejectLog.plot" title="autoreject.RejectLog.plot" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-method"><span class="n">reject_log</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_autoreject_workflow_005.png" srcset="../_images/sphx_glr_plot_autoreject_workflow_005.png" alt="plot autoreject workflow" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1200x600 with 1 Axes&gt;
</pre></div>
</div>
</section>
<section id="ica">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">ICA</a><a class="headerlink" href="#ica" title="Permalink to this heading">#</a></h2>
<p>Finally, we can apply independent components analysis (ICA) to remove
eyeblinks from the data. If our analysis were to be very dependent on
sensors at the front of the head, we could skip ICA and use the previous
result. However, ICA can increase the amount of usable data by applying
a spatial filter that downscales the data in sensors most affected by
eyeblink artifacts.</p>
<p>Note that ICA works best if bad segments of the data are removed
Hence, we will remove the bad segments from the
previous run of autoreject for the benefit of the ICA algorithm.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># compute ICA</span>
<a href="https://mne.tools/dev/generated/mne.preprocessing.ICA.html#mne.preprocessing.ICA" title="mne.preprocessing.ICA" class="sphx-glr-backref-module-mne-preprocessing sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ica</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.preprocessing.ICA.html#mne.preprocessing.ICA" title="mne.preprocessing.ICA" class="sphx-glr-backref-module-mne-preprocessing sphx-glr-backref-type-py-class"><span class="n">mne</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">ICA</span></a><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>
<a href="https://mne.tools/dev/generated/mne.preprocessing.ICA.html#mne.preprocessing.ICA.fit" title="mne.preprocessing.ICA.fit" class="sphx-glr-backref-module-mne-preprocessing sphx-glr-backref-type-py-method"><span class="n">ica</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><span class="o">~</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reject_log</span><span class="o">.</span><span class="n">bad_epochs</span></a><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Fitting ICA to data using 32 channels (please be patient, this may take a while)
Selecting by non-zero PCA components: 32 components
Fitting ICA took 5.4s.
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table class="table table-hover table-striped table-sm table-responsive small">
    <tr>
        <th>Method</th>
        <td>fastica</td>
    </tr>
    <tr>
        <th>Fit</th>
        <td>49 iterations on epochs (113664 samples)</td>
    </tr>

    <tr>
        <th>ICA components</th>
        <td>32</td>
    </tr>
    <tr>
        <th>Available PCA components</th>
        <td>32</td>
    </tr>
    <tr>
        <th>Channel types</th>
        <td>eeg</td>
    </tr>
    <tr>
        <th>ICA components marked for exclusion</th>
        <td>&mdash;</td>
    </tr>

</table>
</div>
<br />
<br /><p>We can see in the plots below that ICA effectively removed eyeblink
artifact.</p>
<p>plot source components to see which is made up of blinks</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">exclude</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="c1"># blinks</span>
           <span class="mi">2</span>  <span class="c1"># saccades</span>
           <span class="p">]</span>
<a href="https://mne.tools/dev/generated/mne.preprocessing.ICA.html#mne.preprocessing.ICA.plot_components" title="mne.preprocessing.ICA.plot_components" class="sphx-glr-backref-module-mne-preprocessing sphx-glr-backref-type-py-method"><span class="n">ica</span><span class="o">.</span><span class="n">plot_components</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">exclude</span></a><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ica</span><span class="o">.</span><span class="n">exclude</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">exclude</span></a>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_autoreject_workflow_006.png" srcset="../_images/sphx_glr_plot_autoreject_workflow_006.png" alt="ICA components, ICA000, ICA002" class = "sphx-glr-single-img"/><p>plot with and without eyeblink component</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://mne.tools/dev/generated/mne.preprocessing.ICA.html#mne.preprocessing.ICA.plot_overlay" title="mne.preprocessing.ICA.plot_overlay" class="sphx-glr-backref-module-mne-preprocessing sphx-glr-backref-type-py-method"><span class="n">ica</span><span class="o">.</span><span class="n">plot_overlay</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs.average" title="mne.Epochs.average" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">epochs</span><span class="o">.</span><span class="n">average</span></a><span class="p">(),</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">exclude</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ica</span><span class="o">.</span><span class="n">exclude</span></a><span class="p">)</span>
<a href="https://mne.tools/dev/generated/mne.preprocessing.ICA.html#mne.preprocessing.ICA.apply" title="mne.preprocessing.ICA.apply" class="sphx-glr-backref-module-mne-preprocessing sphx-glr-backref-type-py-method"><span class="n">ica</span><span class="o">.</span><span class="n">apply</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">exclude</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ica</span><span class="o">.</span><span class="n">exclude</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_autoreject_workflow_007.png" srcset="../_images/sphx_glr_plot_autoreject_workflow_007.png" alt="Signals before (red) and after (black) cleaning, EEG (32 channels)" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
Applying ICA to Evoked instance
    Transforming to ICA space (32 components)
    Zeroing out 2 ICA components
    Projecting back using 32 PCA components
Applying ICA to Epochs instance
    Transforming to ICA space (32 components)
    Zeroing out 2 ICA components
    Projecting back using 32 PCA components
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table class="table table-hover table-striped table-sm table-responsive small">
    <tr>
        <th>Number of events</th>
        <td>97</td>
    </tr>
    <tr>
        <th>Events</th>

        <td>1: 97</td>

    </tr>
    <tr>
        <th>Time range</th>
        <td>0.000 – 2.998 s</td>
    </tr>
    <tr>
        <th>Baseline</th>
        <td>off</td>
    </tr>
</table>
</div>
<br />
<br /></section>
<section id="autoreject-with-highpass-filter-and-ica">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Autoreject with highpass filter and ICA</a><a class="headerlink" href="#autoreject-with-highpass-filter-and-ica" title="Permalink to this heading">#</a></h2>
<p>We can see in this section that preprocessing, especially ICA, can be made
to do a lot of the heavy lifting. There isn’t a huge difference when viewing
the averaged data because the ICA effectively limited the number
of epochs that had to be dropped. However, there are still artifacts such as
non-stereotypical blinks that weren’t able to be removed by ICA, channel
“pops” (sharp transients with exponential RC decay), muscle artifact such as
jaw clenches and gross movement artifact that could still impact analyses.</p>
<p>These are the basic steps for a workflow with decisions that must be
made based on what the data is being used for. Following this may help
you optimize your use of <code class="docutils literal notranslate"><span class="pre">autoreject</span></code> in preprocessing.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># compute channel-level rejections</span>
<a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject" title="autoreject.AutoReject" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ar</span></a> <span class="o">=</span> <a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject" title="autoreject.AutoReject" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class"><span class="n">autoreject</span><span class="o">.</span><span class="n">AutoReject</span></a><span class="p">(</span><span class="n">n_interpolate</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
                           <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject.fit" title="autoreject.AutoReject.fit" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-method"><span class="n">ar</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>  <span class="c1"># fit on the first 20 epochs to save time</span>
<a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_ar</span></a><span class="p">,</span> <a href="../generated/autoreject.RejectLog.html#autoreject.RejectLog" title="autoreject.RejectLog" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reject_log</span></a> <span class="o">=</span> <a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject.transform" title="autoreject.AutoReject.transform" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-method"><span class="n">ar</span><span class="o">.</span><span class="n">transform</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">,</span> <span class="n">return_log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reject_log</span><span class="o">.</span><span class="n">bad_epochs</span></a><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scalings</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="mf">100e-6</span><span class="p">))</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_autoreject_workflow_008.png" srcset="../_images/sphx_glr_plot_autoreject_workflow_008.png" alt="plot autoreject workflow" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Running autoreject on ch_type=eeg

  0%|          | Creating augmented epochs : 0/32 [00:00&lt;?,       ?it/s]
  6%|6         | Creating augmented epochs : 2/32 [00:00&lt;00:00,   84.96it/s]
 12%|#2        | Creating augmented epochs : 4/32 [00:00&lt;00:00,   73.78it/s]
 16%|#5        | Creating augmented epochs : 5/32 [00:00&lt;00:00,   70.98it/s]
 22%|##1       | Creating augmented epochs : 7/32 [00:00&lt;00:00,   70.43it/s]
 28%|##8       | Creating augmented epochs : 9/32 [00:00&lt;00:00,   69.40it/s]
 34%|###4      | Creating augmented epochs : 11/32 [00:00&lt;00:00,   68.94it/s]
 41%|####      | Creating augmented epochs : 13/32 [00:00&lt;00:00,   68.49it/s]
 44%|####3     | Creating augmented epochs : 14/32 [00:00&lt;00:00,   67.86it/s]
 50%|#####     | Creating augmented epochs : 16/32 [00:00&lt;00:00,   67.54it/s]
 56%|#####6    | Creating augmented epochs : 18/32 [00:00&lt;00:00,   67.82it/s]
 62%|######2   | Creating augmented epochs : 20/32 [00:00&lt;00:00,   67.36it/s]
 69%|######8   | Creating augmented epochs : 22/32 [00:00&lt;00:00,   67.01it/s]
 75%|#######5  | Creating augmented epochs : 24/32 [00:00&lt;00:00,   67.12it/s]
 81%|########1 | Creating augmented epochs : 26/32 [00:00&lt;00:00,   67.25it/s]
 88%|########7 | Creating augmented epochs : 28/32 [00:00&lt;00:00,   67.14it/s]
 94%|#########3| Creating augmented epochs : 30/32 [00:00&lt;00:00,   67.04it/s]
100%|##########| Creating augmented epochs : 32/32 [00:00&lt;00:00,   66.68it/s]
100%|##########| Creating augmented epochs : 32/32 [00:00&lt;00:00,   67.00it/s]

  0%|          | Computing thresholds ... : 0/32 [00:00&lt;?,       ?it/s]
  3%|3         | Computing thresholds ... : 1/32 [00:00&lt;00:15,    1.99it/s]
  6%|6         | Computing thresholds ... : 2/32 [00:01&lt;00:15,    1.99it/s]
  9%|9         | Computing thresholds ... : 3/32 [00:01&lt;00:14,    1.99it/s]
 12%|#2        | Computing thresholds ... : 4/32 [00:02&lt;00:14,    1.99it/s]
 16%|#5        | Computing thresholds ... : 5/32 [00:02&lt;00:13,    1.99it/s]
 19%|#8        | Computing thresholds ... : 6/32 [00:03&lt;00:13,    1.98it/s]
 22%|##1       | Computing thresholds ... : 7/32 [00:03&lt;00:12,    1.98it/s]
 25%|##5       | Computing thresholds ... : 8/32 [00:04&lt;00:12,    1.98it/s]
 28%|##8       | Computing thresholds ... : 9/32 [00:04&lt;00:11,    1.98it/s]
 31%|###1      | Computing thresholds ... : 10/32 [00:05&lt;00:11,    1.99it/s]
 34%|###4      | Computing thresholds ... : 11/32 [00:05&lt;00:10,    1.99it/s]
 38%|###7      | Computing thresholds ... : 12/32 [00:06&lt;00:10,    1.99it/s]
 41%|####      | Computing thresholds ... : 13/32 [00:06&lt;00:09,    1.99it/s]
 44%|####3     | Computing thresholds ... : 14/32 [00:07&lt;00:09,    1.99it/s]
 47%|####6     | Computing thresholds ... : 15/32 [00:07&lt;00:08,    1.99it/s]
 50%|#####     | Computing thresholds ... : 16/32 [00:08&lt;00:08,    2.00it/s]
 53%|#####3    | Computing thresholds ... : 17/32 [00:08&lt;00:07,    2.00it/s]
 56%|#####6    | Computing thresholds ... : 18/32 [00:09&lt;00:07,    2.00it/s]
 59%|#####9    | Computing thresholds ... : 19/32 [00:09&lt;00:06,    2.00it/s]
 62%|######2   | Computing thresholds ... : 20/32 [00:10&lt;00:06,    2.00it/s]
 66%|######5   | Computing thresholds ... : 21/32 [00:10&lt;00:05,    2.00it/s]
 69%|######8   | Computing thresholds ... : 22/32 [00:11&lt;00:05,    2.00it/s]
 72%|#######1  | Computing thresholds ... : 23/32 [00:11&lt;00:04,    2.00it/s]
 75%|#######5  | Computing thresholds ... : 24/32 [00:12&lt;00:04,    2.00it/s]
 78%|#######8  | Computing thresholds ... : 25/32 [00:12&lt;00:03,    2.00it/s]
 81%|########1 | Computing thresholds ... : 26/32 [00:13&lt;00:03,    1.99it/s]
 84%|########4 | Computing thresholds ... : 27/32 [00:13&lt;00:02,    1.99it/s]
 88%|########7 | Computing thresholds ... : 28/32 [00:14&lt;00:02,    1.99it/s]
 91%|######### | Computing thresholds ... : 29/32 [00:14&lt;00:01,    1.99it/s]
 94%|#########3| Computing thresholds ... : 30/32 [00:15&lt;00:01,    1.99it/s]
 97%|#########6| Computing thresholds ... : 31/32 [00:15&lt;00:00,    1.99it/s]
100%|##########| Computing thresholds ... : 32/32 [00:16&lt;00:00,    1.99it/s]
100%|##########| Computing thresholds ... : 32/32 [00:16&lt;00:00,    1.99it/s]



  0%|          | Repairing epochs : 0/20 [00:00&lt;?,       ?it/s]


 20%|##        | Repairing epochs : 4/20 [00:00&lt;00:00,  242.74it/s]


 40%|####      | Repairing epochs : 8/20 [00:00&lt;00:00,  240.29it/s]


 60%|######    | Repairing epochs : 12/20 [00:00&lt;00:00,  240.54it/s]


 80%|########  | Repairing epochs : 16/20 [00:00&lt;00:00,  240.95it/s]
100%|##########| Repairing epochs : 20/20 [00:00&lt;00:00,  254.10it/s]


  0%|          | n_interp : 0/4 [00:00&lt;?,       ?it/s]


  0%|          | Repairing epochs : 0/20 [00:00&lt;?,       ?it/s]


 30%|###       | Repairing epochs : 6/20 [00:00&lt;00:00,  208.30it/s]


 50%|#####     | Repairing epochs : 10/20 [00:00&lt;00:00,  177.55it/s]


 60%|######    | Repairing epochs : 12/20 [00:00&lt;00:00,  160.01it/s]


 70%|#######   | Repairing epochs : 14/20 [00:00&lt;00:00,  147.59it/s]


 80%|########  | Repairing epochs : 16/20 [00:00&lt;00:00,  125.65it/s]


 90%|######### | Repairing epochs : 18/20 [00:00&lt;00:00,  112.78it/s]


100%|##########| Repairing epochs : 20/20 [00:00&lt;00:00,  104.29it/s]
100%|##########| Repairing epochs : 20/20 [00:00&lt;00:00,  108.86it/s]




  0%|          | Fold : 0/10 [00:00&lt;?,       ?it/s]



 10%|#         | Fold : 1/10 [00:00&lt;00:01,    8.46it/s]



 20%|##        | Fold : 2/10 [00:00&lt;00:00,   10.65it/s]



 30%|###       | Fold : 3/10 [00:00&lt;00:00,   11.66it/s]



 40%|####      | Fold : 4/10 [00:00&lt;00:00,   12.27it/s]



 50%|#####     | Fold : 5/10 [00:00&lt;00:00,   12.69it/s]



 60%|######    | Fold : 6/10 [00:00&lt;00:00,   12.97it/s]



 70%|#######   | Fold : 7/10 [00:00&lt;00:00,   13.16it/s]



 80%|########  | Fold : 8/10 [00:00&lt;00:00,   13.35it/s]



 90%|######### | Fold : 9/10 [00:00&lt;00:00,   13.48it/s]



100%|##########| Fold : 10/10 [00:00&lt;00:00,   13.60it/s]
100%|##########| Fold : 10/10 [00:00&lt;00:00,   13.39it/s]


 25%|##5       | n_interp : 1/4 [00:00&lt;00:02,    1.06it/s]


  0%|          | Repairing epochs : 0/20 [00:00&lt;?,       ?it/s]


 25%|##5       | Repairing epochs : 5/20 [00:00&lt;00:00,  303.74it/s]


 45%|####5     | Repairing epochs : 9/20 [00:00&lt;00:00,  247.40it/s]


 55%|#####5    | Repairing epochs : 11/20 [00:00&lt;00:00,  194.34it/s]


 65%|######5   | Repairing epochs : 13/20 [00:00&lt;00:00,  170.49it/s]


 70%|#######   | Repairing epochs : 14/20 [00:00&lt;00:00,  149.22it/s]


 75%|#######5  | Repairing epochs : 15/20 [00:00&lt;00:00,  134.05it/s]


 85%|########5 | Repairing epochs : 17/20 [00:00&lt;00:00,  120.61it/s]


100%|##########| Repairing epochs : 20/20 [00:00&lt;00:00,  123.67it/s]
100%|##########| Repairing epochs : 20/20 [00:00&lt;00:00,  128.66it/s]




  0%|          | Fold : 0/10 [00:00&lt;?,       ?it/s]



 10%|#         | Fold : 1/10 [00:00&lt;00:01,    8.41it/s]



 20%|##        | Fold : 2/10 [00:00&lt;00:00,   10.67it/s]



 30%|###       | Fold : 3/10 [00:00&lt;00:00,   11.66it/s]



 40%|####      | Fold : 4/10 [00:00&lt;00:00,   12.25it/s]



 50%|#####     | Fold : 5/10 [00:00&lt;00:00,   12.65it/s]



 60%|######    | Fold : 6/10 [00:00&lt;00:00,   12.96it/s]



 70%|#######   | Fold : 7/10 [00:00&lt;00:00,   13.17it/s]



 80%|########  | Fold : 8/10 [00:00&lt;00:00,   13.34it/s]



 90%|######### | Fold : 9/10 [00:00&lt;00:00,   13.42it/s]



100%|##########| Fold : 10/10 [00:00&lt;00:00,   13.49it/s]
100%|##########| Fold : 10/10 [00:00&lt;00:00,   13.30it/s]


 50%|#####     | n_interp : 2/4 [00:01&lt;00:01,    1.07it/s]


  0%|          | Repairing epochs : 0/20 [00:00&lt;?,       ?it/s]


 25%|##5       | Repairing epochs : 5/20 [00:00&lt;00:00,  304.94it/s]


 45%|####5     | Repairing epochs : 9/20 [00:00&lt;00:00,  245.52it/s]


 55%|#####5    | Repairing epochs : 11/20 [00:00&lt;00:00,  191.25it/s]


 65%|######5   | Repairing epochs : 13/20 [00:00&lt;00:00,  168.19it/s]


 75%|#######5  | Repairing epochs : 15/20 [00:00&lt;00:00,  135.66it/s]


 85%|########5 | Repairing epochs : 17/20 [00:00&lt;00:00,  121.73it/s]


100%|##########| Repairing epochs : 20/20 [00:00&lt;00:00,  123.81it/s]
100%|##########| Repairing epochs : 20/20 [00:00&lt;00:00,  128.00it/s]




  0%|          | Fold : 0/10 [00:00&lt;?,       ?it/s]



 10%|#         | Fold : 1/10 [00:00&lt;00:01,    8.43it/s]



 20%|##        | Fold : 2/10 [00:00&lt;00:00,   10.68it/s]



 30%|###       | Fold : 3/10 [00:00&lt;00:00,   11.80it/s]



 40%|####      | Fold : 4/10 [00:00&lt;00:00,   12.39it/s]



 50%|#####     | Fold : 5/10 [00:00&lt;00:00,   12.72it/s]



 60%|######    | Fold : 6/10 [00:00&lt;00:00,   13.00it/s]



 70%|#######   | Fold : 7/10 [00:00&lt;00:00,   13.22it/s]



 80%|########  | Fold : 8/10 [00:00&lt;00:00,   13.42it/s]



 90%|######### | Fold : 9/10 [00:00&lt;00:00,   13.51it/s]



100%|##########| Fold : 10/10 [00:00&lt;00:00,   13.59it/s]
100%|##########| Fold : 10/10 [00:00&lt;00:00,   13.39it/s]


 75%|#######5  | n_interp : 3/4 [00:02&lt;00:00,    1.07it/s]


  0%|          | Repairing epochs : 0/20 [00:00&lt;?,       ?it/s]


 25%|##5       | Repairing epochs : 5/20 [00:00&lt;00:00,  306.56it/s]


 45%|####5     | Repairing epochs : 9/20 [00:00&lt;00:00,  248.49it/s]


 55%|#####5    | Repairing epochs : 11/20 [00:00&lt;00:00,  192.01it/s]


 65%|######5   | Repairing epochs : 13/20 [00:00&lt;00:00,  167.11it/s]


 75%|#######5  | Repairing epochs : 15/20 [00:00&lt;00:00,  133.86it/s]


 85%|########5 | Repairing epochs : 17/20 [00:00&lt;00:00,  121.24it/s]


100%|##########| Repairing epochs : 20/20 [00:00&lt;00:00,  123.63it/s]
100%|##########| Repairing epochs : 20/20 [00:00&lt;00:00,  127.87it/s]




  0%|          | Fold : 0/10 [00:00&lt;?,       ?it/s]



 10%|#         | Fold : 1/10 [00:00&lt;00:01,    8.98it/s]



 20%|##        | Fold : 2/10 [00:00&lt;00:00,   11.66it/s]



 30%|###       | Fold : 3/10 [00:00&lt;00:00,   12.98it/s]



 40%|####      | Fold : 4/10 [00:00&lt;00:00,   13.75it/s]



 50%|#####     | Fold : 5/10 [00:00&lt;00:00,   14.23it/s]



 60%|######    | Fold : 6/10 [00:00&lt;00:00,   14.55it/s]



 70%|#######   | Fold : 7/10 [00:00&lt;00:00,   14.71it/s]



 80%|########  | Fold : 8/10 [00:00&lt;00:00,   14.93it/s]



 90%|######### | Fold : 9/10 [00:00&lt;00:00,   15.08it/s]



100%|##########| Fold : 10/10 [00:00&lt;00:00,   15.21it/s]
100%|##########| Fold : 10/10 [00:00&lt;00:00,   14.96it/s]


100%|##########| n_interp : 4/4 [00:03&lt;00:00,    1.10it/s]
100%|##########| n_interp : 4/4 [00:03&lt;00:00,    1.10it/s]




Estimated consensus=0.40 and n_interpolate=2



  0%|          | Repairing epochs : 0/97 [00:00&lt;?,       ?it/s]


  5%|5         | Repairing epochs : 5/97 [00:00&lt;00:00,  310.63it/s]


  8%|8         | Repairing epochs : 8/97 [00:00&lt;00:00,  246.45it/s]


 10%|#         | Repairing epochs : 10/97 [00:00&lt;00:00,  190.32it/s]


 12%|#2        | Repairing epochs : 12/97 [00:00&lt;00:00,  165.00it/s]


 14%|#4        | Repairing epochs : 14/97 [00:00&lt;00:00,  150.01it/s]


 16%|#6        | Repairing epochs : 16/97 [00:00&lt;00:00,  127.43it/s]


 19%|#8        | Repairing epochs : 18/97 [00:00&lt;00:00,  122.68it/s]


 22%|##1       | Repairing epochs : 21/97 [00:00&lt;00:00,  119.24it/s]


 24%|##3       | Repairing epochs : 23/97 [00:00&lt;00:00,  110.94it/s]


 26%|##5       | Repairing epochs : 25/97 [00:00&lt;00:00,  104.55it/s]


 28%|##7       | Repairing epochs : 27/97 [00:00&lt;00:00,   99.47it/s]


 29%|##8       | Repairing epochs : 28/97 [00:00&lt;00:00,   96.53it/s]


 31%|###       | Repairing epochs : 30/97 [00:00&lt;00:00,   95.23it/s]


 34%|###4      | Repairing epochs : 33/97 [00:00&lt;00:00,   96.19it/s]


 36%|###6      | Repairing epochs : 35/97 [00:00&lt;00:00,   93.60it/s]


 38%|###8      | Repairing epochs : 37/97 [00:00&lt;00:00,   91.07it/s]


 40%|####      | Repairing epochs : 39/97 [00:00&lt;00:00,   88.59it/s]


 42%|####2     | Repairing epochs : 41/97 [00:00&lt;00:00,   89.72it/s]


 44%|####4     | Repairing epochs : 43/97 [00:00&lt;00:00,   87.88it/s]


 46%|####6     | Repairing epochs : 45/97 [00:00&lt;00:00,   86.32it/s]


 48%|####8     | Repairing epochs : 47/97 [00:00&lt;00:00,   85.01it/s]


 51%|#####     | Repairing epochs : 49/97 [00:00&lt;00:00,   85.97it/s]


 53%|#####2    | Repairing epochs : 51/97 [00:00&lt;00:00,   86.07it/s]


 56%|#####5    | Repairing epochs : 54/97 [00:00&lt;00:00,   89.26it/s]


 58%|#####7    | Repairing epochs : 56/97 [00:00&lt;00:00,   87.77it/s]


 60%|#####9    | Repairing epochs : 58/97 [00:00&lt;00:00,   88.64it/s]


 62%|######1   | Repairing epochs : 60/97 [00:00&lt;00:00,   89.59it/s]


 64%|######3   | Repairing epochs : 62/97 [00:00&lt;00:00,   90.23it/s]


 66%|######5   | Repairing epochs : 64/97 [00:00&lt;00:00,   88.46it/s]


 68%|######8   | Repairing epochs : 66/97 [00:00&lt;00:00,   86.86it/s]


 70%|#######   | Repairing epochs : 68/97 [00:00&lt;00:00,   85.47it/s]


 73%|#######3  | Repairing epochs : 71/97 [00:00&lt;00:00,   88.25it/s]


 76%|#######6  | Repairing epochs : 74/97 [00:00&lt;00:00,   90.87it/s]


 79%|#######9  | Repairing epochs : 77/97 [00:00&lt;00:00,   93.57it/s]


 82%|########2 | Repairing epochs : 80/97 [00:00&lt;00:00,   95.77it/s]


 86%|########5 | Repairing epochs : 83/97 [00:00&lt;00:00,   97.93it/s]


 89%|########8 | Repairing epochs : 86/97 [00:00&lt;00:00,   99.88it/s]


 92%|#########1| Repairing epochs : 89/97 [00:00&lt;00:00,  101.62it/s]


 95%|#########4| Repairing epochs : 92/97 [00:00&lt;00:00,  103.06it/s]


 98%|#########7| Repairing epochs : 95/97 [00:00&lt;00:00,  104.79it/s]


100%|##########| Repairing epochs : 97/97 [00:00&lt;00:00,  105.57it/s]
100%|##########| Repairing epochs : 97/97 [00:00&lt;00:00,   99.83it/s]
Dropped 11 epochs: 62, 63, 64, 65, 69, 71, 72, 73, 80, 95, 96

&lt;MNEBrowseFigure size 800x800 with 4 Axes&gt;
</pre></div>
</div>
<p>We will do a few more visualizations to see that removing the bad epochs
found by <code class="docutils literal notranslate"><span class="pre">autoreject</span></code> is still important even with preprocessing first.
This is especially important if your analyses include trial-level statistics
such as looking for bursting activity. We’ll visualize why autoreject
excluded these epochs and the effect that including these bad epochs would
have on the data.</p>
<p>First, we will visualize the reject log</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../generated/autoreject.RejectLog.html#autoreject.RejectLog.plot" title="autoreject.RejectLog.plot" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-method"><span class="n">reject_log</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_autoreject_workflow_009.png" srcset="../_images/sphx_glr_plot_autoreject_workflow_009.png" alt="plot autoreject workflow" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1200x600 with 1 Axes&gt;
</pre></div>
</div>
<p>Next, we will visualize the cleaned average data and compare it against
the bad segments.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://mne.tools/dev/generated/mne.EvokedArray.html#mne.EvokedArray" title="mne.EvokedArray" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">evoked_bad</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">[</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reject_log</span><span class="o">.</span><span class="n">bad_epochs</span></a><span class="p">]</span><span class="o">.</span><span class="n">average</span><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.EvokedArray.html#mne.EvokedArray.times" title="mne.EvokedArray.times" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-property"><span class="n">evoked_bad</span><span class="o">.</span><span class="n">times</span></a><span class="p">,</span> <a href="https://mne.tools/dev/generated/mne.EvokedArray.html#mne.EvokedArray.data" title="mne.EvokedArray.data" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-property"><span class="n">evoked_bad</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">T</span></a> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs.average" title="mne.Epochs.average" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">epochs_ar</span><span class="o">.</span><span class="n">average</span></a><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.gca.html#matplotlib.pyplot.gca" title="matplotlib.pyplot.gca" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">gca</span></a><span class="p">())</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_autoreject_workflow_010.png" srcset="../_images/sphx_glr_plot_autoreject_workflow_010.png" alt="EEG (32 channels)" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).

&lt;Figure size 640x480 with 2 Axes&gt;
</pre></div>
</div>
<p>As a last optional step, we can do inspect the reject_log and make manual
corrections to the reject_log. For instance, if data is limited, we may
not want to drop epochs but retain the list of bad epochs for quality
assurance metrics.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../generated/autoreject.RejectLog.html#autoreject.RejectLog" title="autoreject.RejectLog" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reject_log</span></a> <span class="o">=</span> <a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject.get_reject_log" title="autoreject.AutoReject.get_reject_log" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-method"><span class="n">ar</span><span class="o">.</span><span class="n">get_reject_log</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bad_epochs</span></a> <span class="o">=</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reject_log</span><span class="o">.</span><span class="n">bad_epochs</span></a><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reject_log</span><span class="o">.</span><span class="n">bad_epochs</span></a><span class="p">[:]</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># no bad epochs</span>
</pre></div>
</div>
<p>The modified reject log can be applied to the data as follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_ar</span></a> <span class="o">=</span> <a href="../generated/autoreject.AutoReject.html#autoreject.AutoReject.transform" title="autoreject.AutoReject.transform" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-method"><span class="n">ar</span><span class="o">.</span><span class="n">transform</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">,</span> <a href="../generated/autoreject.RejectLog.html#autoreject.RejectLog" title="autoreject.RejectLog" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reject_log</span></a><span class="o">=</span><a href="../generated/autoreject.RejectLog.html#autoreject.RejectLog" title="autoreject.RejectLog" class="sphx-glr-backref-module-autoreject sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">reject_log</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of epochs originally: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">)</span><span class="si">}</span><span class="s1">, &#39;</span>
      <span class="sa">f</span><span class="s1">&#39;after autoreject: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs_ar</span></a><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>  0%|          | Repairing epochs : 0/97 [00:00&lt;?,       ?it/s]


  6%|6         | Repairing epochs : 6/97 [00:00&lt;00:00,  260.20it/s]


 10%|#         | Repairing epochs : 10/97 [00:00&lt;00:00,  197.57it/s]


 12%|#2        | Repairing epochs : 12/97 [00:00&lt;00:00,  169.72it/s]


 14%|#4        | Repairing epochs : 14/97 [00:00&lt;00:00,  148.63it/s]


 16%|#6        | Repairing epochs : 16/97 [00:00&lt;00:00,  127.12it/s]


 19%|#8        | Repairing epochs : 18/97 [00:00&lt;00:00,  123.73it/s]


 22%|##1       | Repairing epochs : 21/97 [00:00&lt;00:00,  120.37it/s]


 24%|##3       | Repairing epochs : 23/97 [00:00&lt;00:00,  112.02it/s]


 26%|##5       | Repairing epochs : 25/97 [00:00&lt;00:00,  105.66it/s]


 28%|##7       | Repairing epochs : 27/97 [00:00&lt;00:00,  100.37it/s]


 29%|##8       | Repairing epochs : 28/97 [00:00&lt;00:00,   97.42it/s]


 31%|###       | Repairing epochs : 30/97 [00:00&lt;00:00,   96.01it/s]


 34%|###4      | Repairing epochs : 33/97 [00:00&lt;00:00,   96.96it/s]


 36%|###6      | Repairing epochs : 35/97 [00:00&lt;00:00,   94.41it/s]


 38%|###8      | Repairing epochs : 37/97 [00:00&lt;00:00,   91.75it/s]


 40%|####      | Repairing epochs : 39/97 [00:00&lt;00:00,   89.28it/s]


 42%|####2     | Repairing epochs : 41/97 [00:00&lt;00:00,   90.29it/s]


 44%|####4     | Repairing epochs : 43/97 [00:00&lt;00:00,   88.21it/s]


 46%|####6     | Repairing epochs : 45/97 [00:00&lt;00:00,   86.71it/s]


 48%|####8     | Repairing epochs : 47/97 [00:00&lt;00:00,   85.35it/s]


 51%|#####     | Repairing epochs : 49/97 [00:00&lt;00:00,   86.33it/s]


 53%|#####2    | Repairing epochs : 51/97 [00:00&lt;00:00,   86.38it/s]


 56%|#####5    | Repairing epochs : 54/97 [00:00&lt;00:00,   89.59it/s]


 58%|#####7    | Repairing epochs : 56/97 [00:00&lt;00:00,   88.14it/s]


 60%|#####9    | Repairing epochs : 58/97 [00:00&lt;00:00,   88.89it/s]


 62%|######1   | Repairing epochs : 60/97 [00:00&lt;00:00,   89.86it/s]


 64%|######3   | Repairing epochs : 62/97 [00:00&lt;00:00,   90.64it/s]


 66%|######5   | Repairing epochs : 64/97 [00:00&lt;00:00,   88.98it/s]


 68%|######8   | Repairing epochs : 66/97 [00:00&lt;00:00,   87.41it/s]


 70%|#######   | Repairing epochs : 68/97 [00:00&lt;00:00,   85.82it/s]


 73%|#######3  | Repairing epochs : 71/97 [00:00&lt;00:00,   88.68it/s]


 76%|#######6  | Repairing epochs : 74/97 [00:00&lt;00:00,   91.40it/s]


 79%|#######9  | Repairing epochs : 77/97 [00:00&lt;00:00,   94.12it/s]


 82%|########2 | Repairing epochs : 80/97 [00:00&lt;00:00,   96.33it/s]


 86%|########5 | Repairing epochs : 83/97 [00:00&lt;00:00,   98.48it/s]


 89%|########8 | Repairing epochs : 86/97 [00:00&lt;00:00,  100.47it/s]


 92%|#########1| Repairing epochs : 89/97 [00:00&lt;00:00,  102.25it/s]


 95%|#########4| Repairing epochs : 92/97 [00:00&lt;00:00,  103.76it/s]


 98%|#########7| Repairing epochs : 95/97 [00:00&lt;00:00,  105.53it/s]
100%|##########| Repairing epochs : 97/97 [00:00&lt;00:00,  100.29it/s]
No bad epochs were found for your data. Returning a copy of the data you wanted to clean. Interpolation may have been done.
Number of epochs originally: 97, after autoreject: 97
</pre></div>
</div>
<p>Finally, don’t forget that we are working with resting state data
here. Here we used long epochs of 3 seconds so that frequency-domain
analysis was possible with the epochs. However, this could also lead
to longer segments of the data being rejected. If you want more
fine-grained control over the artifacts, you can
construct shorter epochs and use the autoreject log to mark
annotations in MNE that can be used to reject the data during doing
time-frequency analysis. We want to emphasize that there
is no subsitute for visual inspection. Irrespective of the rejection
method used, we highly recommend users to inspect their preprocessed
data before further analyses.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  26.868 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-autoreject-workflow-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/85c2c90b959d98328ef38b4615114365/plot_autoreject_workflow.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_autoreject_workflow.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/88aa0ebf52f0f32e2f92cc901577e2ba/plot_autoreject_workflow.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_autoreject_workflow.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="plot_ransac.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Detect bad sensors using RANSAC</p>
      </div>
    </a>
    <a class="right-next"
       href="plot_visualize_bad_epochs.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Visualize bad sensors per trial</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#autoreject-without-any-other-preprocessing">Autoreject without any other preprocessing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#autoreject-with-high-pass-filter">Autoreject with high-pass filter</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ica">ICA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#autoreject-with-highpass-filter-and-ica">Autoreject with highpass filter and ICA</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2016-2023, autoreject developers. Last updated on 2023-06-20.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.0.1.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>