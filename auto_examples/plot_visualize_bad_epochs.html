
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Visualize bad sensors per trial &#8212; autoreject 0.1.dev0 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.3.4/united/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1.dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.4/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          autoreject</a>
        <span class="navbar-text navbar-version pull-left"><b>0.1.dev0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="index.html">Examples</a></li>
                <li><a href="../api.html">API</a></li>
                <li><a href="../faq.html">FAQ</a></li>
                <li><a href="https://github.com/autoreject/autoreject">GitHub</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Visualize bad sensors per trial</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/auto_examples/plot_visualize_bad_epochs.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container content-container">
  
  <div class="section" id="visualize-bad-sensors-per-trial">
<span id="sphx-glr-auto-examples-plot-visualize-bad-epochs-py"></span><h1>Visualize bad sensors per trial<a class="headerlink" href="#visualize-bad-sensors-per-trial" title="Permalink to this headline">Â¶</a></h1>
<p>This example demonstrates how to use <code class="xref py py-mod docutils literal"><span class="pre">autoreject</span></code> to
visualize the bad sensors in each trial</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Author: Mainak Jas &lt;mainak.jas@telecom-paristech.fr&gt;</span>
<span class="c1">#         Denis A. Engemann &lt;denis.engemann@gmail.com&gt;</span>
<span class="c1"># License: BSD (3-clause)</span>
</pre></div>
</div>
<p>First, we download the data from OpenfMRI. We will download the tarfile,
extract the necessary files and delete the tar from the disk</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">tarfile</span>

<span class="kn">import</span> <span class="nn">autoreject</span>
<span class="kn">from</span> <span class="nn">autoreject.utils</span> <span class="kn">import</span> <a href="http://autoreject.github.io/generated/autoreject.utils.fetch_file.html#autoreject.utils.fetch_file" title="View documentation for autoreject.utils.fetch_file"><span class="n">fetch_file</span></a>

<span class="n">subject_id</span> <span class="o">=</span> <span class="mi">16</span>  <span class="c1"># OpenfMRI format of subject numbering</span>

<span class="n">src_url</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;http://openfmri.s3.amazonaws.com/tarballs/&#39;</span>
           <span class="s1">&#39;ds117_R0.1.1_sub016_raw.tgz&#39;</span><span class="p">)</span>
<span class="n">subject</span> <span class="o">=</span> <span class="s2">&quot;sub</span><span class="si">%03d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">subject_id</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;processing subject: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">subject</span><span class="p">)</span>
<span class="n">base_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">autoreject</span><span class="o">.</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;examples&#39;</span><span class="p">)</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_path</span><span class="p">,</span> <span class="s1">&#39;ds117_R0.1.1_sub016_raw.tgz&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_path</span><span class="p">,</span> <span class="s1">&#39;ds117&#39;</span><span class="p">)):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
        <a href="http://autoreject.github.io/generated/autoreject.utils.fetch_file.html#autoreject.utils.fetch_file" title="View documentation for autoreject.utils.fetch_file"><span class="n">fetch_file</span></a><span class="p">(</span><span class="n">src_url</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
    <span class="n">tf</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Extracting files. This may take a while ...&#39;</span><span class="p">)</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">base_path</span><span class="p">,</span> <span class="n">members</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">getmembers</span><span class="p">()[</span><span class="o">-</span><span class="mi">25</span><span class="p">:</span><span class="o">-</span><span class="mi">9</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-default"><div class="highlight"><pre><span></span><span class="n">processing</span> <span class="n">subject</span><span class="p">:</span> <span class="n">sub016</span>
</pre></div>
</div>
<p>We will create epochs with data starting 200 ms before trigger onset
and continuing up to 800 ms after that. The data contains visual stimuli for
famous faces, unfamiliar faces, as well as scrambled faces.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span>
<span class="n">events_id</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;famous/first&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;famous/immediate&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;famous/long&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">}</span>
</pre></div>
</div>
<p>Let us now load all the epochs into memory and concatenate them</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mne</span>  <span class="c1"># noqa</span>

<span class="n">epochs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">):</span>
    <span class="n">run_fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_path</span><span class="p">,</span> <span class="s1">&#39;ds117&#39;</span><span class="p">,</span> <span class="s1">&#39;sub</span><span class="si">%03d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">subject_id</span><span class="p">,</span> <span class="s1">&#39;MEG&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;run_</span><span class="si">%02d</span><span class="s1">_raw.fif&#39;</span> <span class="o">%</span> <span class="n">run</span><span class="p">)</span>
    <span class="n">raw</span> <span class="o">=</span> <a href="http://mne-tools.github.io/stable/generated/mne.io.read_raw_fif.html#mne.io.read_raw_fif" title="View documentation for mne.io.read_raw_fif"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_fif</span></a><span class="p">(</span><span class="n">run_fname</span><span class="p">,</span> <span class="n">preload</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">raw</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c1"># less memory + computation</span>
    <span class="n">raw</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">,</span> <span class="n">l_trans_bandwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="s1">&#39;INFO&#39;</span><span class="p">)</span>

    <span class="n">raw</span><span class="o">.</span><span class="n">set_channel_types</span><span class="p">({</span><span class="s1">&#39;EEG061&#39;</span><span class="p">:</span> <span class="s1">&#39;eog&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG062&#39;</span><span class="p">:</span> <span class="s1">&#39;eog&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;EEG063&#39;</span><span class="p">:</span> <span class="s1">&#39;ecg&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG064&#39;</span><span class="p">:</span> <span class="s1">&#39;misc&#39;</span><span class="p">})</span>
    <span class="n">raw</span><span class="o">.</span><span class="n">rename_channels</span><span class="p">({</span><span class="s1">&#39;EEG061&#39;</span><span class="p">:</span> <span class="s1">&#39;EOG061&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG062&#39;</span><span class="p">:</span> <span class="s1">&#39;EOG062&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;EEG063&#39;</span><span class="p">:</span> <span class="s1">&#39;ECG063&#39;</span><span class="p">,</span> <span class="s1">&#39;EEG064&#39;</span><span class="p">:</span> <span class="s1">&#39;MISC&#39;</span><span class="p">})</span>

    <span class="n">events</span> <span class="o">=</span> <a href="http://mne-tools.github.io/stable/generated/mne.find_events.html#mne.find_events" title="View documentation for mne.find_events"><span class="n">mne</span><span class="o">.</span><span class="n">find_events</span></a><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">stim_channel</span><span class="o">=</span><span class="s1">&#39;STI101&#39;</span><span class="p">,</span>
                             <span class="n">consecutive</span><span class="o">=</span><span class="s1">&#39;increasing&#39;</span><span class="p">,</span>
                             <span class="n">min_duration</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="c1"># Read epochs</span>
    <a href="http://mne-tools.github.io/stable/generated/mne.set_eeg_reference.html#mne.set_eeg_reference" title="View documentation for mne.io.set_eeg_reference"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">set_eeg_reference</span></a><span class="p">(</span><span class="n">raw</span><span class="p">)</span>

    <span class="n">epoch</span> <span class="o">=</span> <a href="http://mne-tools.github.io/stable/generated/mne.Epochs.html#mne.Epochs" title="View documentation for mne.Epochs"><span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span></a><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">events</span><span class="p">,</span> <span class="n">events_id</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                       <span class="n">baseline</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">preload</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">reject</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">decim</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">epochs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">epoch</span><span class="p">)</span>

    <span class="c1"># Same `dev_head_t` for all runs so that we can concatenate them.</span>
    <span class="n">epoch</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;dev_head_t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;dev_head_t&#39;</span><span class="p">]</span>


<span class="n">epochs</span> <span class="o">=</span> <a href="http://mne-tools.github.io/stable/generated/mne.concatenate_epochs.html#mne.concatenate_epochs" title="View documentation for mne.epochs.concatenate_epochs"><span class="n">mne</span><span class="o">.</span><span class="n">epochs</span><span class="o">.</span><span class="n">concatenate_epochs</span></a><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-default"><div class="highlight"><pre><span></span><span class="n">Opening</span> <span class="n">raw</span> <span class="n">data</span> <span class="n">file</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">mainak</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">github_repos</span><span class="o">/</span><span class="n">autoreject</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">ds117</span><span class="o">/</span><span class="n">sub016</span><span class="o">/</span><span class="n">MEG</span><span class="o">/</span><span class="n">run_03_raw</span><span class="o">.</span><span class="n">fif</span><span class="o">...</span>
    <span class="n">Read</span> <span class="n">a</span> <span class="n">total</span> <span class="n">of</span> <span class="mi">8</span> <span class="n">projection</span> <span class="n">items</span><span class="p">:</span>
        <span class="n">mag_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">mags</span><span class="o">-</span><span class="n">v1</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">mag_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">mags</span><span class="o">-</span><span class="n">v2</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">mag_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">mags</span><span class="o">-</span><span class="n">v3</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">mag_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">mags</span><span class="o">-</span><span class="n">v4</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">mag_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">mags</span><span class="o">-</span><span class="n">v5</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">grad_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">grad</span><span class="o">-</span><span class="n">v1</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">grad_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">grad</span><span class="o">-</span><span class="n">v2</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">grad_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">grad</span><span class="o">-</span><span class="n">v3</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
    <span class="n">Range</span> <span class="p">:</span> <span class="mi">60500</span> <span class="o">...</span> <span class="mi">598399</span> <span class="o">=</span>     <span class="mf">55.000</span> <span class="o">...</span>   <span class="mf">543.999</span> <span class="n">secs</span>
<span class="n">Ready</span><span class="o">.</span>
<span class="n">Current</span> <span class="n">compensation</span> <span class="n">grade</span> <span class="p">:</span> <span class="mi">0</span>
<span class="n">Reading</span> <span class="mi">0</span> <span class="o">...</span> <span class="mi">537899</span>  <span class="o">=</span>      <span class="mf">0.000</span> <span class="o">...</span>   <span class="mf">488.999</span> <span class="n">secs</span><span class="o">...</span>
<span class="n">Setting</span> <span class="n">up</span> <span class="n">band</span><span class="o">-</span><span class="k">pass</span> <span class="nb">filter</span> <span class="kn">from</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">40</span> <span class="n">Hz</span>
<span class="n">h_trans_bandwidth</span> <span class="n">chosen</span> <span class="n">to</span> <span class="n">be</span> <span class="mf">10.0</span> <span class="n">Hz</span>
<span class="n">Filter</span> <span class="n">length</span> <span class="n">of</span> <span class="mi">7261</span> <span class="n">samples</span> <span class="p">(</span><span class="mf">6.601</span> <span class="n">sec</span><span class="p">)</span> <span class="n">selected</span>
<span class="mi">294</span> <span class="n">events</span> <span class="n">found</span>
<span class="n">Event</span> <span class="n">IDs</span><span class="p">:</span> <span class="p">[</span>   <span class="mi">5</span>    <span class="mi">6</span>    <span class="mi">7</span>   <span class="mi">13</span>   <span class="mi">14</span>   <span class="mi">15</span>   <span class="mi">17</span>   <span class="mi">18</span>   <span class="mi">19</span>  <span class="mi">256</span>  <span class="mi">261</span>  <span class="mi">262</span>  <span class="mi">263</span>  <span class="mi">269</span>  <span class="mi">270</span>
  <span class="mi">273</span>  <span class="mi">274</span>  <span class="mi">275</span> <span class="mi">4096</span> <span class="mi">4101</span> <span class="mi">4102</span> <span class="mi">4103</span> <span class="mi">4109</span> <span class="mi">4110</span> <span class="mi">4111</span> <span class="mi">4113</span> <span class="mi">4114</span> <span class="mi">4115</span><span class="p">]</span>
<span class="n">Applying</span> <span class="n">average</span> <span class="n">reference</span><span class="o">.</span>
<span class="n">Applying</span> <span class="n">a</span> <span class="n">custom</span> <span class="n">EEG</span> <span class="n">reference</span><span class="o">.</span>
<span class="mi">49</span> <span class="n">matching</span> <span class="n">events</span> <span class="n">found</span>
<span class="n">No</span> <span class="n">baseline</span> <span class="n">correction</span> <span class="n">applied</span>
<span class="n">Not</span> <span class="n">setting</span> <span class="n">metadata</span>
<span class="mi">8</span> <span class="n">projection</span> <span class="n">items</span> <span class="n">activated</span>
<span class="n">Opening</span> <span class="n">raw</span> <span class="n">data</span> <span class="n">file</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">mainak</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">github_repos</span><span class="o">/</span><span class="n">autoreject</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">ds117</span><span class="o">/</span><span class="n">sub016</span><span class="o">/</span><span class="n">MEG</span><span class="o">/</span><span class="n">run_04_raw</span><span class="o">.</span><span class="n">fif</span><span class="o">...</span>
    <span class="n">Read</span> <span class="n">a</span> <span class="n">total</span> <span class="n">of</span> <span class="mi">8</span> <span class="n">projection</span> <span class="n">items</span><span class="p">:</span>
        <span class="n">mag_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">mags</span><span class="o">-</span><span class="n">v1</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">mag_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">mags</span><span class="o">-</span><span class="n">v2</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">mag_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">mags</span><span class="o">-</span><span class="n">v3</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">mag_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">mags</span><span class="o">-</span><span class="n">v4</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">mag_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">mags</span><span class="o">-</span><span class="n">v5</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">grad_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">grad</span><span class="o">-</span><span class="n">v1</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">grad_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">grad</span><span class="o">-</span><span class="n">v2</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">grad_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">grad</span><span class="o">-</span><span class="n">v3</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
    <span class="n">Range</span> <span class="p">:</span> <span class="mi">137500</span> <span class="o">...</span> <span class="mi">680899</span> <span class="o">=</span>    <span class="mf">125.000</span> <span class="o">...</span>   <span class="mf">618.999</span> <span class="n">secs</span>
<span class="n">Ready</span><span class="o">.</span>
<span class="n">Current</span> <span class="n">compensation</span> <span class="n">grade</span> <span class="p">:</span> <span class="mi">0</span>
<span class="n">Reading</span> <span class="mi">0</span> <span class="o">...</span> <span class="mi">543399</span>  <span class="o">=</span>      <span class="mf">0.000</span> <span class="o">...</span>   <span class="mf">493.999</span> <span class="n">secs</span><span class="o">...</span>
<span class="n">Setting</span> <span class="n">up</span> <span class="n">band</span><span class="o">-</span><span class="k">pass</span> <span class="nb">filter</span> <span class="kn">from</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">40</span> <span class="n">Hz</span>
<span class="n">h_trans_bandwidth</span> <span class="n">chosen</span> <span class="n">to</span> <span class="n">be</span> <span class="mf">10.0</span> <span class="n">Hz</span>
<span class="n">Filter</span> <span class="n">length</span> <span class="n">of</span> <span class="mi">7261</span> <span class="n">samples</span> <span class="p">(</span><span class="mf">6.601</span> <span class="n">sec</span><span class="p">)</span> <span class="n">selected</span>
<span class="mi">296</span> <span class="n">events</span> <span class="n">found</span>
<span class="n">Event</span> <span class="n">IDs</span><span class="p">:</span> <span class="p">[</span>   <span class="mi">5</span>    <span class="mi">6</span>    <span class="mi">7</span>   <span class="mi">13</span>   <span class="mi">14</span>   <span class="mi">15</span>   <span class="mi">17</span>   <span class="mi">18</span>   <span class="mi">19</span>  <span class="mi">256</span>  <span class="mi">261</span>  <span class="mi">262</span>  <span class="mi">263</span>  <span class="mi">269</span>  <span class="mi">270</span>
  <span class="mi">273</span>  <span class="mi">274</span>  <span class="mi">275</span> <span class="mi">4096</span> <span class="mi">4101</span> <span class="mi">4102</span> <span class="mi">4103</span> <span class="mi">4109</span> <span class="mi">4110</span> <span class="mi">4111</span> <span class="mi">4113</span><span class="p">]</span>
<span class="n">Applying</span> <span class="n">average</span> <span class="n">reference</span><span class="o">.</span>
<span class="n">Applying</span> <span class="n">a</span> <span class="n">custom</span> <span class="n">EEG</span> <span class="n">reference</span><span class="o">.</span>
<span class="mi">49</span> <span class="n">matching</span> <span class="n">events</span> <span class="n">found</span>
<span class="n">No</span> <span class="n">baseline</span> <span class="n">correction</span> <span class="n">applied</span>
<span class="n">Not</span> <span class="n">setting</span> <span class="n">metadata</span>
<span class="mi">8</span> <span class="n">projection</span> <span class="n">items</span> <span class="n">activated</span>
<span class="n">Opening</span> <span class="n">raw</span> <span class="n">data</span> <span class="n">file</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">mainak</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">github_repos</span><span class="o">/</span><span class="n">autoreject</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">ds117</span><span class="o">/</span><span class="n">sub016</span><span class="o">/</span><span class="n">MEG</span><span class="o">/</span><span class="n">run_05_raw</span><span class="o">.</span><span class="n">fif</span><span class="o">...</span>
    <span class="n">Read</span> <span class="n">a</span> <span class="n">total</span> <span class="n">of</span> <span class="mi">8</span> <span class="n">projection</span> <span class="n">items</span><span class="p">:</span>
        <span class="n">mag_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">mags</span><span class="o">-</span><span class="n">v1</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">mag_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">mags</span><span class="o">-</span><span class="n">v2</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">mag_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">mags</span><span class="o">-</span><span class="n">v3</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">mag_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">mags</span><span class="o">-</span><span class="n">v4</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">mag_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">mags</span><span class="o">-</span><span class="n">v5</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">grad_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">grad</span><span class="o">-</span><span class="n">v1</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">grad_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">grad</span><span class="o">-</span><span class="n">v2</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">grad_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">grad</span><span class="o">-</span><span class="n">v3</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
    <span class="n">Range</span> <span class="p">:</span> <span class="mi">279400</span> <span class="o">...</span> <span class="mi">820599</span> <span class="o">=</span>    <span class="mf">254.000</span> <span class="o">...</span>   <span class="mf">745.999</span> <span class="n">secs</span>
<span class="n">Ready</span><span class="o">.</span>
<span class="n">Current</span> <span class="n">compensation</span> <span class="n">grade</span> <span class="p">:</span> <span class="mi">0</span>
<span class="n">Reading</span> <span class="mi">0</span> <span class="o">...</span> <span class="mi">541199</span>  <span class="o">=</span>      <span class="mf">0.000</span> <span class="o">...</span>   <span class="mf">491.999</span> <span class="n">secs</span><span class="o">...</span>
<span class="n">Setting</span> <span class="n">up</span> <span class="n">band</span><span class="o">-</span><span class="k">pass</span> <span class="nb">filter</span> <span class="kn">from</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">40</span> <span class="n">Hz</span>
<span class="n">h_trans_bandwidth</span> <span class="n">chosen</span> <span class="n">to</span> <span class="n">be</span> <span class="mf">10.0</span> <span class="n">Hz</span>
<span class="n">Filter</span> <span class="n">length</span> <span class="n">of</span> <span class="mi">7261</span> <span class="n">samples</span> <span class="p">(</span><span class="mf">6.601</span> <span class="n">sec</span><span class="p">)</span> <span class="n">selected</span>
<span class="mi">295</span> <span class="n">events</span> <span class="n">found</span>
<span class="n">Event</span> <span class="n">IDs</span><span class="p">:</span> <span class="p">[</span>   <span class="mi">5</span>    <span class="mi">6</span>    <span class="mi">7</span>   <span class="mi">13</span>   <span class="mi">14</span>   <span class="mi">15</span>   <span class="mi">17</span>   <span class="mi">18</span>   <span class="mi">19</span>  <span class="mi">256</span>  <span class="mi">261</span>  <span class="mi">262</span>  <span class="mi">263</span>  <span class="mi">269</span>  <span class="mi">270</span>
  <span class="mi">271</span>  <span class="mi">273</span>  <span class="mi">274</span>  <span class="mi">275</span> <span class="mi">4096</span> <span class="mi">4101</span> <span class="mi">4102</span> <span class="mi">4103</span> <span class="mi">4109</span> <span class="mi">4110</span> <span class="mi">4111</span> <span class="mi">4115</span> <span class="mi">4357</span> <span class="mi">4359</span><span class="p">]</span>
<span class="n">Applying</span> <span class="n">average</span> <span class="n">reference</span><span class="o">.</span>
<span class="n">Applying</span> <span class="n">a</span> <span class="n">custom</span> <span class="n">EEG</span> <span class="n">reference</span><span class="o">.</span>
<span class="mi">47</span> <span class="n">matching</span> <span class="n">events</span> <span class="n">found</span>
<span class="n">No</span> <span class="n">baseline</span> <span class="n">correction</span> <span class="n">applied</span>
<span class="n">Not</span> <span class="n">setting</span> <span class="n">metadata</span>
<span class="mi">8</span> <span class="n">projection</span> <span class="n">items</span> <span class="n">activated</span>
<span class="n">Opening</span> <span class="n">raw</span> <span class="n">data</span> <span class="n">file</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">mainak</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">github_repos</span><span class="o">/</span><span class="n">autoreject</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">ds117</span><span class="o">/</span><span class="n">sub016</span><span class="o">/</span><span class="n">MEG</span><span class="o">/</span><span class="n">run_06_raw</span><span class="o">.</span><span class="n">fif</span><span class="o">...</span>
    <span class="n">Read</span> <span class="n">a</span> <span class="n">total</span> <span class="n">of</span> <span class="mi">8</span> <span class="n">projection</span> <span class="n">items</span><span class="p">:</span>
        <span class="n">mag_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">mags</span><span class="o">-</span><span class="n">v1</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">mag_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">mags</span><span class="o">-</span><span class="n">v2</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">mag_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">mags</span><span class="o">-</span><span class="n">v3</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">mag_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">mags</span><span class="o">-</span><span class="n">v4</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">mag_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">mags</span><span class="o">-</span><span class="n">v5</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">grad_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">grad</span><span class="o">-</span><span class="n">v1</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">grad_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">grad</span><span class="o">-</span><span class="n">v2</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
        <span class="n">grad_ssp_upright</span><span class="o">.</span><span class="n">fif</span> <span class="p">:</span> <span class="n">PCA</span><span class="o">-</span><span class="n">grad</span><span class="o">-</span><span class="n">v3</span> <span class="p">(</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">306</span><span class="p">)</span>  <span class="n">idle</span>
    <span class="n">Range</span> <span class="p">:</span> <span class="mi">140800</span> <span class="o">...</span> <span class="mi">680899</span> <span class="o">=</span>    <span class="mf">128.000</span> <span class="o">...</span>   <span class="mf">618.999</span> <span class="n">secs</span>
<span class="n">Ready</span><span class="o">.</span>
<span class="n">Current</span> <span class="n">compensation</span> <span class="n">grade</span> <span class="p">:</span> <span class="mi">0</span>
<span class="n">Reading</span> <span class="mi">0</span> <span class="o">...</span> <span class="mi">540099</span>  <span class="o">=</span>      <span class="mf">0.000</span> <span class="o">...</span>   <span class="mf">490.999</span> <span class="n">secs</span><span class="o">...</span>
<span class="n">Setting</span> <span class="n">up</span> <span class="n">band</span><span class="o">-</span><span class="k">pass</span> <span class="nb">filter</span> <span class="kn">from</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">40</span> <span class="n">Hz</span>
<span class="n">h_trans_bandwidth</span> <span class="n">chosen</span> <span class="n">to</span> <span class="n">be</span> <span class="mf">10.0</span> <span class="n">Hz</span>
<span class="n">Filter</span> <span class="n">length</span> <span class="n">of</span> <span class="mi">7261</span> <span class="n">samples</span> <span class="p">(</span><span class="mf">6.601</span> <span class="n">sec</span><span class="p">)</span> <span class="n">selected</span>
<span class="mi">296</span> <span class="n">events</span> <span class="n">found</span>
<span class="n">Event</span> <span class="n">IDs</span><span class="p">:</span> <span class="p">[</span>   <span class="mi">5</span>    <span class="mi">6</span>    <span class="mi">7</span>   <span class="mi">13</span>   <span class="mi">14</span>   <span class="mi">15</span>   <span class="mi">17</span>   <span class="mi">18</span>   <span class="mi">19</span>  <span class="mi">256</span>  <span class="mi">261</span>  <span class="mi">262</span>  <span class="mi">263</span>  <span class="mi">269</span>  <span class="mi">270</span>
  <span class="mi">271</span>  <span class="mi">273</span>  <span class="mi">274</span>  <span class="mi">275</span> <span class="mi">4096</span> <span class="mi">4101</span> <span class="mi">4102</span> <span class="mi">4103</span> <span class="mi">4109</span> <span class="mi">4110</span> <span class="mi">4111</span> <span class="mi">4114</span><span class="p">]</span>
<span class="n">Applying</span> <span class="n">average</span> <span class="n">reference</span><span class="o">.</span>
<span class="n">Applying</span> <span class="n">a</span> <span class="n">custom</span> <span class="n">EEG</span> <span class="n">reference</span><span class="o">.</span>
<span class="mi">48</span> <span class="n">matching</span> <span class="n">events</span> <span class="n">found</span>
<span class="n">No</span> <span class="n">baseline</span> <span class="n">correction</span> <span class="n">applied</span>
<span class="n">Not</span> <span class="n">setting</span> <span class="n">metadata</span>
<span class="mi">8</span> <span class="n">projection</span> <span class="n">items</span> <span class="n">activated</span>
<span class="n">Loading</span> <span class="n">data</span> <span class="k">for</span> <span class="mi">49</span> <span class="n">events</span> <span class="ow">and</span> <span class="mi">1101</span> <span class="n">original</span> <span class="n">time</span> <span class="n">points</span> <span class="o">...</span>
<span class="mi">0</span> <span class="n">bad</span> <span class="n">epochs</span> <span class="n">dropped</span>
<span class="n">Loading</span> <span class="n">data</span> <span class="k">for</span> <span class="mi">49</span> <span class="n">events</span> <span class="ow">and</span> <span class="mi">1101</span> <span class="n">original</span> <span class="n">time</span> <span class="n">points</span> <span class="o">...</span>
<span class="mi">0</span> <span class="n">bad</span> <span class="n">epochs</span> <span class="n">dropped</span>
<span class="n">Loading</span> <span class="n">data</span> <span class="k">for</span> <span class="mi">47</span> <span class="n">events</span> <span class="ow">and</span> <span class="mi">1101</span> <span class="n">original</span> <span class="n">time</span> <span class="n">points</span> <span class="o">...</span>
<span class="mi">0</span> <span class="n">bad</span> <span class="n">epochs</span> <span class="n">dropped</span>
<span class="n">Loading</span> <span class="n">data</span> <span class="k">for</span> <span class="mi">48</span> <span class="n">events</span> <span class="ow">and</span> <span class="mi">1101</span> <span class="n">original</span> <span class="n">time</span> <span class="n">points</span> <span class="o">...</span>
<span class="mi">0</span> <span class="n">bad</span> <span class="n">epochs</span> <span class="n">dropped</span>
<span class="mi">193</span> <span class="n">matching</span> <span class="n">events</span> <span class="n">found</span>
<span class="n">No</span> <span class="n">baseline</span> <span class="n">correction</span> <span class="n">applied</span>
<span class="n">Not</span> <span class="n">setting</span> <span class="n">metadata</span>
<span class="mi">0</span> <span class="n">bad</span> <span class="n">epochs</span> <span class="n">dropped</span>
</pre></div>
</div>
<p>Now, we apply autoreject</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">autoreject</span> <span class="kn">import</span> <a href="http://autoreject.github.io/generated/autoreject.AutoReject.html#autoreject.AutoReject" title="View documentation for autoreject.AutoReject"><span class="n">AutoReject</span></a><span class="p">,</span> <span class="n">compute_thresholds</span>  <span class="c1"># noqa</span>

<span class="n">this_epoch</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s1">&#39;famous&#39;</span><span class="p">]</span>
<span class="n">exclude</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># XXX</span>
<span class="n">picks</span> <span class="o">=</span> <a href="http://mne-tools.github.io/stable/generated/mne.pick_types.html#mne.pick_types" title="View documentation for mne.pick_types"><span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span></a><span class="p">(</span><span class="n">epochs</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                       <span class="n">eog</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that <a class="reference internal" href="../generated/autoreject.AutoReject.html#autoreject.AutoReject" title="autoreject.AutoReject"><code class="xref py py-class docutils literal"><span class="pre">autoreject.AutoReject</span></code></a> by design supports multiple
channels. If no picks are passed separate solutions will be computed for each
channel type and internally combines. This then readily supports cleaning
unseen epochs from the different channel types used during fit.
Here we only use a subset of channels to save time.</p>
<p>Also note that once the parameters are learned, any data can be repaired
that contains channels that were used during fit. This also means that time
may be saved by fitting <a class="reference internal" href="../generated/autoreject.AutoReject.html#autoreject.AutoReject" title="autoreject.AutoReject"><code class="xref py py-class docutils literal"><span class="pre">autoreject.AutoReject</span></code></a> on a
representative subsample of the data.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">ar</span> <span class="o">=</span> <a href="http://autoreject.github.io/generated/autoreject.AutoReject.html#autoreject.AutoReject" title="View documentation for autoreject.AutoReject"><span class="n">AutoReject</span></a><span class="p">(</span><span class="n">picks</span><span class="o">=</span><span class="n">picks</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="s1">&#39;tqdm&#39;</span><span class="p">)</span>

<span class="n">epochs_ar</span><span class="p">,</span> <span class="n">reject_log</span> <span class="o">=</span> <span class="n">ar</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">this_epoch</span><span class="p">,</span> <span class="n">return_log</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-default"><div class="highlight"><pre><span></span><span class="n">Running</span> <span class="n">autoreject</span> <span class="n">on</span> <span class="n">ch_type</span><span class="o">=</span><span class="n">eeg</span>
<span class="n">Computing</span> <span class="n">thresholds</span> <span class="o">...</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>   <span class="mi">1</span> <span class="n">out</span> <span class="n">of</span>   <span class="mi">1</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>    <span class="mf">1.3</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>   <span class="mi">2</span> <span class="n">out</span> <span class="n">of</span>   <span class="mi">2</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>    <span class="mf">2.8</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>   <span class="mi">3</span> <span class="n">out</span> <span class="n">of</span>   <span class="mi">3</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>    <span class="mf">4.0</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>   <span class="mi">4</span> <span class="n">out</span> <span class="n">of</span>   <span class="mi">4</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>    <span class="mf">5.1</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>   <span class="mi">5</span> <span class="n">out</span> <span class="n">of</span>   <span class="mi">5</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>    <span class="mf">6.5</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>   <span class="mi">6</span> <span class="n">out</span> <span class="n">of</span>   <span class="mi">6</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>    <span class="mf">7.8</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>   <span class="mi">7</span> <span class="n">out</span> <span class="n">of</span>   <span class="mi">7</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>    <span class="mf">8.8</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>   <span class="mi">8</span> <span class="n">out</span> <span class="n">of</span>   <span class="mi">8</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>    <span class="mf">9.9</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>   <span class="mi">9</span> <span class="n">out</span> <span class="n">of</span>   <span class="mi">9</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">11.0</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">10</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">10</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">12.0</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">11</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">11</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">13.2</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">12</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">12</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">14.2</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">13</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">13</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">15.4</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">14</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">14</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">16.5</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">15</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">15</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">17.7</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">16</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">16</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">18.8</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">17</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">17</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">19.9</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">18</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">18</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">21.1</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">19</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">19</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">22.2</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">20</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">20</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">23.5</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">21</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">21</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">24.7</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">22</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">22</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">25.8</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">23</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">23</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">27.0</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">24</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">24</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">28.4</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">25</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">25</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">29.6</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">26</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">26</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">30.7</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">27</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">27</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">31.9</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">28</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">28</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">33.3</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">29</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">29</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">34.6</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">30</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">30</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">36.1</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">31</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">31</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">37.6</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">32</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">32</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">39.0</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">33</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">33</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">40.3</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">34</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">34</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">41.6</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">35</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">35</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">42.9</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">36</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">36</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">44.3</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">37</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">37</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">45.4</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">38</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">38</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">46.5</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">39</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">39</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">47.7</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">40</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">40</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">49.0</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">41</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">41</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">50.1</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">42</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">42</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">51.3</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">43</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">43</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">52.5</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">44</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">44</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">53.8</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">45</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">45</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">55.0</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">46</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">46</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">56.2</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">47</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">47</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">57.5</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">48</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">48</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>   <span class="mf">59.0</span><span class="n">s</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">49</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">49</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>  <span class="mf">1.0</span><span class="nb">min</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">50</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">50</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>  <span class="mf">1.0</span><span class="nb">min</span> <span class="n">remaining</span><span class="p">:</span>    <span class="mf">0.0</span><span class="n">s</span>
<span class="p">[</span><span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)]:</span> <span class="n">Done</span>  <span class="mi">70</span> <span class="n">out</span> <span class="n">of</span>  <span class="mi">70</span> <span class="o">|</span> <span class="n">elapsed</span><span class="p">:</span>  <span class="mf">1.4</span><span class="nb">min</span> <span class="n">finished</span>




<span class="n">Estimated</span> <span class="n">consensus</span><span class="o">=</span><span class="mf">0.10</span> <span class="ow">and</span> <span class="n">n_interpolate</span><span class="o">=</span><span class="mi">4</span>
<span class="n">Dropped</span> <span class="mi">56</span> <span class="n">epochs</span>
</pre></div>
</div>
<p>We can visualize the cross validation curve over two variables</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>  <span class="c1"># noqa</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>  <span class="c1"># noqa</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="kn">as</span> <span class="nn">patches</span>  <span class="c1"># noqa</span>
<span class="kn">from</span> <span class="nn">autoreject</span> <span class="kn">import</span> <span class="n">set_matplotlib_defaults</span>  <span class="c1"># noqa</span>

<span class="n">set_matplotlib_defaults</span><span class="p">(</span><span class="n">plt</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;seaborn-white&#39;</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">ar</span><span class="o">.</span><span class="n">loss_</span><span class="p">[</span><span class="s1">&#39;eeg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># losses are stored by channel type.</span>

<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;viridis&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ar</span><span class="o">.</span><span class="n">consensus</span><span class="p">)),</span> <span class="n">ar</span><span class="o">.</span><span class="n">consensus</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ar</span><span class="o">.</span><span class="n">n_interpolate</span><span class="p">)),</span> <span class="n">ar</span><span class="o">.</span><span class="n">n_interpolate</span><span class="p">)</span>

<span class="c1"># Draw rectangle at location of best parameters</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">idx</span><span class="p">,</span> <span class="n">jdx</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.unravel_index.html#numpy.unravel_index" title="View documentation for numpy.unravel_index"><span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span></a><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">argmin</span><span class="p">(),</span> <span class="n">loss</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">rect</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="n">idx</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">jdx</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                         <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Consensus percentage $\kappa$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Max sensors interpolated $\rho$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Mean cross validation error (x 1e6)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_visualize_bad_epochs_001.png" class="align-center" src="../_images/sphx_glr_plot_visualize_bad_epochs_001.png" />
<p>... and visualize the bad epochs and sensors. Bad sensors which have been
interpolated are in blue. Bad sensors which are not interpolated are in red.
Bad trials are also in red.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">scalings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="mf">40e-6</span><span class="p">)</span>
<span class="n">reject_log</span><span class="o">.</span><span class="n">plot_epochs</span><span class="p">(</span><span class="n">this_epoch</span><span class="p">,</span> <span class="n">scalings</span><span class="o">=</span><span class="n">scalings</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_visualize_bad_epochs_002.png" class="align-center" src="../_images/sphx_glr_plot_visualize_bad_epochs_002.png" />
<p>... and the epochs after cleaning with autoreject</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">epochs_ar</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scalings</span><span class="o">=</span><span class="n">scalings</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_visualize_bad_epochs_003.png" class="align-center" src="../_images/sphx_glr_plot_visualize_bad_epochs_003.png" />
<p>The epochs dropped by autoreject are also stored in epochs.drop_log</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">epochs_ar</span><span class="o">.</span><span class="n">plot_drop_log</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_visualize_bad_epochs_004.png" class="align-center" src="../_images/sphx_glr_plot_visualize_bad_epochs_004.png" />
<p>Finally, the evoked before and after autoreject, for sanity check. We use
the <code class="docutils literal"><span class="pre">spatial_colors</span></code> argument from MNE as it allows us to see that
the eyeblinks have not yet been cleaned but the bad channels have been
repaired.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">ylim</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">eeg</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">epochs</span><span class="o">.</span><span class="n">average</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span> <span class="n">spatial_colors</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">epochs_ar</span><span class="o">.</span><span class="n">average</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span> <span class="n">spatial_colors</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><a class="first reference internal image-reference" href="../_images/sphx_glr_plot_visualize_bad_epochs_005.png"><img alt="../_images/sphx_glr_plot_visualize_bad_epochs_005.png" src="../_images/sphx_glr_plot_visualize_bad_epochs_005.png" style="width: 300.8px; height: 141.0px;" /></a>
</li>
<li><a class="first reference internal image-reference" href="../_images/sphx_glr_plot_visualize_bad_epochs_006.png"><img alt="../_images/sphx_glr_plot_visualize_bad_epochs_006.png" src="../_images/sphx_glr_plot_visualize_bad_epochs_006.png" style="width: 300.8px; height: 141.0px;" /></a>
</li>
</ul>
<p><strong>Total running time of the script:</strong> ( 3 minutes  13.754 seconds)</p>
<div class="sphx-glr-footer docutils container">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../_downloads/plot_visualize_bad_epochs.py" download=""><code class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_visualize_bad_epochs.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../_downloads/plot_visualize_bad_epochs.ipynb" download=""><code class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_visualize_bad_epochs.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Generated by Sphinx-Gallery</a></p>
</div>


</div>

<!-- Github "fork me" ribbon -->
<a href="https://github.com/autoreject/autoreject"><img style="position: absolute; top: 50px; right: 0; border: 0;" 
src="https://camo.githubusercontent.com/652c5b9acfaddf3a9c326fa6bde407b87f7be0f4/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6f72616e67655f6666373630302e706e67"
alt="Fork me on GitHub"
data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png"></a>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2016, Mainak Jas.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>